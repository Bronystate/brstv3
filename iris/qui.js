!function(){function a(a){this.message=a}var b="undefined"!=typeof exports?exports:this,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var d,e,f=0,g=c,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&d>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");d=d<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var d,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(d=f%4?64*d+e:e,f++%4)?h+=String.fromCharCode(255&d>>(-2*f&6)):0)e=c.indexOf(e);return h})}(),function(){this.MooTools={version:"1.3.2",build:"c9f1ff10e9e7facb65e9481049ed1b450959d587"};var a=this.typeOf=function(a){if(null==a)return"null";if(a.$family)return a.$family();if(a.nodeName){if(1==a.nodeType)return"element";if(3==a.nodeType)return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else if("number"==typeof a.length){if(a.callee)return"arguments";if("item"in a)return"collection"}return typeof a},b=this.instanceOf=function(a,b){if(null==a)return!1;for(var c=a.$constructor||a.constructor;c;){if(c===b)return!0;c=c.parent}return a instanceof b},c=this.Function,d=!0;for(var e in{toString:1})d=null;d&&(d=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),c.prototype.overloadSetter=function(a){var b=this;return function(c,e){if(null==c)return this;if(a||"string"!=typeof c){for(var f in c)b.call(this,f,c[f]);if(d)for(var g=d.length;g--;)f=d[g],c.hasOwnProperty(f)&&b.call(this,f,c[f])}else b.call(this,c,e);return this}},c.prototype.overloadGetter=function(a){var b=this;return function(c){var d,e;if(a||"string"!=typeof c?d=c:arguments.length>1&&(d=arguments),d){e={};for(var f=0;f<d.length;f++)e[d[f]]=b.call(this,d[f])}else e=b.call(this,c);return e}},c.prototype.extend=function(a,b){this[a]=b}.overloadSetter(),c.prototype.implement=function(a,b){this.prototype[a]=b}.overloadSetter();var f=Array.prototype.slice;c.from=function(b){return"function"==a(b)?b:function(){return b}},Array.from=function(b){return null==b?[]:g.isEnumerable(b)&&"string"!=typeof b?"array"==a(b)?b:f.call(b):[b]},Number.from=function(a){var b=parseFloat(a);return isFinite(b)?b:null},String.from=function(a){return a+""},c.implement({hide:function(){return this.$hidden=!0,this},protect:function(){return this.$protected=!0,this}});var g=this.Type=function(b,c){if(b){var d=b.toLowerCase(),e=function(b){return a(b)==d};g["is"+b]=e,null!=c&&(c.prototype.$family=function(){return d}.hide(),c.type=e)}return null==c?null:(c.extend(this),c.$constructor=g,c.prototype.$constructor=c,c)},h=Object.prototype.toString;g.isEnumerable=function(a){return null!=a&&"number"==typeof a.length&&"[object Function]"!=h.call(a)};var i={},j=function(b){var c=a(b.prototype);return i[c]||(i[c]=[])},k=function(b,c){if(!c||!c.$hidden){for(var d=j(this),e=0;e<d.length;e++){var g=d[e];"type"==a(g)?k.call(g,b,c):g.call(this,b,c)}var h=this.prototype[b];null!=h&&h.$protected||(this.prototype[b]=c),null==this[b]&&"function"==a(c)&&l.call(this,b,function(a){return c.apply(a,f.call(arguments,1))})}},l=function(a,b){if(!b||!b.$hidden){var c=this[a];null!=c&&c.$protected||(this[a]=b)}};g.implement({implement:k.overloadSetter(),extend:l.overloadSetter(),alias:function(a,b){k.call(this,a,this.prototype[b])}.overloadSetter(),mirror:function(a){return j(this).push(a),this}}),new g("Type",g);var m=function(a,b,c){var d=b!=Object,e=b.prototype;d&&(b=new g(a,b));for(var f=0,h=c.length;h>f;f++){var i=c[f],j=b[i],k=e[i];j&&j.protect(),d&&k&&(delete e[i],e[i]=k.protect())}return d&&b.implement(e),m};m("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",c,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]),Object.extend=l.overloadSetter(),Date.extend("now",function(){return+new Date}),new g("Boolean",Boolean),Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide(),Number.extend("random",function(a,b){return Math.floor(Math.random()*(b-a+1)+a)});var n=Object.prototype.hasOwnProperty;Object.extend("forEach",function(a,b,c){for(var d in a)n.call(a,d)&&b.call(c,a[d],d,a)}),Object.each=Object.forEach,Array.implement({forEach:function(a,b){for(var c=0,d=this.length;d>c;c++)c in this&&a.call(b,this[c],c,this)},each:function(a,b){return Array.forEach(this,a,b),this}});var o=function(b){switch(a(b)){case"array":return b.clone();case"object":return Object.clone(b);default:return b}};Array.implement("clone",function(){for(var a=this.length,b=new Array(a);a--;)b[a]=o(this[a]);return b});var p=function(b,c,d){switch(a(d)){case"object":"object"==a(b[c])?Object.merge(b[c],d):b[c]=Object.clone(d);break;case"array":b[c]=d.clone();break;default:b[c]=d}return b};Object.extend({merge:function(b,c,d){if("string"==a(c))return p(b,c,d);for(var e=1,f=arguments.length;f>e;e++){var g=arguments[e];for(var h in g)p(b,h,g[h])}return b},clone:function(a){var b={};for(var c in a)b[c]=o(a[c]);return b},append:function(a){for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b]||{};for(var e in d)a[e]=d[e]}return a}}),["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(a){new g(a)});var q=Date.now();String.extend("uniqueID",function(){return(q++).toString(36)});var r=this.Hash=new g("Hash",function(b){"hash"==a(b)&&(b=Object.clone(b.getClean()));for(var c in b)this[c]=b[c];return this});r.implement({forEach:function(a,b){Object.forEach(this,a,b)},getClean:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a},getLength:function(){var a=0;for(var b in this)this.hasOwnProperty(b)&&a++;return a}}),r.alias("each","forEach"),Object.type=g.isObject;var s=this.Native=function(a){return new g(a.name,a.initialize)};s.type=g.type,s.implement=function(a,b){for(var c=0;c<a.length;c++)a[c].implement(b);return s};var t=Array.type;Array.type=function(a){return b(a,Array)||t(a)},this.$A=function(a){return Array.from(a).slice()},this.$arguments=function(a){return function(){return arguments[a]}},this.$chk=function(a){return!(!a&&0!==a)},this.$clear=function(a){return clearTimeout(a),clearInterval(a),null},this.$defined=function(a){return null!=a},this.$each=function(b,c,d){var e=a(b);("arguments"==e||"collection"==e||"array"==e||"elements"==e?Array:Object).each(b,c,d)},this.$empty=function(){},this.$extend=function(a,b){return Object.append(a,b)},this.$H=function(a){return new r(a)},this.$merge=function(){var a=Array.slice(arguments);return a.unshift({}),Object.merge.apply(null,a)},this.$lambda=c.from,this.$mixin=Object.merge,this.$random=Number.random,this.$splat=Array.from,this.$time=Date.now,this.$type=function(b){var c=a(b);return"elements"==c?"array":"null"==c?!1:c},this.$unlink=function(b){switch(a(b)){case"object":return Object.clone(b);case"array":return Array.clone(b);case"hash":return new r(b);default:return b}}}(),Array.implement({every:function(a,b){for(var c=0,d=this.length;d>c;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0},filter:function(a,b){for(var c=[],d=0,e=this.length;e>d;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);return c},indexOf:function(a,b){for(var c=this.length,d=0>b?Math.max(0,c+b):b||0;c>d;d++)if(this[d]===a)return d;return-1},map:function(a,b){for(var c=[],d=0,e=this.length;e>d;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c},some:function(a,b){for(var c=0,d=this.length;d>c;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1},clean:function(){return this.filter(function(a){return null!=a})},invoke:function(a){var b=Array.slice(arguments,1);return this.map(function(c){return c[a].apply(c,b)})},associate:function(a){for(var b={},c=Math.min(this.length,a.length),d=0;c>d;d++)b[a[d]]=this[d];return b},link:function(a){for(var b={},c=0,d=this.length;d>c;c++)for(var e in a)if(a[e](this[c])){b[e]=this[c],delete a[e];break}return b},contains:function(a,b){return-1!=this.indexOf(a,b)},append:function(a){return this.push.apply(this,a),this},getLast:function(){return this.length?this[this.length-1]:null},getRandom:function(){return this.length?this[Number.random(0,this.length-1)]:null},include:function(a){return this.contains(a)||this.push(a),this},combine:function(a){for(var b=0,c=a.length;c>b;b++)this.include(a[b]);return this},erase:function(a){for(var b=this.length;b--;)this[b]===a&&this.splice(b,1);return this},empty:function(){return this.length=0,this},flatten:function(){for(var a=[],b=0,c=this.length;c>b;b++){var d=typeOf(this[b]);"null"!=d&&(a=a.concat("array"==d||"collection"==d||"arguments"==d||instanceOf(this[b],Array)?Array.flatten(this[b]):this[b]))}return a},pick:function(){for(var a=0,b=this.length;b>a;a++)if(null!=this[a])return this[a];return null},hexToRgb:function(a){if(3!=this.length)return null;var b=this.map(function(a){return 1==a.length&&(a+=a),a.toInt(16)});return a?b:"rgb("+b+")"},rgbToHex:function(a){if(this.length<3)return null;if(4==this.length&&0==this[3]&&!a)return"transparent";for(var b=[],c=0;3>c;c++){var d=(this[c]-0).toString(16);b.push(1==d.length?"0"+d:d)}return a?b:"#"+b.join("")}}),Array.alias("extend","append");var $pick=function(){return Array.from(arguments).pick()};String.implement({test:function(a,b){return("regexp"==typeOf(a)?a:new RegExp(""+a,b)).test(this)},contains:function(a,b){return b?(b+this+b).indexOf(b+a+b)>-1:this.indexOf(a)>-1},trim:function(){return this.replace(/^\s+|\s+$/g,"")},clean:function(){return this.replace(/\s+/g," ").trim()},camelCase:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.charAt(0).toLowerCase()})},capitalize:function(){return this.replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(a){var b=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return b?b.slice(1).hexToRgb(a):null},rgbToHex:function(a){var b=this.match(/\d{1,3}/g);return b?b.rgbToHex(a):null},substitute:function(a,b){return this.replace(b||/\\?\{([^{}]+)\}/g,function(b,c){return"\\"==b.charAt(0)?b.slice(1):null!=a[c]?a[c]:""})}}),Function.extend({attempt:function(){for(var a=0,b=arguments.length;b>a;a++)try{return arguments[a]()}catch(c){}return null}}),Function.implement({attempt:function(a,b){try{return this.apply(b,Array.from(a))}catch(c){}return null},bind:function(a){var b=this,c=arguments.length>1?Array.slice(arguments,1):null;return function(){return c||arguments.length?c&&arguments.length?b.apply(a,c.concat(Array.from(arguments))):b.apply(a,c||arguments):b.call(a)}},pass:function(a,b){var c=this;return null!=a&&(a=Array.from(a)),function(){return c.apply(b,a||arguments)}},delay:function(a,b,c){return setTimeout(this.pass(null==c?[]:c,b),a)},periodical:function(a,b,c){return setInterval(this.pass(null==c?[]:c,b),a)}}),delete Function.prototype.bind,Function.implement({create:function(a){var b=this;return a=a||{},function(c){var d=a.arguments;d=null!=d?Array.from(d):Array.slice(arguments,a.event?1:0),a.event&&(d=[c||window.event].extend(d));var e=function(){return b.apply(a.bind||null,d)};return a.delay?setTimeout(e,a.delay):a.periodical?setInterval(e,a.periodical):a.attempt?Function.attempt(e):e()}},bind:function(a,b){var c=this;return null!=b&&(b=Array.from(b)),function(){return c.apply(a,b||arguments)}},bindWithEvent:function(a,b){var c=this;return null!=b&&(b=Array.from(b)),function(d){return c.apply(a,null==b?arguments:[d].concat(b))}},run:function(a,b){return this.apply(b,Array.from(a))}});var $try=Function.attempt;Number.implement({limit:function(a,b){return Math.min(b,Math.max(a,this))},round:function(a){return a=Math.pow(10,a||0).toFixed(0>a?-a:0),Math.round(this*a)/a},times:function(a,b){for(var c=0;this>c;c++)a.call(b,c,this)},toFloat:function(){return parseFloat(this)},toInt:function(a){return parseInt(this,a||10)}}),Number.alias("each","times"),function(a){var b={};a.each(function(a){Number[a]||(b[a]=function(){return Math[a].apply(null,[this].concat(Array.from(arguments)))})}),Number.implement(b)}(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]),function(){var a=Object.prototype.hasOwnProperty;Object.extend({subset:function(a,b){for(var c={},d=0,e=b.length;e>d;d++){var f=b[d];f in a&&(c[f]=a[f])}return c},map:function(b,c,d){var e={};for(var f in b)a.call(b,f)&&(e[f]=c.call(d,b[f],f,b));return e},filter:function(b,c,d){var e={};for(var f in b){var g=b[f];a.call(b,f)&&c.call(d,g,f,b)&&(e[f]=g)}return e},every:function(b,c,d){for(var e in b)if(a.call(b,e)&&!c.call(d,b[e],e))return!1;return!0},some:function(b,c,d){for(var e in b)if(a.call(b,e)&&c.call(d,b[e],e))return!0;return!1},keys:function(b){var c=[];for(var d in b)a.call(b,d)&&c.push(d);return c},values:function(b){var c=[];for(var d in b)a.call(b,d)&&c.push(b[d]);return c},getLength:function(a){return Object.keys(a).length},keyOf:function(b,c){for(var d in b)if(a.call(b,d)&&b[d]===c)return d;return null},contains:function(a,b){return null!=Object.keyOf(a,b)},toQueryString:function(a,b){var c=[];return Object.each(a,function(a,d){b&&(d=b+"["+d+"]");var e;switch(typeOf(a)){case"object":e=Object.toQueryString(a,d);break;case"array":var f={};a.each(function(a,b){f[b]=a}),e=Object.toQueryString(f,d);break;default:e=d+"="+encodeURIComponent(a)}null!=a&&c.push(e)}),c.join("&")}})}(),Hash.implement({has:Object.prototype.hasOwnProperty,keyOf:function(a){return Object.keyOf(this,a)},hasValue:function(a){return Object.contains(this,a)},extend:function(a){return Hash.each(a||{},function(a,b){Hash.set(this,b,a)},this),this},combine:function(a){return Hash.each(a||{},function(a,b){Hash.include(this,b,a)},this),this},erase:function(a){return this.hasOwnProperty(a)&&delete this[a],this},get:function(a){return this.hasOwnProperty(a)?this[a]:null},set:function(a,b){return(!this[a]||this.hasOwnProperty(a))&&(this[a]=b),this},empty:function(){return Hash.each(this,function(a,b){delete this[b]},this),this},include:function(a,b){return null==this[a]&&(this[a]=b),this},map:function(a,b){return new Hash(Object.map(this,a,b))},filter:function(a,b){return new Hash(Object.filter(this,a,b))},every:function(a,b){return Object.every(this,a,b)},some:function(a,b){return Object.some(this,a,b)},getKeys:function(){return Object.keys(this)},getValues:function(){return Object.values(this)},toQueryString:function(a){return Object.toQueryString(this,a)}}),Hash.extend=Object.append,Hash.alias({indexOf:"keyOf",contains:"hasValue"}),function(){var a=this.Class=new Type("Class",function(d){instanceOf(d,Function)&&(d={initialize:d});var e=function(){if(c(this),e.$prototyping)return this;this.$caller=null;var a=this.initialize?this.initialize.apply(this,arguments):this;return this.$caller=this.caller=null,a}.extend(this).implement(d);return e.$constructor=a,e.prototype.$constructor=e,e.prototype.parent=b,e}),b=function(){if(!this.$caller)throw new Error('The method "parent" cannot be called.');var a=this.$caller.$name,b=this.$caller.$owner.parent,c=b?b.prototype[a]:null;if(!c)throw new Error('The method "'+a+'" has no parent.');return c.apply(this,arguments)},c=function(a){for(var b in a){var d=a[b];switch(typeOf(d)){case"object":var e=function(){};e.prototype=d,a[b]=c(new e);break;case"array":a[b]=d.clone()}}return a},d=function(a,b,c){c.$origin&&(c=c.$origin);var d=function(){if(c.$protected&&null==this.$caller)throw new Error('The method "'+b+'" cannot be called.');var a=this.caller,e=this.$caller;this.caller=e,this.$caller=d;var f=c.apply(this,arguments);return this.$caller=e,this.caller=a,f}.extend({$owner:a,$origin:c,$name:b});return d},e=function(b,c,e){if(a.Mutators.hasOwnProperty(b)&&(c=a.Mutators[b].call(this,c),null==c))return this;if("function"==typeOf(c)){if(c.$hidden)return this;this.prototype[b]=e?c:d(this,b,c)}else Object.merge(this.prototype,b,c);return this},f=function(a){a.$prototyping=!0;var b=new a;return delete a.$prototyping,b};a.implement("implement",e.overloadSetter()),a.Mutators={Extends:function(a){this.parent=a,this.prototype=f(a)},Implements:function(a){Array.from(a).each(function(a){var b=new a;for(var c in b)e.call(this,c,b[c],!0)},this)}}}(),function(){this.Chain=new Class({$chain:[],chain:function(){return this.$chain.append(Array.flatten(arguments)),this},callChain:function(){return this.$chain.length?this.$chain.shift().apply(this,arguments):!1},clearChain:function(){return this.$chain.empty(),this}});var a=function(a){return a.replace(/^on([A-Z])/,function(a,b){return b.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(b,c,d){return b=a(b),c==$empty?this:(this.$events[b]=(this.$events[b]||[]).include(c),d&&(c.internal=!0),this)},addEvents:function(a){for(var b in a)this.addEvent(b,a[b]);return this},fireEvent:function(b,c,d){b=a(b);var e=this.$events[b];return e?(c=Array.from(c),e.each(function(a){d?a.delay(d,this,c):a.apply(this,c)},this),this):this},removeEvent:function(b,c){b=a(b);var d=this.$events[b];if(d&&!c.internal){var e=d.indexOf(c);-1!=e&&delete d[e]}return this},removeEvents:function(b){var c;if("object"==typeOf(b)){for(c in b)this.removeEvent(c,b[c]);return this}b&&(b=a(b));for(c in this.$events)if(!b||b==c)for(var d=this.$events[c],e=d.length;e--;)e in d&&this.removeEvent(c,d[e]);return this}}),this.Options=new Class({setOptions:function(){var a=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent)for(var b in a)"function"==typeOf(a[b])&&/^on[A-Z]/.test(b)&&(this.addEvent(b,a[b]),delete a[b]);return this}})}(),function(){var a=this.document,b=a.window=this,c=1;this.$uid=b.ActiveXObject?function(a){return(a.uid||(a.uid=[c++]))[0]}:function(a){return a.uid||(a.uid=c++)},$uid(b),$uid(a);var d=navigator.userAgent.toLowerCase(),e=navigator.platform.toLowerCase(),f=d.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],g="ie"==f[1]&&a.documentMode,h=this.Browser={extend:Function.prototype.extend,name:"version"==f[1]?f[3]:f[1],version:g||parseFloat("opera"==f[1]&&f[4]?f[4]:f[2]),Platform:{name:d.match(/ip(?:ad|od|hone)/)?"ios":(d.match(/(?:webos|android)/)||e.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!a.evaluate,air:!!b.runtime,query:!!a.querySelector,json:!!b.JSON},Plugins:{}};h[h.name]=!0,h[h.name+parseInt(h.version,10)]=!0,h.Platform[h.Platform.name]=!0,h.Request=function(){var a=function(){return new XMLHttpRequest},b=function(){return new ActiveXObject("MSXML2.XMLHTTP")},c=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){return a(),a},function(){return b(),b},function(){return c(),c})}(),h.Features.xhr=!!h.Request;var i=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);if(h.Plugins.Flash={version:Number(i[0]||"0."+i[1])||0,build:Number(i[2])||0},h.exec=function(c){if(!c)return c;if(b.execScript)b.execScript(c);else{var d=a.createElement("script");d.setAttribute("type","text/javascript"),d.text=c,a.head.appendChild(d),a.head.removeChild(d)}return c},String.implement("stripScripts",function(a){var b="",c=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(a,c){return b+=c+"\n",""});return a===!0?h.exec(b):"function"==typeOf(a)&&a(b,c),c}),h.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event}),this.Window=this.$constructor=new Type("Window",function(){}),this.$family=Function.from("window").hide(),Window.mirror(function(a,c){b[a]=c}),this.Document=a.$constructor=new Type("Document",function(){}),a.$family=Function.from("document").hide(),Document.mirror(function(b,c){a[b]=c}),a.html=a.documentElement,a.head||(a.head=a.getElementsByTagName("head")[0]),a.execCommand)try{a.execCommand("BackgroundImageCache",!1,!0)}catch(j){}if(this.attachEvent&&!this.addEventListener){var k=function(){this.detachEvent("onunload",k),a.head=a.html=a.window=null};this.attachEvent("onunload",k)}var l=Array.from;try{l(a.html.childNodes)}catch(j){Array.from=function(a){if("string"!=typeof a&&Type.isEnumerable(a)&&"array"!=typeOf(a)){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}return l(a)};var m=Array.prototype,n=m.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(a){var b=m[a];Array[a]=function(a){return b.apply(Array.from(a),n.call(arguments,1))}})}h.Platform.ios&&(h.Platform.ipod=!0),h.Engine={};var o=function(a,b){h.Engine.name=a,h.Engine[a+b]=!0,h.Engine.version=b};if(h.ie)switch(h.Engine.trident=!0,h.version){case 6:o("trident",4);break;case 7:o("trident",5);break;case 8:o("trident",6)}if(h.firefox&&(h.Engine.gecko=!0,h.version>=3?o("gecko",19):o("gecko",18)),h.safari||h.chrome)switch(h.Engine.webkit=!0,h.version){case 2:o("webkit",419);break;case 3:o("webkit",420);break;case 4:o("webkit",525)}if(h.opera&&(h.Engine.presto=!0,h.version>=9.6?o("presto",960):h.version>=9.5?o("presto",950):o("presto",925)),"unknown"==h.name)switch((d.match(/(?:webkit|khtml|gecko)/)||[])[0]){case"webkit":case"khtml":h.Engine.webkit=!0;break;case"gecko":h.Engine.gecko=!0}this.$exec=h.exec}(),function(){function a(a,f,g,i,k,m,n,o,p,q,r,s,t,u,v,w){if((f||-1===c)&&(b.expressions[++c]=[],d=-1,f))return"";if(g||i||-1===d){g=g||" ";var x=b.expressions[c];e&&x[d]&&(x[d].reverseCombinator=j(g)),x[++d]={combinator:g,tag:"*"}}var y=b.expressions[c][d];if(k)y.tag=k.replace(h,"");else if(m)y.id=m.replace(h,"");else if(n)n=n.replace(h,""),y.classList||(y.classList=[]),y.classes||(y.classes=[]),y.classList.push(n),y.classes.push({value:n,regexp:new RegExp("(^|\\s)"+l(n)+"(\\s|$)")});else if(t)w=w||v,w=w?w.replace(h,""):null,y.pseudos||(y.pseudos=[]),y.pseudos.push({key:t.replace(h,""),value:w,type:1==s.length?"class":"element"});else if(o){o=o.replace(h,""),r=(r||"").replace(h,"");var z,A;switch(p){case"^=":A=new RegExp("^"+l(r));break;case"$=":A=new RegExp(l(r)+"$");break;case"~=":A=new RegExp("(^|\\s)"+l(r)+"(\\s|$)");break;case"|=":A=new RegExp("^"+l(r)+"(-|$)");break;case"=":z=function(a){return r==a};break;case"*=":z=function(a){return a&&a.indexOf(r)>-1};break;case"!=":z=function(a){return r!=a};break;default:z=function(a){return!!a}}""==r&&/^[*$^]=$/.test(p)&&(z=function(){return!1}),z||(z=function(a){return a&&A.test(a)}),y.attributes||(y.attributes=[]),y.attributes.push({key:o,operator:p,value:r,test:z})}return""}var b,c,d,e,f={},g={},h=/\\/g,i=function(d,h){if(null==d)return null;if(d.Slick===!0)return d;d=(""+d).replace(/^\s+|\s+$/g,""),e=!!h;var j=e?g:f;if(j[d])return j[d];for(b={Slick:!0,expressions:[],raw:d,reverse:function(){return i(this.raw,!0)}},c=-1;d!=(d=d.replace(m,a)););return b.length=b.expressions.length,j[b.raw]=e?k(b):b},j=function(a){return"!"===a?" ":" "===a?"!":/^!/.test(a)?a.replace(/^!/,""):"!"+a},k=function(a){for(var b=a.expressions,c=0;c<b.length;c++){for(var d=b[c],e={parts:[],tag:"*",combinator:j(d[0].combinator)},f=0;f<d.length;f++){var g=d[f];g.reverseCombinator||(g.reverseCombinator=" "),g.combinator=g.reverseCombinator,delete g.reverseCombinator}d.reverse().push(e)}return a},l=function(a){return a.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,function(a){return"\\"+a})},m=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+l(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),n=this.Slick||{};n.parse=function(a){return i(a)},n.escapeRegExp=l,this.Slick||(this.Slick=n)}.apply("undefined"!=typeof exports?exports:this),function(){var a={},b={},c=Object.prototype.toString;a.isNativeCode=function(a){return/\{\s*\[native code\]\s*\}/.test(""+a)},a.isXML=function(a){return!!a.xmlVersion||!!a.xml||"[object XMLDocument]"==c.call(a)||9==a.nodeType&&"HTML"!=a.documentElement.nodeName},a.setDocument=function(a){var c=a.nodeType;if(9==c);else if(c)a=a.ownerDocument;else{if(!a.navigator)return;a=a.document}if(this.document!==a){this.document=a;var d,e=a.documentElement,f=this.getUIDXML(e),g=b[f];if(g)for(d in g)this[d]=g[d];else{g=b[f]={},g.root=e,g.isXMLDocument=this.isXML(a),g.brokenStarGEBTN=g.starSelectsClosedQSA=g.idGetsName=g.brokenMixedCaseQSA=g.brokenGEBCN=g.brokenCheckedQSA=g.brokenEmptyAttributeQSA=g.isHTMLDocument=g.nativeMatchesSelector=!1;var h,i,j,k,l,m,n="slick_uniqueid",o=a.createElement("div"),p=a.body||a.getElementsByTagName("body")[0]||e;p.appendChild(o);try{o.innerHTML='<a id="'+n+'"></a>',g.isHTMLDocument=!!a.getElementById(n)}catch(q){}if(g.isHTMLDocument){o.style.display="none",o.appendChild(a.createComment("")),i=o.getElementsByTagName("*").length>1;try{o.innerHTML="foo</foo>",m=o.getElementsByTagName("*"),h=m&&!!m.length&&"/"==m[0].nodeName.charAt(0)}catch(q){}g.brokenStarGEBTN=i||h;try{o.innerHTML='<a name="'+n+'"></a><b id="'+n+'"></b>',g.idGetsName=a.getElementById(n)===o.firstChild}catch(q){}if(o.getElementsByClassName){try{o.innerHTML='<a class="f"></a><a class="b"></a>',o.getElementsByClassName("b").length,o.firstChild.className="b",k=2!=o.getElementsByClassName("b").length}catch(q){}try{o.innerHTML='<a class="a"></a><a class="f b a"></a>',j=2!=o.getElementsByClassName("a").length}catch(q){}g.brokenGEBCN=k||j}if(o.querySelectorAll){try{o.innerHTML="foo</foo>",m=o.querySelectorAll("*"),g.starSelectsClosedQSA=m&&!!m.length&&"/"==m[0].nodeName.charAt(0)}catch(q){}try{o.innerHTML='<a class="MiX"></a>',g.brokenMixedCaseQSA=!o.querySelectorAll(".MiX").length}catch(q){}try{o.innerHTML='<select><option selected="selected">a</option></select>',g.brokenCheckedQSA=0==o.querySelectorAll(":checked").length}catch(q){}try{o.innerHTML='<a class=""></a>',g.brokenEmptyAttributeQSA=0!=o.querySelectorAll('[class*=""]').length}catch(q){}}try{o.innerHTML='<form action="s"><input id="action"/></form>',l="s"!=o.firstChild.getAttribute("action")}catch(q){}if(g.nativeMatchesSelector=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector,g.nativeMatchesSelector)try{g.nativeMatchesSelector.call(e,":slick"),g.nativeMatchesSelector=null}catch(q){}}try{e.slick_expando=1,delete e.slick_expando,g.getUID=this.getUIDHTML}catch(q){g.getUID=this.getUIDXML}p.removeChild(o),o=m=p=null,g.getAttribute=g.isHTMLDocument&&l?function(a,b){var c=this.attributeGetters[b];if(c)return c.call(a);var d=a.getAttributeNode(b);return d?d.nodeValue:null}:function(a,b){var c=this.attributeGetters[b];return c?c.call(a):a.getAttribute(b)},g.hasAttribute=e&&this.isNativeCode(e.hasAttribute)?function(a,b){return a.hasAttribute(b)}:function(a,b){return a=a.getAttributeNode(b),!(!a||!a.specified&&!a.nodeValue)},g.contains=e&&this.isNativeCode(e.contains)?function(a,b){return a.contains(b)}:e&&e.compareDocumentPosition?function(a,b){return a===b||!!(16&a.compareDocumentPosition(b))}:function(a,b){if(b)do if(b===a)return!0;while(b=b.parentNode);return!1},g.documentSorter=e.compareDocumentPosition?function(a,b){return a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:a===b?0:1:0}:"sourceIndex"in e?function(a,b){return a.sourceIndex&&b.sourceIndex?a.sourceIndex-b.sourceIndex:0}:a.createRange?function(a,b){if(!a.ownerDocument||!b.ownerDocument)return 0;var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();return c.setStart(a,0),c.setEnd(a,0),d.setStart(b,0),d.setEnd(b,0),c.compareBoundaryPoints(Range.START_TO_END,d)}:null,e=null;for(d in g)this[d]=g[d]}}};var d=/^([#.]?)((?:[\w-]+|\*))$/,e=/\[.+[*$^]=(?:""|'')?\]/,f={};a.search=function(a,b,c,g){var h=this.found=g?null:c||[];if(!a)return h;if(a.navigator)a=a.document;else if(!a.nodeType)return h;var i,j,l=this.uniques={},m=!(!c||!c.length),n=9==a.nodeType;if(this.document!==(n?a:a.ownerDocument)&&this.setDocument(a),m)for(j=h.length;j--;)l[this.getUID(h[j])]=!0;if("string"==typeof b){var o=b.match(d);a:if(o){var p,q,r=o[1],s=o[2];if(r){if("#"==r){if(!this.isHTMLDocument||!n)break a;if(p=a.getElementById(s),!p)return h;if(this.idGetsName&&p.getAttributeNode("id").nodeValue!=s)break a;if(g)return p||null;m&&l[this.getUID(p)]||h.push(p)}else if("."==r){if(!this.isHTMLDocument||(!a.getElementsByClassName||this.brokenGEBCN)&&a.querySelectorAll)break a;if(a.getElementsByClassName&&!this.brokenGEBCN){if(q=a.getElementsByClassName(s),g)return q[0]||null;for(j=0;p=q[j++];)m&&l[this.getUID(p)]||h.push(p)}else{var t=new RegExp("(^|\\s)"+k.escapeRegExp(s)+"(\\s|$)");for(q=a.getElementsByTagName("*"),j=0;p=q[j++];)if(className=p.className,className&&t.test(className)){if(g)return p;m&&l[this.getUID(p)]||h.push(p)}}}}else{if("*"==s&&this.brokenStarGEBTN)break a;if(q=a.getElementsByTagName(s),g)return q[0]||null;for(j=0;p=q[j++];)m&&l[this.getUID(p)]||h.push(p)}return m&&this.sort(h),g?null:h}a:if(a.querySelectorAll){if(!this.isHTMLDocument||f[b]||this.brokenMixedCaseQSA||this.brokenCheckedQSA&&b.indexOf(":checked")>-1||this.brokenEmptyAttributeQSA&&e.test(b)||!n&&b.indexOf(",")>-1||k.disableQSA)break a;var u=b,v=a;if(!n){var w=v.getAttribute("id"),x="slickid__";v.setAttribute("id",x),u="#"+x+" "+u,a=v.parentNode}try{if(g)return a.querySelector(u)||null;q=a.querySelectorAll(u)}catch(y){f[b]=1;break a}finally{n||(w?v.setAttribute("id",w):v.removeAttribute("id"),a=v)}if(this.starSelectsClosedQSA)for(j=0;p=q[j++];)!(p.nodeName>"@")||m&&l[this.getUID(p)]||h.push(p);else for(j=0;p=q[j++];)m&&l[this.getUID(p)]||h.push(p);return m&&this.sort(h),h}if(i=this.Slick.parse(b),!i.length)return h}else{if(null==b)return h;if(!b.Slick)return this.contains(a.documentElement||a,b)?(h?h.push(b):h=b,h):h;i=b}this.posNTH={},this.posNTHLast={},this.posNTHType={},this.posNTHTypeLast={},this.push=!m&&(g||1==i.length&&1==i.expressions[0].length)?this.pushArray:this.pushUID,null==h&&(h=[]);var z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=i.expressions;a:for(j=0;K=N[j];j++)for(z=0;L=K[z];z++){if(C="combinator:"+L.combinator,!this[C])continue a;if(D=this.isXMLDocument?L.tag:L.tag.toUpperCase(),E=L.id,F=L.classList,G=L.classes,H=L.attributes,I=L.pseudos,M=z===K.length-1,this.bitUniques={},M?(this.uniques=l,this.found=h):(this.uniques={},this.found=[]),0===z){if(this[C](a,D,E,G,H,I,F),g&&M&&h.length)break a}else if(g&&M){for(A=0,B=J.length;B>A;A++)if(this[C](J[A],D,E,G,H,I,F),h.length)break a}else for(A=0,B=J.length;B>A;A++)this[C](J[A],D,E,G,H,I,F);J=this.found}return(m||i.expressions.length>1)&&this.sort(h),g?h[0]||null:h},a.uidx=1,a.uidk="slick-uniqueid",a.getUIDXML=function(a){var b=a.getAttribute(this.uidk);return b||(b=this.uidx++,a.setAttribute(this.uidk,b)),b},a.getUIDHTML=function(a){return a.uniqueNumber||(a.uniqueNumber=this.uidx++)},a.sort=function(a){return this.documentSorter?(a.sort(this.documentSorter),a):a},a.cacheNTH={},a.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/,a.parseNTHArgument=function(a){var b=a.match(this.matchNTH);if(!b)return!1;var c=b[2]||!1,d=b[1]||1;"-"==d&&(d=-1);
var e=+b[3]||0;return b="n"==c?{a:d,b:e}:"odd"==c?{a:2,b:1}:"even"==c?{a:2,b:0}:{a:0,b:d},this.cacheNTH[a]=b},a.createNTHPseudo=function(a,b,c,d){return function(e,f){var g=this.getUID(e);if(!this[c][g]){var h=e.parentNode;if(!h)return!1;var i=h[a],j=1;if(d){var k=e.nodeName;do i.nodeName==k&&(this[c][this.getUID(i)]=j++);while(i=i[b])}else do 1==i.nodeType&&(this[c][this.getUID(i)]=j++);while(i=i[b])}f=f||"n";var l=this.cacheNTH[f]||this.parseNTHArgument(f);if(!l)return!1;var m=l.a,n=l.b,o=this[c][g];if(0==m)return n==o;if(m>0){if(n>o)return!1}else if(o>n)return!1;return(o-n)%m==0}},a.pushArray=function(a,b,c,d,e,f){this.matchSelector(a,b,c,d,e,f)&&this.found.push(a)},a.pushUID=function(a,b,c,d,e,f){var g=this.getUID(a);!this.uniques[g]&&this.matchSelector(a,b,c,d,e,f)&&(this.uniques[g]=!0,this.found.push(a))},a.matchNode=function(a,b){if(this.isHTMLDocument&&this.nativeMatchesSelector)try{return this.nativeMatchesSelector.call(a,b.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(c){}var d=this.Slick.parse(b);if(!d)return!0;var e,f=d.expressions,g=0;for(e=0;currentExpression=f[e];e++)if(1==currentExpression.length){var h=currentExpression[0];if(this.matchSelector(a,this.isXMLDocument?h.tag:h.tag.toUpperCase(),h.id,h.classes,h.attributes,h.pseudos))return!0;g++}if(g==d.length)return!1;var i,j=this.search(this.document,d);for(e=0;i=j[e++];)if(i===a)return!0;return!1},a.matchPseudo=function(a,b,c){var d="pseudo:"+b;if(this[d])return this[d](a,c);var e=this.getAttribute(a,b);return c?c==e:!!e},a.matchSelector=function(a,b,c,d,e,f){if(b){var g=this.isXMLDocument?a.nodeName:a.nodeName.toUpperCase();if("*"==b){if("@">g)return!1}else if(g!=b)return!1}if(c&&a.getAttribute("id")!=c)return!1;var h,i,j;if(d)for(h=d.length;h--;)if(j=a.getAttribute("class")||a.className,!j||!d[h].regexp.test(j))return!1;if(e)for(h=e.length;h--;)if(i=e[h],i.operator?!i.test(this.getAttribute(a,i.key)):!this.hasAttribute(a,i.key))return!1;if(f)for(h=f.length;h--;)if(i=f[h],!this.matchPseudo(a,i.key,i.value))return!1;return!0};var g={" ":function(a,b,c,d,e,f,g){var h,i,j;if(this.isHTMLDocument){a:if(c){if(i=this.document.getElementById(c),!i&&a.all||this.idGetsName&&i&&i.getAttributeNode("id").nodeValue!=c){if(j=a.all[c],!j)return;for(j[0]||(j=[j]),h=0;i=j[h++];){var k=i.getAttributeNode("id");if(k&&k.nodeValue==c){this.push(i,b,null,d,e,f);break}}return}if(!i){if(this.contains(this.root,a))return;break a}if(this.document!==a&&!this.contains(a,i))return;return void this.push(i,b,null,d,e,f)}a:if(d&&a.getElementsByClassName&&!this.brokenGEBCN){if(j=a.getElementsByClassName(g.join(" ")),!j||!j.length)break a;for(h=0;i=j[h++];)this.push(i,b,c,null,e,f);return}}if(j=a.getElementsByTagName(b),j&&j.length)for(this.brokenStarGEBTN||(b=null),h=0;i=j[h++];)this.push(i,b,c,d,e,f)},">":function(a,b,c,d,e,f){if(a=a.firstChild)do 1==a.nodeType&&this.push(a,b,c,d,e,f);while(a=a.nextSibling)},"+":function(a,b,c,d,e,f){for(;a=a.nextSibling;)if(1==a.nodeType){this.push(a,b,c,d,e,f);break}},"^":function(a,b,c,d,e,f){a=a.firstChild,a&&(1==a.nodeType?this.push(a,b,c,d,e,f):this["combinator:+"](a,b,c,d,e,f))},"~":function(a,b,c,d,e,f){for(;a=a.nextSibling;)if(1==a.nodeType){var g=this.getUID(a);if(this.bitUniques[g])break;this.bitUniques[g]=!0,this.push(a,b,c,d,e,f)}},"++":function(a,b,c,d,e,f){this["combinator:+"](a,b,c,d,e,f),this["combinator:!+"](a,b,c,d,e,f)},"~~":function(a,b,c,d,e,f){this["combinator:~"](a,b,c,d,e,f),this["combinator:!~"](a,b,c,d,e,f)},"!":function(a,b,c,d,e,f){for(;a=a.parentNode;)a!==this.document&&this.push(a,b,c,d,e,f)},"!>":function(a,b,c,d,e,f){a=a.parentNode,a!==this.document&&this.push(a,b,c,d,e,f)},"!+":function(a,b,c,d,e,f){for(;a=a.previousSibling;)if(1==a.nodeType){this.push(a,b,c,d,e,f);break}},"!^":function(a,b,c,d,e,f){a=a.lastChild,a&&(1==a.nodeType?this.push(a,b,c,d,e,f):this["combinator:!+"](a,b,c,d,e,f))},"!~":function(a,b,c,d,e,f){for(;a=a.previousSibling;)if(1==a.nodeType){var g=this.getUID(a);if(this.bitUniques[g])break;this.bitUniques[g]=!0,this.push(a,b,c,d,e,f)}}};for(var h in g)a["combinator:"+h]=g[h];var i={empty:function(a){var b=a.firstChild;return!(b&&1==b.nodeType||(a.innerText||a.textContent||"").length)},not:function(a,b){return!this.matchNode(a,b)},contains:function(a,b){return(a.innerText||a.textContent||"").indexOf(b)>-1},"first-child":function(a){for(;a=a.previousSibling;)if(1==a.nodeType)return!1;return!0},"last-child":function(a){for(;a=a.nextSibling;)if(1==a.nodeType)return!1;return!0},"only-child":function(a){for(var b=a;b=b.previousSibling;)if(1==b.nodeType)return!1;for(var c=a;c=c.nextSibling;)if(1==c.nodeType)return!1;return!0},"nth-child":a.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":a.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":a.createNTHPseudo("firstChild","nextSibling","posNTHType",!0),"nth-last-of-type":a.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",!0),index:function(a,b){return this["pseudo:nth-child"](a,""+b+1)},even:function(a){return this["pseudo:nth-child"](a,"2n")},odd:function(a){return this["pseudo:nth-child"](a,"2n+1")},"first-of-type":function(a){for(var b=a.nodeName;a=a.previousSibling;)if(a.nodeName==b)return!1;return!0},"last-of-type":function(a){for(var b=a.nodeName;a=a.nextSibling;)if(a.nodeName==b)return!1;return!0},"only-of-type":function(a){for(var b=a,c=a.nodeName;b=b.previousSibling;)if(b.nodeName==c)return!1;for(var d=a;d=d.nextSibling;)if(d.nodeName==c)return!1;return!0},enabled:function(a){return!a.disabled},disabled:function(a){return a.disabled},checked:function(a){return a.checked||a.selected},focus:function(a){return this.isHTMLDocument&&this.document.activeElement===a&&(a.href||a.type||this.hasAttribute(a,"tabindex"))},root:function(a){return a===this.root},selected:function(a){return a.selected}};for(var j in i)a["pseudo:"+j]=i[j];a.attributeGetters={"class":function(){return this.getAttribute("class")||this.className},"for":function(){return"htmlFor"in this?this.htmlFor:this.getAttribute("for")},href:function(){return"href"in this?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return this.style?this.style.cssText:this.getAttribute("style")},tabindex:function(){var a=this.getAttributeNode("tabindex");return a&&a.specified?a.nodeValue:null},type:function(){return this.getAttribute("type")}};var k=a.Slick=this.Slick||{};k.version="1.1.5",k.search=function(b,c,d){return a.search(b,c,d)},k.find=function(b,c){return a.search(b,c,null,!0)},k.contains=function(b,c){return a.setDocument(b),a.contains(b,c)},k.getAttribute=function(b,c){return a.getAttribute(b,c)},k.match=function(b,c){return b&&c?c&&c!==b?(a.setDocument(b),a.matchNode(b,c)):!0:!1},k.defineAttributeGetter=function(b,c){return a.attributeGetters[b]=c,this},k.lookupAttributeGetter=function(b){return a.attributeGetters[b]},k.definePseudo=function(b,c){return a["pseudo:"+b]=function(a,b){return c.call(a,b)},this},k.lookupPseudo=function(b){var c=a["pseudo:"+b];return c?function(a){return c.call(this,a)}:null},k.override=function(b,c){return a.override(b,c),this},k.isXML=a.isXML,k.uidOf=function(b){return a.getUIDHTML(b)},this.Slick||(this.Slick=k)}.apply("undefined"!=typeof exports?exports:this);var Element=function(a,b){var c=Element.Constructors[a];if(c)return c(b);if("string"!=typeof a)return document.id(a).set(b);if(b||(b={}),!/^[\w-]+$/.test(a)){var d=Slick.parse(a).expressions[0][0];a="*"==d.tag?"div":d.tag,d.id&&null==b.id&&(b.id=d.id);var e=d.attributes;if(e)for(var f=0,g=e.length;g>f;f++){var h=e[f];null==b[h.key]&&(null!=h.value&&"="==h.operator?b[h.key]=h.value:h.value||h.operator||(b[h.key]=!0))}d.classList&&null==b["class"]&&(b["class"]=d.classList.join(" "))}return document.newElement(a,b)};Browser.Element&&(Element.prototype=Browser.Element.prototype),new Type("Element",Element).mirror(function(a){if(!Array.prototype[a]){var b={};b[a]=function(){for(var b=[],c=arguments,d=!0,e=0,f=this.length;f>e;e++){var g=this[e],h=b[e]=g[a].apply(g,c);d=d&&"element"==typeOf(h)}return d?new Elements(b):b},Elements.implement(b)}}),Browser.Element||(Element.parent=Object,Element.Prototype={$family:Function.from("element").hide()},Element.mirror(function(a,b){Element.Prototype[a]=b})),Element.Constructors={},Element.Constructors=new Hash;var IFrame=new Type("IFrame",function(){var a,b=Array.link(arguments,{properties:Type.isObject,iframe:function(a){return null!=a}}),c=b.properties||{};b.iframe&&(a=document.id(b.iframe));var d=c.onload||function(){};delete c.onload,c.id=c.name=[c.id,c.name,a?a.id||a.name:"IFrame_"+String.uniqueID()].pick(),a=new Element(a||"iframe",c);var e=function(){d.call(a.contentWindow)};return window.frames[c.id]?e():a.addListener("load",e),a}),Elements=this.Elements=function(a){if(a&&a.length)for(var b,c={},d=0;b=a[d++];){var e=Slick.uidOf(b);c[e]||(c[e]=!0,this.push(b))}};Elements.prototype={length:0},Elements.parent=Array,new Type("Elements",Elements).implement({filter:function(a,b){return a?new Elements(Array.filter(this,"string"==typeOf(a)?function(b){return b.match(a)}:a,b)):this}.protect(),push:function(){for(var a=this.length,b=0,c=arguments.length;c>b;b++){var d=document.id(arguments[b]);d&&(this[a++]=d)}return this.length=a}.protect(),unshift:function(){for(var a=[],b=0,c=arguments.length;c>b;b++){var d=document.id(arguments[b]);d&&a.push(d)}return Array.prototype.unshift.apply(this,a)}.protect(),concat:function(){for(var a=new Elements(this),b=0,c=arguments.length;c>b;b++){var d=arguments[b];Type.isEnumerable(d)?a.append(d):a.push(d)}return a}.protect(),append:function(a){for(var b=0,c=a.length;c>b;b++)this.push(a[b]);return this}.protect(),empty:function(){for(;this.length;)delete this[--this.length];return this}.protect()}),Elements.alias("extend","append"),function(){var a=Array.prototype.splice,b={0:0,1:1,length:2};a.call(b,1,1),1==b[1]&&Elements.implement("splice",function(){var b=this.length;for(a.apply(this,arguments);b>=this.length;)delete this[b--];return this}.protect()),Elements.implement(Array.prototype),Array.mirror(Elements);var c;try{var d=document.createElement("<input name=x>");c="x"==d.name}catch(e){}var f=function(a){return(""+a).replace(/&/g,"&amp;").replace(/"/g,"&quot;")};Document.implement({newElement:function(a,b){return b&&null!=b.checked&&(b.defaultChecked=b.checked),c&&b&&(a="<"+a,b.name&&(a+=' name="'+f(b.name)+'"'),b.type&&(a+=' type="'+f(b.type)+'"'),a+=">",delete b.name,delete b.type),this.id(this.createElement(a)).set(b)}})}(),Document.implement({newTextNode:function(a){return this.createTextNode(a)},getDocument:function(){return this},getWindow:function(){return this.window},id:function(){var a={string:function(b,c,d){return b=Slick.find(d,"#"+b.replace(/(\W)/g,"\\$1")),b?a.element(b,c):null},element:function(a,b){return $uid(a),b||a.$family||/^(?:object|embed)$/i.test(a.tagName)||Object.append(a,Element.Prototype),a},object:function(b,c,d){return b.toElement?a.element(b.toElement(d),c):null}};return a.textnode=a.whitespace=a.window=a.document=function(a){return a},function(b,c,d){if(b&&b.$family&&b.uid)return b;var e=typeOf(b);return a[e]?a[e](b,c,d||document):null}}()}),null==window.$&&Window.implement("$",function(a,b){return document.id(a,b,this.document)}),Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}}),[Document,Element].invoke("implement",{getElements:function(a){return Slick.search(this,a,new Elements)},getElement:function(a){return document.id(Slick.find(this,a))}}),function(a,b,c){this.Selectors={};var d=this.Selectors.Pseudo=new Hash,e=function(){for(var a in d)d.hasOwnProperty(a)&&(Slick.definePseudo(a,d[a]),delete d[a])};Slick.search=function(b,c,d){return e(),a.call(this,b,c,d)},Slick.find=function(a,c){return e(),b.call(this,a,c)},Slick.match=function(a,b){return e(),c.call(this,a,b)}}(Slick.search,Slick.find,Slick.match),null==window.$$&&Window.implement("$$",function(a){var b=new Elements;if(1==arguments.length&&"string"==typeof a)return Slick.search(this.document,a,b);for(var c=Array.flatten(arguments),d=0,e=c.length;e>d;d++){var f=c[d];switch(typeOf(f)){case"element":b.push(f);break;case"string":Slick.search(this.document,f,b)}}return b}),null==window.$$&&Window.implement("$$",function(a){if(1==arguments.length){if("string"==typeof a)return Slick.search(this.document,a,new Elements);if(Type.isEnumerable(a))return new Elements(a)}return new Elements(arguments)}),function(){var a={},b={},c={input:"checked",option:"selected",textarea:"value"},d=function(a){return b[a]||(b[a]={})},e=function(c){var d=c.uid;return c.removeEvents&&c.removeEvents(),c.clearAttributes&&c.clearAttributes(),null!=d&&(delete a[d],delete b[d]),c},f=["defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","maxLength","readOnly","rowSpan","tabIndex","useMap"],g=["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked"],h={html:"innerHTML","class":"className","for":"htmlFor",text:function(){var a=document.createElement("div");return null==a.textContent?"innerText":"textContent"}()},i=["type"],j=["value","defaultValue"],k=/^(?:href|src|usemap)$/i;g=g.associate(g),f=f.associate(f.map(String.toLowerCase)),i=i.associate(i),Object.append(h,j.associate(j));var l={before:function(a,b){var c=b.parentNode;c&&c.insertBefore(a,b)},after:function(a,b){var c=b.parentNode;c&&c.insertBefore(a,b.nextSibling)},bottom:function(a,b){b.appendChild(a)},top:function(a,b){b.insertBefore(a,b.firstChild)}};l.inside=l.bottom,Object.each(l,function(a,b){b=b.capitalize();var c={};c["inject"+b]=function(b){return a(this,document.id(b,!0)),this},c["grab"+b]=function(b){return a(document.id(b,!0),this),this},Element.implement(c)});var m=function(a,b){if(!a)return b;a=Object.clone(Slick.parse(a));for(var c=a.expressions,d=c.length;d--;)c[d][0].combinator=b;return a};Element.implement({set:function(a,b){var c=Element.Properties[a];c&&c.set?c.set.call(this,b):this.setProperty(a,b)}.overloadSetter(),get:function(a){var b=Element.Properties[a];return b&&b.get?b.get.apply(this):this.getProperty(a)}.overloadGetter(),erase:function(a){var b=Element.Properties[a];return b&&b.erase?b.erase.apply(this):this.removeProperty(a),this},setProperty:function(a,b){if(a=f[a]||a,null==b)return this.removeProperty(a);var c=h[a];return c?this[c]=b:g[a]?this[a]=!!b:this.setAttribute(a,""+b),this},setProperties:function(a){for(var b in a)this.setProperty(b,a[b]);return this},getProperty:function(a){a=f[a]||a;var b=h[a]||i[a];return b?this[b]:g[a]?!!this[a]:(k.test(a)?this.getAttribute(a,2):(b=this.getAttributeNode(a))?b.nodeValue:null)||null},getProperties:function(){var a=Array.from(arguments);return a.map(this.getProperty,this).associate(a)},removeProperty:function(a){a=f[a]||a;var b=h[a];return b?this[b]="":g[a]?this[a]=!1:this.removeAttribute(a),this},removeProperties:function(){return Array.each(arguments,this.removeProperty,this),this},hasClass:function(a){return this.className.clean().contains(a," ")},addClass:function(a){return this.hasClass(a)||(this.className=(this.className+" "+a).clean()),this},removeClass:function(a){return this.className=this.className.replace(new RegExp("(^|\\s)"+a+"(?:\\s|$)"),"$1"),this},toggleClass:function(a,b){return null==b&&(b=!this.hasClass(a)),b?this.addClass(a):this.removeClass(a)},adopt:function(){var a,b=this,c=Array.flatten(arguments),d=c.length;d>1&&(b=a=document.createDocumentFragment());for(var e=0;d>e;e++){var f=document.id(c[e],!0);f&&b.appendChild(f)}return a&&this.appendChild(a),this},appendText:function(a,b){return this.grab(this.getDocument().newTextNode(a),b)},grab:function(a,b){return l[b||"bottom"](document.id(a,!0),this),this},inject:function(a,b){return l[b||"bottom"](this,document.id(a,!0)),this},replaces:function(a){return a=document.id(a,!0),a.parentNode.replaceChild(this,a),this},wraps:function(a,b){return a=document.id(a,!0),this.replaces(a).grab(a,b)},getPrevious:function(a){return document.id(Slick.find(this,m(a,"!~")))},getAllPrevious:function(a){return Slick.search(this,m(a,"!~"),new Elements)},getNext:function(a){return document.id(Slick.find(this,m(a,"~")))},getAllNext:function(a){return Slick.search(this,m(a,"~"),new Elements)},getFirst:function(a){return document.id(Slick.search(this,m(a,">"))[0])},getLast:function(a){return document.id(Slick.search(this,m(a,">")).getLast())},getParent:function(a){return document.id(Slick.find(this,m(a,"!")))},getParents:function(a){return Slick.search(this,m(a,"!"),new Elements)},getSiblings:function(a){return Slick.search(this,m(a,"~~"),new Elements)},getChildren:function(a){return Slick.search(this,m(a,">"),new Elements)},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(a){return document.id(Slick.find(this,"#"+(""+a).replace(/(\W)/g,"\\$1")))},getSelected:function(){return this.selectedIndex,new Elements(Array.from(this.options).filter(function(a){return a.selected}))},toQueryString:function(){var a=[];return this.getElements("input, select, textarea").each(function(b){var c=b.type;if(b.name&&!b.disabled&&"submit"!=c&&"reset"!=c&&"file"!=c&&"image"!=c){var d="select"==b.get("tag")?b.getSelected().map(function(a){return document.id(a).get("value")}):"radio"!=c&&"checkbox"!=c||b.checked?b.get("value"):null;Array.from(d).each(function(c){"undefined"!=typeof c&&a.push(encodeURIComponent(b.name)+"="+encodeURIComponent(c))})}}),a.join("&")},destroy:function(){var a=e(this).getElementsByTagName("*");return Array.each(a,e),Element.dispose(this),null},empty:function(){return Array.from(this.childNodes).each(Element.dispose),this},dispose:function(){return this.parentNode?this.parentNode.removeChild(this):this},match:function(a){return!a||Slick.match(this,a)}});var n=function(a,b,d){if(d||a.setAttributeNode(document.createAttribute("id")),a.clearAttributes&&(a.clearAttributes(),a.mergeAttributes(b),a.removeAttribute("uid"),a.options))for(var e=a.options,f=b.options,g=e.length;g--;)e[g].selected=f[g].selected;var h=c[b.tagName.toLowerCase()];h&&b[h]&&(a[h]=b[h])};Element.implement("clone",function(a,b){a=a!==!1;var c,d=this.cloneNode(a);if(a){var e=d.getElementsByTagName("*"),f=this.getElementsByTagName("*");for(c=e.length;c--;)n(e[c],f[c],b)}if(n(d,this,b),Browser.ie){var g=d.getElementsByTagName("object"),h=this.getElementsByTagName("object");for(c=g.length;c--;)g[c].outerHTML=h[c].outerHTML}return document.id(d)});var o={contains:function(a){return Slick.contains(this,a)}};document.contains||Document.implement(o),document.createElement("div").contains||Element.implement(o),Element.implement("hasChild",function(a){return this!==a&&this.contains(a)}),[Element,Window,Document].invoke("implement",{addListener:function(b,c){if("unload"==b){var d=c,e=this;c=function(){e.removeListener("unload",c),d()}}else a[$uid(this)]=this;return this.addEventListener?this.addEventListener(b,c,!!arguments[2]):this.attachEvent("on"+b,c),this},removeListener:function(a,b){return this.removeEventListener?this.removeEventListener(a,b,!!arguments[2]):this.detachEvent("on"+a,b),this},retrieve:function(a,b){var c=d($uid(this)),e=c[a];return null!=b&&null==e&&(e=c[a]=b),null!=e?e:null},store:function(a,b){var c=d($uid(this));return c[a]=b,this},eliminate:function(a){var b=d($uid(this));return delete b[a],this}}),window.attachEvent&&!window.addEventListener&&window.addListener("unload",function(){Object.each(a,e),window.CollectGarbage&&CollectGarbage()})}(),Element.Properties={},Element.Properties=new Hash,Element.Properties.style={set:function(a){this.style.cssText=a},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}},Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}},function(a){null!=a&&(Element.Properties.maxlength=Element.Properties.maxLength={get:function(){var b=this.getAttribute("maxLength");return b==a?null:b}})}(document.createElement("input").getAttribute("maxLength")),Element.Properties.html=function(){var a=Function.attempt(function(){var a=document.createElement("table");a.innerHTML="<tr><td></td></tr>"}),b=document.createElement("div"),c={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]};c.thead=c.tfoot=c.tbody;var d={set:function(){var d=Array.flatten(arguments).join(""),e=!a&&c[this.get("tag")];if(e){var f=b;f.innerHTML=e[1]+d+e[2];for(var g=e[0];g--;)f=f.firstChild;this.empty().adopt(f.childNodes)}else this.innerHTML=d}};return d.erase=d.set,d}(),function(){var a=document.html;Element.Properties.styles={set:function(a){this.setStyles(a)}};var b=null!=a.style.opacity,c=/alpha\(opacity=([\d.]+)\)/i,d=function(a,d){if(a.currentStyle&&a.currentStyle.hasLayout||(a.style.zoom=1),b)a.style.opacity=d;else{d=(100*d).limit(0,100).round(),d=100==d?"":"alpha(opacity="+d+")";var e=a.style.filter||a.getComputedStyle("filter")||"";a.style.filter=c.test(e)?e.replace(c,d):e+d}};Element.Properties.opacity={set:function(a){var b=this.style.visibility;0==a&&"hidden"!=b?this.style.visibility="hidden":0!=a&&"visible"!=b&&(this.style.visibility="visible"),d(this,a)},get:b?function(){var a=this.style.opacity||this.getComputedStyle("opacity");return""==a?1:a}:function(){var a,b=this.style.filter||this.getComputedStyle("filter");return b&&(a=b.match(c)),null==a||null==b?1:a[1]/100}};var e=null==a.style.cssFloat?"styleFloat":"cssFloat";Element.implement({getComputedStyle:function(a){if(this.currentStyle)return this.currentStyle[a.camelCase()];var b=Element.getDocument(this).defaultView,c=b?b.getComputedStyle(this,null):null;return c?c.getPropertyValue(a==e?"float":a.hyphenate()):null},setOpacity:function(a){return d(this,a),this},getOpacity:function(){return this.get("opacity")},setStyle:function(a,b){switch(a){case"opacity":return this.set("opacity",parseFloat(b));case"float":a=e}if(a=a.camelCase(),"string"!=typeOf(b)){var c=(Element.Styles[a]||"@").split(" ");b=Array.from(b).map(function(a,b){return c[b]?"number"==typeOf(a)?c[b].replace("@",Math.round(a)):a:""}).join(" ")}else b==String(Number(b))&&(b=Math.round(b));return this.style[a]=b,this},getStyle:function(a){switch(a){case"opacity":return this.get("opacity");case"float":a=e}a=a.camelCase();var b=this.style[a];if(!b||"zIndex"==a){b=[];for(var c in Element.ShortStyles)if(a==c){for(var d in Element.ShortStyles[c])b.push(this.getStyle(d));return b.join(" ")}b=this.getComputedStyle(a)}if(b){b=String(b);var f=b.match(/rgba?\([\d\s,]+\)/);f&&(b=b.replace(f[0],f[0].rgbToHex()))}if(Browser.opera||Browser.ie&&isNaN(parseFloat(b))){if(/^(height|width)$/.test(a)){var g="width"==a?["left","right"]:["top","bottom"],h=0;return g.each(function(a){h+=this.getStyle("border-"+a+"-width").toInt()+this.getStyle("padding-"+a).toInt()},this),this["offset"+a.capitalize()]-h+"px"}if(Browser.opera&&-1!=String(b).indexOf("px"))return b;if(/^border(.+)Width|margin|padding/.test(a))return"0px"}return b},setStyles:function(a){for(var b in a)this.setStyle(b,a[b]);return this},getStyles:function(){var a={};return Array.flatten(arguments).each(function(b){a[b]=this.getStyle(b)},this),a}}),Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"},Element.Styles=new Hash(Element.Styles),Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}},["Top","Right","Bottom","Left"].each(function(a){var b=Element.ShortStyles,c=Element.Styles;["margin","padding"].each(function(d){var e=d+a;b[d][e]=c[e]="@px"});var d="border"+a;b.border[d]=c[d]="@px @ rgb(@, @, @)";var e=d+"Width",f=d+"Style",g=d+"Color";b[d]={},b.borderWidth[e]=b[d][e]=c[e]="@px",b.borderStyle[f]=b[d][f]=c[f]="@",b.borderColor[g]=b[d][g]=c[g]="rgb(@, @, @)"})}(),function(){function a(a,b){return l(a,b).toInt()||0}function b(a){return"border-box"==l(a,"-moz-box-sizing")}function c(b){return a(b,"border-top-width")}function d(b){return a(b,"border-left-width")}function e(a){return/^(?:body|html)$/i.test(a.tagName)}function f(a){var b=a.getDocument();return b.compatMode&&"CSS1Compat"!=b.compatMode?b.body:b.html}var g=document.createElement("div"),h=document.createElement("div");g.style.height="0",g.appendChild(h);var i=h.offsetParent===g;g=h=null;var j=function(a){return"static"!=l(a,"position")||e(a)},k=function(a){return j(a)||/^(?:table|td|th)$/i.test(a.tagName)};Element.implement({scrollTo:function(a,b){return e(this)?this.getWindow().scrollTo(a,b):(this.scrollLeft=a,this.scrollTop=b),this},getSize:function(){return e(this)?this.getWindow().getSize():{x:this.offsetWidth,y:this.offsetHeight}},getScrollSize:function(){return e(this)?this.getWindow().getScrollSize():{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){return e(this)?this.getWindow().getScroll():{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){for(var a=this.parentNode,b={x:0,y:0};a&&!e(a);)b.x+=a.scrollLeft,b.y+=a.scrollTop,a=a.parentNode;return b},getOffsetParent:i?function(){var a=this;if(e(a)||"fixed"==l(a,"position"))return null;for(var b="static"==l(a,"position")?k:j;a=a.parentNode;)if(b(a))return a;return null}:function(){var a=this;if(e(a)||"fixed"==l(a,"position"))return null;try{return a.offsetParent}catch(b){}return null},getOffsets:function(){if(this.getBoundingClientRect&&!Browser.Platform.ios){var a=this.getBoundingClientRect(),f=document.id(this.getDocument().documentElement),g=f.getScroll(),h=this.getScrolls(),i="fixed"==l(this,"position");return{x:a.left.toInt()+h.x+(i?0:g.x)-f.clientLeft,y:a.top.toInt()+h.y+(i?0:g.y)-f.clientTop}}var j=this,k={x:0,y:0};if(e(this))return k;for(;j&&!e(j);){if(k.x+=j.offsetLeft,k.y+=j.offsetTop,Browser.firefox){b(j)||(k.x+=d(j),k.y+=c(j));var m=j.parentNode;m&&"visible"!=l(m,"overflow")&&(k.x+=d(m),k.y+=c(m))}else j!=this&&Browser.safari&&(k.x+=d(j),k.y+=c(j));j=j.offsetParent}return Browser.firefox&&!b(this)&&(k.x-=d(this),k.y-=c(this)),k},getPosition:function(a){if(e(this))return{x:0,y:0};var b=this.getOffsets(),f=this.getScrolls(),g={x:b.x-f.x,y:b.y-f.y};if(a&&(a=document.id(a))){var h=a.getPosition();return{x:g.x-h.x-d(a),y:g.y-h.y-c(a)}}return g},getCoordinates:function(a){if(e(this))return this.getWindow().getCoordinates();var b=this.getPosition(a),c=this.getSize(),d={left:b.x,top:b.y,width:c.x,height:c.y};return d.right=d.left+d.width,d.bottom=d.top+d.height,d},computePosition:function(b){return{left:b.x-a(this,"margin-left"),top:b.y-a(this,"margin-top")}},setPosition:function(a){return this.setStyles(this.computePosition(a))}}),[Document,Window].invoke("implement",{getSize:function(){var a=f(this);return{x:a.clientWidth,y:a.clientHeight}},getScroll:function(){var a=this.getWindow(),b=f(this);return{x:a.pageXOffset||b.scrollLeft,y:a.pageYOffset||b.scrollTop}},getScrollSize:function(){var a=f(this),b=this.getSize(),c=this.getDocument().body;return{x:Math.max(a.scrollWidth,c.scrollWidth,b.x),y:Math.max(a.scrollHeight,c.scrollHeight,b.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var a=this.getSize();return{top:0,left:0,bottom:a.y,right:a.x,height:a.y,width:a.x}}});var l=Element.getComputedStyle}(),Element.alias({position:"setPosition"}),[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}});var Event=new Type("Event",function(a,b){b||(b=window);var c=b.document;if(a=a||b.event,a.$extended)return a;this.$extended=!0;for(var d,e,f,g,h=a.type,i=a.target||a.srcElement,j={},k={},l=null;i&&3==i.nodeType;)i=i.parentNode;if(-1!=h.indexOf("key")){if(f=a.which||a.keyCode,g=Object.keyOf(Event.Keys,f),"keydown"==h){var m=f-111;m>0&&13>m&&(g="f"+m)}g||(g=String.fromCharCode(f).toLowerCase())}else if(/click|mouse|menu/i.test(h)){if(c=c.compatMode&&"CSS1Compat"!=c.compatMode?c.body:c.html,j={x:null!=a.pageX?a.pageX:a.clientX+c.scrollLeft,y:null!=a.pageY?a.pageY:a.clientY+c.scrollTop},k={x:null!=a.pageX?a.pageX-b.pageXOffset:a.clientX,y:null!=a.pageY?a.pageY-b.pageYOffset:a.clientY},/DOMMouseScroll|mousewheel/.test(h)&&(e=a.wheelDelta?a.wheelDelta/120:-(a.detail||0)/3),d=3==a.which||2==a.button,/over|out/.test(h)){l=a.relatedTarget||a[("mouseover"==h?"from":"to")+"Element"];var n=function(){for(;l&&3==l.nodeType;)l=l.parentNode;return!0},o=Browser.firefox2?n.attempt():n();l=o?l:null}}else if(/gesture|touch/i.test(h)){this.rotation=a.rotation,this.scale=a.scale,this.targetTouches=a.targetTouches,this.changedTouches=a.changedTouches;var p=this.touches=a.touches;if(p&&p[0]){var q=p[0];j={x:q.pageX,y:q.pageY},k={x:q.clientX,y:q.clientY}}}return Object.append(this,{event:a,type:h,page:j,client:k,rightClick:d,wheel:e,relatedTarget:document.id(l),target:document.id(i),code:f,key:g,shift:a.shiftKey,control:a.ctrlKey,alt:a.altKey,meta:a.metaKey})});Event.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46},Event.Keys=new Hash(Event.Keys),Event.implement({stop:function(){return this.stopPropagation().preventDefault()},stopPropagation:function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0,this},preventDefault:function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1,this}}),function(){Element.Properties.events={set:function(a){this.addEvents(a)}},[Element,Window,Document].invoke("implement",{addEvent:function(a,b){var c=this.retrieve("events",{});if(c[a]||(c[a]={keys:[],values:[]}),c[a].keys.contains(b))return this;c[a].keys.push(b);var d=a,e=Element.Events[a],f=b,g=this;e&&(e.onAdd&&e.onAdd.call(this,b),e.condition&&(f=function(a){return e.condition.call(this,a)?b.call(this,a):!0}),d=e.base||d);var h=function(){return b.call(g)},i=Element.NativeEvents[d];return i&&(2==i&&(h=function(a){a=new Event(a,g.getWindow()),f.call(g,a)===!1&&a.stop()}),this.addListener(d,h,arguments[2])),c[a].values.push(h),this},removeEvent:function(a,b){var c=this.retrieve("events");if(!c||!c[a])return this;var d=c[a],e=d.keys.indexOf(b);if(-1==e)return this;var f=d.values[e];delete d.keys[e],delete d.values[e];var g=Element.Events[a];return g&&(g.onRemove&&g.onRemove.call(this,b),a=g.base||a),Element.NativeEvents[a]?this.removeListener(a,f,arguments[2]):this},addEvents:function(a){for(var b in a)this.addEvent(b,a[b]);return this},removeEvents:function(a){var b;if("object"==typeOf(a)){for(b in a)this.removeEvent(b,a[b]);return this}var c=this.retrieve("events");if(!c)return this;if(a)c[a]&&(c[a].keys.each(function(b){this.removeEvent(a,b)},this),delete c[a]);else{for(b in c)this.removeEvents(b);this.eliminate("events")}return this},fireEvent:function(a,b,c){var d=this.retrieve("events");return d&&d[a]?(b=Array.from(b),d[a].keys.each(function(a){c?a.delay(c,this,b):a.apply(this,b)},this),this):this},cloneEvents:function(a,b){a=document.id(a);var c=a.retrieve("events");if(!c)return this;if(b)c[b]&&c[b].keys.each(function(a){this.addEvent(b,a)},this);else for(var d in c)this.cloneEvents(a,d);return this}}),Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,
mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};var a=function(a){var b=a.relatedTarget;return null==b?!0:b?b!=this&&"xul"!=b.prefix&&"document"!=typeOf(this)&&!this.contains(b):!1};Element.Events={mouseenter:{base:"mouseover",condition:a},mouseleave:{base:"mouseout",condition:a},mousewheel:{base:Browser.firefox?"DOMMouseScroll":"mousewheel"}},Element.Events=new Hash(Element.Events)}(),function(){var a=this.Fx=new Class({Implements:[Chain,Events,Options],options:{fps:60,unit:!1,duration:500,frames:null,frameSkip:!0,link:"ignore"},initialize:function(a){this.subject=this.subject||this,this.setOptions(a)},getTransition:function(){return function(a){return-(Math.cos(Math.PI*a)-1)/2}},step:function(a){if(this.options.frameSkip){var b=null!=this.time?a-this.time:0,c=b/this.frameInterval;this.time=a,this.frame+=c}else this.frame++;if(this.frame<this.frames){var d=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,d))}else this.frame=this.frames,this.set(this.compute(this.from,this.to,1)),this.stop()},set:function(a){return a},compute:function(b,c,d){return a.compute(b,c,d)},check:function(){if(!this.isRunning())return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},start:function(b,c){if(!this.check(b,c))return this;this.from=b,this.to=c,this.frame=this.options.frameSkip?0:-1,this.time=null,this.transition=this.getTransition();var d=this.options.frames,f=this.options.fps,g=this.options.duration;return this.duration=a.Durations[g]||g.toInt(),this.frameInterval=1e3/f,this.frames=d||Math.round(this.duration/this.frameInterval),this.fireEvent("start",this.subject),e.call(this,f),this},stop:function(){return this.isRunning()&&(this.time=null,f.call(this,this.options.fps),this.frames==this.frame?(this.fireEvent("complete",this.subject),this.callChain()||this.fireEvent("chainComplete",this.subject)):this.fireEvent("stop",this.subject)),this},cancel:function(){return this.isRunning()&&(this.time=null,f.call(this,this.options.fps),this.frame=this.frames,this.fireEvent("cancel",this.subject).clearChain()),this},pause:function(){return this.isRunning()&&(this.time=null,f.call(this,this.options.fps)),this},resume:function(){return this.frame<this.frames&&!this.isRunning()&&e.call(this,this.options.fps),this},isRunning:function(){var a=b[this.options.fps];return a&&a.contains(this)}});a.compute=function(a,b,c){return(b-a)*c+a},a.Durations={"short":250,normal:500,"long":1e3};var b={},c={},d=function(){for(var a=Date.now(),b=this.length;b--;){var c=this[b];c&&c.step(a)}},e=function(a){var e=b[a]||(b[a]=[]);e.push(this),c[a]||(c[a]=d.periodical(Math.round(1e3/a),e))},f=function(a){var d=b[a];d&&(d.erase(this),!d.length&&c[a]&&(delete b[a],c[a]=clearInterval(c[a])))}}(),Fx.CSS=new Class({Extends:Fx,prepare:function(a,b,c){c=Array.from(c),null==c[1]&&(c[1]=c[0],c[0]=a.getStyle(b));var d=c.map(this.parse);return{from:d[0],to:d[1]}},parse:function(a){return a=Function.from(a)(),a="string"==typeof a?a.split(" "):Array.from(a),a.map(function(a){a=String(a);var b=!1;return Object.each(Fx.CSS.Parsers,function(c,d){if(!b){var e=c.parse(a);(e||0===e)&&(b={value:e,parser:c})}}),b=b||{value:a,parser:Fx.CSS.Parsers.String}})},compute:function(a,b,c){var d=[];return Math.min(a.length,b.length).times(function(e){d.push({value:a[e].parser.compute(a[e].value,b[e].value,c),parser:a[e].parser})}),d.$family=Function.from("fx:css:value"),d},serve:function(a,b){"fx:css:value"!=typeOf(a)&&(a=this.parse(a));var c=[];return a.each(function(a){c=c.concat(a.parser.serve(a.value,b))}),c},render:function(a,b,c,d){a.setStyle(b,this.serve(c,d))},search:function(a){if(Fx.CSS.Cache[a])return Fx.CSS.Cache[a];var b={},c=new RegExp("^"+a.escapeRegExp()+"$");return Array.each(document.styleSheets,function(a,d){var e=a.href;if(!e||!e.contains("://")||e.contains(document.domain)){var f=a.rules||a.cssRules;Array.each(f,function(a,d){if(a.style){var e=a.selectorText?a.selectorText.replace(/^\w+/,function(a){return a.toLowerCase()}):null;e&&c.test(e)&&Object.each(Element.Styles,function(c,d){a.style[d]&&!Element.ShortStyles[d]&&(c=String(a.style[d]),b[d]=/^rgb/.test(c)?c.rgbToHex():c)})}})}}),Fx.CSS.Cache[a]=b}}),Fx.CSS.Cache={},Fx.CSS.Parsers={Color:{parse:function(a){return a.match(/^#[0-9a-f]{3,6}$/i)?a.hexToRgb(!0):(a=a.match(/(\d+),\s*(\d+),\s*(\d+)/))?[a[1],a[2],a[3]]:!1},compute:function(a,b,c){return a.map(function(d,e){return Math.round(Fx.compute(a[e],b[e],c))})},serve:function(a){return a.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(a,b){return b?a+b:a}},String:{parse:Function.from(!1),compute:function(a,b){return b},serve:function(a){return a}}},Fx.CSS.Parsers=new Hash(Fx.CSS.Parsers),Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(a,b){this.element=this.subject=document.id(a),this.parent(b)},set:function(a){"string"==typeof a&&(a=this.search(a));for(var b in a)this.render(this.element,b,a[b],this.options.unit);return this},compute:function(a,b,c){var d={};for(var e in a)d[e]=this.parent(a[e],b[e],c);return d},start:function(a){if(!this.check(a))return this;"string"==typeof a&&(a=this.search(a));var b={},c={};for(var d in a){var e=this.prepare(this.element,d,a[d]);b[d]=e.from,c[d]=e.to}return this.parent(b,c)}}),Element.Properties.morph={set:function(a){return this.get("morph").cancel().setOptions(a),this},get:function(){var a=this.retrieve("morph");return a||(a=new Fx.Morph(this,{link:"cancel"}),this.store("morph",a)),a}},Element.implement({morph:function(a){return this.get("morph").start(a),this}}),Fx.implement({getTransition:function(){var a=this.options.transition||Fx.Transitions.Sine.easeInOut;if("string"==typeof a){var b=a.split(":");a=Fx.Transitions,a=a[b[0]]||a[b[0].capitalize()],b[1]&&(a=a["ease"+b[1].capitalize()+(b[2]?b[2].capitalize():"")])}return a}}),Fx.Transition=function(a,b){b=Array.from(b);var c=function(c){return a(c,b)};return Object.append(c,{easeIn:c,easeOut:function(c){return 1-a(1-c,b)},easeInOut:function(c){return(.5>=c?a(2*c,b):2-a(2*(1-c),b))/2}})},Fx.Transitions={linear:function(a){return a}},Fx.Transitions=new Hash(Fx.Transitions),Fx.Transitions.extend=function(a){for(var b in a)Fx.Transitions[b]=new Fx.Transition(a[b])},Fx.Transitions.extend({Pow:function(a,b){return Math.pow(a,b&&b[0]||6)},Expo:function(a){return Math.pow(2,8*(a-1))},Circ:function(a){return 1-Math.sin(Math.acos(a))},Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Back:function(a,b){return b=b&&b[0]||1.618,Math.pow(a,2)*((b+1)*a-b)},Bounce:function(a){for(var b,c=0,d=1;1;c+=d,d/=2)if(a>=(7-4*c)/11){b=d*d-Math.pow((11-6*c-11*a)/4,2);break}return b},Elastic:function(a,b){return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b&&b[0]||1)/3)}}),["Quad","Cubic","Quart","Quint"].each(function(a,b){Fx.Transitions[a]=new Fx.Transition(function(a){return Math.pow(a,b+2)})}),Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(a,b){this.element=this.subject=document.id(a),this.parent(b)},set:function(a,b){return 1==arguments.length&&(b=a,a=this.property||this.options.property),this.render(this.element,a,b,this.options.unit),this},start:function(a,b,c){if(!this.check(a,b,c))return this;var d=Array.flatten(arguments);this.property=this.options.property||d.shift();var e=this.prepare(this.element,this.property,d);return this.parent(e.from,e.to)}}),Element.Properties.tween={set:function(a){return this.get("tween").cancel().setOptions(a),this},get:function(){var a=this.retrieve("tween");return a||(a=new Fx.Tween(this,{link:"cancel"}),this.store("tween",a)),a}},Element.implement({tween:function(a,b,c){return this.get("tween").start(arguments),this},fade:function(a){var b,c=this.get("tween"),d="opacity";switch(a=[a,"toggle"].pick()){case"in":c.start(d,1);break;case"out":c.start(d,0);break;case"show":c.set(d,1);break;case"hide":c.set(d,0);break;case"toggle":var e=this.retrieve("fade:flag",1==this.get("opacity"));c.start(d,e?0:1),this.store("fade:flag",!e),b=!0;break;default:c.start(d,arguments)}return b||this.eliminate("fade:flag"),this},highlight:function(a,b){b||(b=this.retrieve("highlight:original",this.getStyle("background-color")),b="transparent"==b?"#fff":b);var c=this.get("tween");return c.start("background-color",a||"#ffff88",b).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original")),c.callChain()}.bind(this)),this}}),function(){var a=function(){},b="onprogress"in new Browser.Request,c=this.Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,format:!1,method:"post",link:"ignore",isSuccess:null,emulation:!0,urlEncoded:!0,encoding:"utf-8",evalScripts:!1,evalResponse:!1,timeout:0,noCache:!1},initialize:function(a){this.xhr=new Browser.Request,this.setOptions(a),this.headers=this.options.headers},onStateChange:function(){var c=this.xhr;4==c.readyState&&this.running&&(this.running=!1,this.status=0,Function.attempt(function(){var a=c.status;this.status=1223==a?204:a}.bind(this)),c.onreadystatechange=a,b&&(c.onprogress=c.onloadstart=a),clearTimeout(this.timer),this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML},this.options.isSuccess.call(this,this.status)?this.success(this.response.text,this.response.xml):this.failure())},isSuccess:function(){var a=this.status;return a>=200&&300>a},isRunning:function(){return!!this.running},processScripts:function(a){return this.options.evalResponse||/(ecma|java)script/.test(this.getHeader("Content-type"))?Browser.exec(a):a.stripScripts(this.options.evalScripts)},success:function(a,b){this.onSuccess(this.processScripts(a),b)},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure()},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(a){this.fireEvent("loadstart",[a,this.xhr])},progress:function(a){this.fireEvent("progress",[a,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr)},setHeader:function(a,b){return this.headers[a]=b,this},getHeader:function(a){return Function.attempt(function(){return this.xhr.getResponseHeader(a)}.bind(this))},check:function(){if(!this.running)return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},send:function(a){if(!this.check(a))return this;this.options.isSuccess=this.options.isSuccess||this.isSuccess,this.running=!0;var c=typeOf(a);("string"==c||"element"==c)&&(a={data:a});var d=this.options;a=Object.append({data:d.data,url:d.url,method:d.method},a);var e=a.data,f=String(a.url),g=a.method.toLowerCase();switch(typeOf(e)){case"element":e=document.id(e).toQueryString();break;case"object":case"hash":e=Object.toQueryString(e)}if(this.options.format){var h="format="+this.options.format;e=e?h+"&"+e:h}if(this.options.emulation&&!["get","post"].contains(g)){var i="_method="+g;e=e?i+"&"+e:i,g="post"}if(this.options.urlEncoded&&["post","put"].contains(g)){var j=this.options.encoding?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+j}f||(f=document.location.pathname);var k=f.lastIndexOf("/");k>-1&&(k=f.indexOf("#"))>-1&&(f=f.substr(0,k)),this.options.noCache&&(f+=(f.contains("?")?"&":"?")+String.uniqueID()),e&&"get"==g&&(f+=(f.contains("?")?"&":"?")+e,e=null);var l=this.xhr;return b&&(l.onloadstart=this.loadstart.bind(this),l.onprogress=this.progress.bind(this)),l.open(g.toUpperCase(),f,this.options.async,this.options.user,this.options.password),this.options.user&&"withCredentials"in l&&(l.withCredentials=!0),l.onreadystatechange=this.onStateChange.bind(this),Object.each(this.headers,function(a,b){try{l.setRequestHeader(b,a)}catch(c){this.fireEvent("exception",[b,a])}},this),this.fireEvent("request"),l.send(e),this.options.async||this.onStateChange(),this.options.timeout&&(this.timer=this.timeout.delay(this.options.timeout,this)),this},cancel:function(){if(!this.running)return this;this.running=!1;var c=this.xhr;return c.abort(),clearTimeout(this.timer),c.onreadystatechange=a,b&&(c.onprogress=c.onloadstart=a),this.xhr=new Browser.Request,this.fireEvent("cancel"),this}}),d={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(a){d[a]=function(b){var c={method:a};return null!=b&&(c.data=b),this.send(c)}}),c.implement(d),Element.Properties.send={set:function(a){var b=this.get("send").cancel();return b.setOptions(a),this},get:function(){var a=this.retrieve("send");return a||(a=new c({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")}),this.store("send",a)),a}},Element.implement({send:function(a){var b=this.get("send");return b.send({data:this,url:a||b.options.url}),this}})}(),Request.HTML=new Class({Extends:Request,options:{update:!1,append:!1,evalScripts:!0,filter:!1,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(a){var b=this.options,c=this.response;c.html=a.stripScripts(function(a){c.javascript=a});var d=c.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);d&&(c.html=d[1]);var e=new Element("div").set("html",c.html);c.tree=e.childNodes,c.elements=e.getElements("*"),b.filter&&(c.tree=c.elements.filter(b.filter)),b.update?document.id(b.update).empty().set("html",c.html):b.append&&document.id(b.append).adopt(e.getChildren()),b.evalScripts&&Browser.exec(c.javascript),this.onSuccess(c.tree,c.elements,c.html,c.javascript)}}),Element.Properties.load={set:function(a){var b=this.get("load").cancel();return b.setOptions(a),this},get:function(){var a=this.retrieve("load");return a||(a=new Request.HTML({data:this,link:"cancel",update:this,method:"get"}),this.store("load",a)),a}},Element.implement({load:function(){return this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString})),this}}),"undefined"==typeof JSON&&(this.JSON={}),JSON=new Hash({stringify:JSON.stringify,parse:JSON.parse}),function(){var special={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},escape=function(a){return special[a]||"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(a){return a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(a)},JSON.encode=JSON.stringify?function(a){return JSON.stringify(a)}:function(a){switch(a&&a.toJSON&&(a=a.toJSON()),typeOf(a)){case"string":return'"'+a.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+a.map(JSON.encode).clean()+"]";case"object":case"hash":var b=[];return Object.each(a,function(a,c){var d=JSON.encode(a);d&&b.push(JSON.encode(c)+":"+d)}),"{"+b+"}";case"number":case"boolean":return""+a;case"null":return"null"}return null},JSON.decode=function(string,secure){if(!string||"string"!=typeOf(string))return null;if(secure||JSON.secure){if(JSON.parse)return JSON.parse(string);if(!JSON.validate(string))throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}return eval("("+string+")")}}(),Request.JSON=new Class({Extends:Request,options:{secure:!0},initialize:function(a){this.parent(a),Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(a){var b;try{b=this.response.json=JSON.decode(a,this.options.secure)}catch(c){return void this.fireEvent("error",[a,c])}null==b?this.onFailure():this.onSuccess(b,a)}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:!1,duration:!1,secure:!1,document:document,encode:!0},initialize:function(a,b){this.key=a,this.setOptions(b)},write:function(a){if(this.options.encode&&(a=encodeURIComponent(a)),this.options.domain&&(a+="; domain="+this.options.domain),this.options.path&&(a+="; path="+this.options.path),this.options.duration){var b=new Date;b.setTime(b.getTime()+24*this.options.duration*60*60*1e3),a+="; expires="+b.toGMTString()}return this.options.secure&&(a+="; secure"),this.options.document.cookie=this.key+"="+a,this},read:function(){var a=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return a?decodeURIComponent(a[1]):null},dispose:function(){return new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write(""),this}});Cookie.write=function(a,b,c){return new Cookie(a,c).write(b)},Cookie.read=function(a){return new Cookie(a).read()},Cookie.dispose=function(a,b){return new Cookie(a,b).dispose()},function(a,b){var c,d,e,f,g=[],h=b.createElement("div"),i=function(){clearTimeout(f),c||(Browser.loaded=c=!0,b.removeListener("DOMContentLoaded",i).removeListener("readystatechange",j),b.fireEvent("domready"),a.fireEvent("domready"))},j=function(){for(var a=g.length;a--;)if(g[a]())return i(),!0;return!1},k=function(){clearTimeout(f),j()||(f=setTimeout(k,10))};b.addListener("DOMContentLoaded",i);var l=function(){try{return h.doScroll(),!0}catch(a){}return!1};h.doScroll&&!l()&&(g.push(l),e=!0),b.readyState&&g.push(function(){var a=b.readyState;return"loaded"==a||"complete"==a}),"onreadystatechange"in b?b.addListener("readystatechange",j):e=!0,e&&k(),Element.Events.domready={onAdd:function(a){c&&a.call(this)}},Element.Events.load={base:"load",onAdd:function(b){d&&this==a&&b.call(this)},condition:function(){return this==a&&(i(),delete Element.Events.load),!0}},a.addEvent("load",function(){d=!0})}(window,document),function(){var Swiff=this.Swiff=new Class({Implements:Options,options:{id:null,height:1,width:1,container:null,properties:{},params:{quality:"high",allowScriptAccess:"always",wMode:"window",swLiveConnect:!0},callBacks:{},vars:{}},toElement:function(){return this.object},initialize:function(a,b){this.instance="Swiff_"+String.uniqueID(),this.setOptions(b),b=this.options;var c=this.id=b.id||this.instance,d=document.id(b.container);Swiff.CallBacks[this.instance]={};var e=b.params,f=b.vars,g=b.callBacks,h=Object.append({height:b.height,width:b.width},b.properties),i=this;for(var j in g)Swiff.CallBacks[this.instance][j]=function(a){return function(){return a.apply(i.object,arguments)}}(g[j]),f[j]="Swiff.CallBacks."+this.instance+"."+j;e.flashVars=Object.toQueryString(f),Browser.ie?(h.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",e.movie=a):h.type="application/x-shockwave-flash",h.data=a;var k='<object id="'+c+'"';for(var l in h)k+=" "+l+'="'+h[l]+'"';k+=">";for(var m in e)e[m]&&(k+='<param name="'+m+'" value="'+e[m]+'" />');k+="</object>",this.object=(d?d.empty():new Element("div")).set("html",k).firstChild},replaces:function(a){return a=document.id(a,!0),a.parentNode.replaceChild(this.toElement(),a),this},inject:function(a){return document.id(a,!0).appendChild(this.toElement()),this},remote:function(){return Swiff.remote.apply(Swiff,[this.toElement()].append(arguments))}});Swiff.CallBacks={},Swiff.remote=function(obj,fn){var rs=obj.CallFunction('<invoke name="'+fn+'" returntype="javascript">'+__flash__argumentsToXML(arguments,2)+"</invoke>");return eval(rs)}}(),MooTools.More={version:"1.3.2.1",build:"e586bcd2496e9b22acfde32e12f84d49ce09e59d"},Class.Mutators.Binds=function(a){return this.prototype.initialize||this.implement("initialize",function(){}),Array.from(a).concat(this.prototype.Binds||[])},Class.Mutators.initialize=function(a){return function(){return Array.from(this.Binds).each(function(a){var b=this[a];b&&(this[a]=b.bind(this))},this),a.apply(this,arguments)}},function(){var a=function(a,b){var c=[];return Object.each(b,function(b){Object.each(b,function(b){a.each(function(a){c.push(a+"-"+b+("border"==a?"-width":""))})})}),c},b=function(a,b){var c=0;return Object.each(b,function(b,d){d.test(a)&&(c+=b.toInt())}),c},c=function(a){return!(a&&!a.offsetHeight&&!a.offsetWidth)};Element.implement({measure:function(a){if(c(this))return a.call(this);for(var b=this.getParent(),d=[];!c(b)&&b!=document.body;)d.push(b.expose()),b=b.getParent();var e=this.expose(),f=a.call(this);return e(),d.each(function(a){a()}),f},expose:function(){if("none"!=this.getStyle("display"))return function(){};var a=this.style.cssText;return this.setStyles({display:"block",position:"absolute",visibility:"hidden"}),function(){this.style.cssText=a}.bind(this)},getDimensions:function(a){a=Object.merge({computeSize:!1},a);var b={x:0,y:0},c=function(a,b){return b.computeSize?a.getComputedSize(b):a.getSize()},d=this.getParent("body");if(d&&"none"==this.getStyle("display"))b=this.measure(function(){return c(this,a)});else if(d)try{b=c(this,a)}catch(e){}return Object.append(b,b.x||0===b.x?{width:b.x,height:b.y}:{x:b.width,y:b.height})},getComputedSize:function(c){c&&c.plains&&(c.planes=c.plains),c=Object.merge({styles:["padding","border"],planes:{height:["top","bottom"],width:["left","right"]},mode:"both"},c);var d,e={},f={width:0,height:0};return"vertical"==c.mode?(delete f.width,delete c.planes.width):"horizontal"==c.mode&&(delete f.height,delete c.planes.height),a(c.styles,c.planes).each(function(a){e[a]=this.getStyle(a).toInt()},this),Object.each(c.planes,function(a,c){var g=c.capitalize(),h=this.getStyle(c);"auto"!=h||d||(d=this.getDimensions()),h=e[c]="auto"==h?d[c]:h.toInt(),f["total"+g]=h,a.each(function(a){var c=b(a,e);f["computed"+a.capitalize()]=c,f["total"+g]+=c})},this),Object.append(f,e)}})}(),Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(a,b){this.elements=this.subject=$$(a),this.parent(b)},compute:function(a,b,c){var d={};for(var e in a){var f=a[e],g=b[e],h=d[e]={};for(var i in f)h[i]=this.parent(f[i],g[i],c)}return d},set:function(a){for(var b in a)if(this.elements[b]){var c=a[b];for(var d in c)this.render(this.elements[b],d,c[d],this.options.unit)}return this},start:function(a){if(!this.check(a))return this;var b={},c={};for(var d in a)if(this.elements[d]){var e=a[d],f=b[d]={},g=c[d]={};for(var h in e){var i=this.prepare(this.elements[d],h,e[h]);f[h]=i.from,g[h]=i.to}}return this.parent(b,c)}}),Fx.Accordion=new Class({Extends:Fx.Elements,options:{fixedHeight:!1,fixedWidth:!1,display:0,show:!1,height:!0,width:!1,opacity:!0,alwaysHide:!1,trigger:"click",initialDisplayFx:!0,resetHeight:!0},initialize:function(){var a=function(a){return null!=a},b=Array.link(arguments,{container:Type.isElement,options:Type.isObject,togglers:a,elements:a});this.parent(b.elements,b.options);var c=this.options,d=this.togglers=$$(b.togglers);this.previous=-1,this.internalChain=new Chain,c.alwaysHide&&(this.options.link="chain"),(c.show||0===this.options.show)&&(c.display=!1,this.previous=c.show),c.start&&(c.display=!1,c.show=!1);var e=this.effects={};c.opacity&&(e.opacity="fullOpacity"),c.width&&(e.width=c.fixedWidth?"fullWidth":"offsetWidth"),c.height&&(e.height=c.fixedHeight?"fullHeight":"scrollHeight");for(var f=0,g=d.length;g>f;f++)this.addSection(d[f],this.elements[f]);this.elements.each(function(a,b){if(c.show===b)this.fireEvent("active",[d[b],a]);else for(var f in e)a.setStyle(f,0)},this),(c.display||0===c.display||c.initialDisplayFx===!1)&&this.display(c.display,c.initialDisplayFx),c.fixedHeight!==!1&&(c.resetHeight=!1),this.addEvent("complete",this.internalChain.callChain.bind(this.internalChain))},addSection:function(a,b){a=document.id(a),b=document.id(b),this.togglers.include(a),this.elements.include(b);var c=this.togglers,d=this.options,e=c.contains(a),f=c.indexOf(a),g=this.display.pass(f,this);if(a.store("accordion:display",g).addEvent(d.trigger,g),d.height&&b.setStyles({"padding-top":0,"border-top":"none","padding-bottom":0,"border-bottom":"none"}),d.width&&b.setStyles({"padding-left":0,"border-left":"none","padding-right":0,"border-right":"none"}),b.fullOpacity=1,d.fixedWidth&&(b.fullWidth=d.fixedWidth),d.fixedHeight&&(b.fullHeight=d.fixedHeight),b.setStyle("overflow","hidden"),!e)for(var h in this.effects)b.setStyle(h,0);return this},removeSection:function(a,b){var c=this.togglers,d=c.indexOf(a),e=this.elements[d],f=function(){c.erase(a),this.elements.erase(e),this.detach(a)}.bind(this);return this.now==d||null!=b?this.display(null!=b?b:d-1>=0?d-1:0).chain(f):f(),this},detach:function(a){var b=function(a){a.removeEvent(this.options.trigger,a.retrieve("accordion:display"))}.bind(this);return a?b(a):this.togglers.each(b),this},display:function(a,b){if(!this.check(a,b))return this;var c={},d=this.elements,e=this.options,f=this.effects;if(null==b&&(b=!0),"element"==typeOf(a)&&(a=d.indexOf(a)),a==this.previous&&!e.alwaysHide)return this;if(e.resetHeight){var g=d[this.previous];if(g&&!this.selfHidden)for(var h in f)g.setStyle(h,g[f[h]])}return this.timer&&"chain"==e.link||a===this.previous&&!e.alwaysHide?this:(this.previous=a,this.selfHidden=!1,d.each(function(d,g){c[g]={};var h;g!=a?h=!0:e.alwaysHide&&(d.offsetHeight>0&&e.height||d.offsetWidth>0&&e.width)&&(h=!0,this.selfHidden=!0),this.fireEvent(h?"background":"active",[this.togglers[g],d]);for(var i in f)c[g][i]=h?0:d[f[i]];b||h||!e.resetHeight||(c[g].height="auto")},this),this.internalChain.clearChain(),this.internalChain.chain(function(){if(e.resetHeight&&!this.selfHidden){var b=d[a];b&&b.setStyle("height","auto")}}.bind(this)),b?this.start(c):this.set(c).internalChain.callChain())}});var Accordion=new Class({Extends:Fx.Accordion,initialize:function(){this.parent.apply(this,arguments);var a=Array.link(arguments,{container:Type.isElement});this.container=a.container},addSection:function(a,b,c){a=document.id(a),b=document.id(b);var d=this.togglers.contains(a),e=this.togglers.length;return!e||d&&!c?this.container&&!d&&(a.inject(this.container),b.inject(this.container)):(c=null!=c?c:e-1,a.inject(this.togglers[c],"before"),b.inject(a,"after")),this.parent.apply(this,arguments)}});!function(){function a(a){return/^(?:body|html)$/i.test(a.tagName)}Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:!0},initialize:function(a,b){if(this.element=this.subject=document.id(a),this.parent(b),"element"!=typeOf(this.element)&&(this.element=document.id(this.element.getDocument().body)),this.options.wheelStops){var c=this.element,d=this.cancel.pass(!1,this);this.addEvent("start",function(){c.addEvent("mousewheel",d)},!0),this.addEvent("complete",function(){c.removeEvent("mousewheel",d)},!0)}},set:function(){var a=Array.flatten(arguments);return Browser.firefox&&(a=[Math.round(a[0]),Math.round(a[1])]),this.element.scrollTo(a[0],a[1]),this},compute:function(a,b,c){return[0,1].map(function(d){return Fx.compute(a[d],b[d],c)})},start:function(a,b){if(!this.check(a,b))return this;var c=this.element.getScroll();return this.parent([c.x,c.y],[a,b])},calculateScroll:function(a,b){var c=this.element,d=c.getScrollSize(),e=c.getScroll(),f=c.getSize(),g=this.options.offset,h={x:a,y:b};for(var i in h)h[i]||0===h[i]||(h[i]=e[i]),"number"!=typeOf(h[i])&&(h[i]=d[i]-f[i]),h[i]+=g[i];return[h.x,h.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(!1,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,!1))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",!1))},toBottom:function(){return this.start.apply(this,this.calculateScroll(!1,"bottom"))},toElement:function(b,c){c=c?Array.from(c):["x","y"];var d=a(this.element)?{x:0,y:0}:this.element.getScroll(),e=Object.map(document.id(b).getPosition(this.element),function(a,b){return c.contains(b)?a+d[b]:!1});return this.start.apply(this,this.calculateScroll(e.x,e.y))},toElementEdge:function(a,b,c){b=b?Array.from(b):["x","y"],a=document.id(a);var d={},e=a.getPosition(this.element),f=a.getSize(),g=this.element.getScroll(),h=this.element.getSize(),i={x:e.x+f.x,y:e.y+f.y};return["x","y"].each(function(a){b.contains(a)&&(i[a]>g[a]+h[a]&&(d[a]=i[a]-h[a]),e[a]<g[a]&&(d[a]=e[a])),null==d[a]&&(d[a]=g[a]),c&&c[a]&&(d[a]=d[a]+c[a])},this),(d.x!=g.x||d.y!=g.y)&&this.start(d.x,d.y),this},toElementCenter:function(a,b,c){b=b?Array.from(b):["x","y"],a=document.id(a);var d={},e=a.getPosition(this.element),f=a.getSize(),g=this.element.getScroll(),h=this.element.getSize();return["x","y"].each(function(a){b.contains(a)&&(d[a]=e[a]-(h[a]-f[a])/2),null==d[a]&&(d[a]=g[a]),c&&c[a]&&(d[a]=d[a]+c[a])},this),(d.x!=g.x||d.y!=g.y)&&this.start(d.x,d.y),this}}),Fx.Scroll.implement({scrollToCenter:function(){return this.toElementCenter.apply(this,arguments)},scrollIntoView:function(){return this.toElementEdge.apply(this,arguments)}})}(),Fx.Slide=new Class({Extends:Fx,options:{mode:"vertical",wrapper:!1,hideOverflow:!0,resetHeight:!1},initialize:function(a,b){a=this.element=this.subject=document.id(a),this.parent(b),b=this.options;var c=a.retrieve("wrapper"),d=a.getStyles("margin","position","overflow");b.hideOverflow&&(d=Object.append(d,{overflow:"hidden"})),b.wrapper&&(c=document.id(b.wrapper).setStyles(d)),c||(c=new Element("div",{styles:d}).wraps(a)),a.store("wrapper",c).setStyle("margin",0),"visible"==a.getStyle("overflow")&&a.setStyle("overflow","hidden"),this.now=[],this.open=!0,this.wrapper=c,this.addEvent("complete",function(){this.open=0!=c["offset"+this.layout.capitalize()],this.open&&this.options.resetHeight&&c.setStyle("height","")},!0)},vertical:function(){this.margin="margin-top",this.layout="height",this.offset=this.element.offsetHeight},horizontal:function(){this.margin="margin-left",this.layout="width",this.offset=this.element.offsetWidth},set:function(a){return this.element.setStyle(this.margin,a[0]),this.wrapper.setStyle(this.layout,a[1]),this},compute:function(a,b,c){return[0,1].map(function(d){return Fx.compute(a[d],b[d],c)})},start:function(a,b){if(!this.check(a,b))return this;this[b||this.options.mode]();var c,d=this.element.getStyle(this.margin).toInt(),e=this.wrapper.getStyle(this.layout).toInt(),f=[[d,e],[0,this.offset]],g=[[d,e],[-this.offset,0]];switch(a){case"in":c=f;break;case"out":c=g;break;case"toggle":c=0==e?f:g}return this.parent(c[0],c[1])},slideIn:function(a){return this.start("in",a)},slideOut:function(a){return this.start("out",a)},hide:function(a){return this[a||this.options.mode](),this.open=!1,this.set([-this.offset,0])},show:function(a){return this[a||this.options.mode](),this.open=!0,this.set([0,this.offset])},toggle:function(a){return this.start("toggle",a)}}),Element.Properties.slide={set:function(a){return this.get("slide").cancel().setOptions(a),this},get:function(){var a=this.retrieve("slide");return a||(a=new Fx.Slide(this,{link:"cancel"}),this.store("slide",a)),a}},Element.implement({slide:function(a,b){a=a||"toggle";var c,d=this.get("slide");switch(a){case"hide":d.hide(b);break;case"show":d.show(b);break;case"toggle":var e=this.retrieve("slide:flag",d.open);d[e?"slideOut":"slideIn"](b),this.store("slide:flag",!e),c=!0;break;default:d.start(a,b)}return c||this.eliminate("slide:flag"),this}});var SmoothScroll=Fx.SmoothScroll=new Class({Extends:Fx.Scroll,options:{axes:["x","y"]},initialize:function(a,b){b=b||document,this.doc=b.getDocument(),this.parent(this.doc,a);var c=b.getWindow(),d=c.location.href.match(/^[^#]*/)[0]+"#",e=$$(this.options.links||this.doc.links);e.each(function(a){if(0==a.href.indexOf(d)){var b=a.href.substr(d.length);b&&this.useLink(a,b)}},this),this.addEvent("complete",function(){c.location.hash=this.anchor,this.element.scrollTo(this.to[0],this.to[1])},!0)},useLink:function(a,b){return a.addEvent("click",function(c){var d=document.id(b)||this.doc.getElement("a[name="+b+"]");d&&(c.preventDefault(),this.toElement(d,this.options.axes).chain(function(){this.fireEvent("scrolledTo",[a,d])}.bind(this)),this.anchor=b)}.bind(this)),this}}),Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:!1,style:!0,limit:!1,handle:!1,invert:!1,preventDefault:!1,stopPropagation:!1,modifiers:{x:"left",y:"top"}},initialize:function(){var a=Array.link(arguments,{
options:Type.isObject,element:function(a){return null!=a}});this.element=document.id(a.element),this.document=this.element.getDocument(),this.setOptions(a.options||{});var b=typeOf(this.options.handle);this.handles=("array"==b||"collection"==b?$$(this.options.handle):document.id(this.options.handle))||this.element,this.mouse={now:{},pos:{}},this.value={start:{},now:{}},this.selection=Browser.ie?"selectstart":"mousedown",Browser.ie&&!Drag.ondragstartFixed&&(document.ondragstart=Function.from(!1),Drag.ondragstartFixed=!0),this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:Function.from(!1)},this.attach()},attach:function(){return this.handles.addEvent("mousedown",this.bound.start),this},detach:function(){return this.handles.removeEvent("mousedown",this.bound.start),this},start:function(a){var b=this.options;if(!a.rightClick){b.preventDefault&&a.preventDefault(),b.stopPropagation&&a.stopPropagation(),this.mouse.start=a.page,this.fireEvent("beforeStart",this.element);var c=b.limit;this.limit={x:[],y:[]};var d,e;for(d in b.modifiers)if(b.modifiers[d]){var f=this.element.getStyle(b.modifiers[d]);if(f&&!f.match(/px$/)&&(e||(e=this.element.getCoordinates(this.element.getOffsetParent())),f=e[b.modifiers[d]]),b.style?this.value.now[d]=(f||0).toInt():this.value.now[d]=this.element[b.modifiers[d]],b.invert&&(this.value.now[d]*=-1),this.mouse.pos[d]=a.page[d]-this.value.now[d],c&&c[d])for(var g=2;g--;){var h=c[d][g];(h||0===h)&&(this.limit[d][g]="function"==typeof h?h():h)}}"number"==typeOf(this.options.grid)&&(this.options.grid={x:this.options.grid,y:this.options.grid});var i={mousemove:this.bound.check,mouseup:this.bound.cancel};i[this.selection]=this.bound.eventStop,this.document.addEvents(i)}},check:function(a){this.options.preventDefault&&a.preventDefault();var b=Math.round(Math.sqrt(Math.pow(a.page.x-this.mouse.start.x,2)+Math.pow(a.page.y-this.mouse.start.y,2)));b>this.options.snap&&(this.cancel(),this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop}),this.fireEvent("start",[this.element,a]).fireEvent("snap",this.element))},drag:function(a){var b=this.options;b.preventDefault&&a.preventDefault(),this.mouse.now=a.page;for(var c in b.modifiers)b.modifiers[c]&&(this.value.now[c]=this.mouse.now[c]-this.mouse.pos[c],b.invert&&(this.value.now[c]*=-1),b.limit&&this.limit[c]&&((this.limit[c][1]||0===this.limit[c][1])&&this.value.now[c]>this.limit[c][1]?this.value.now[c]=this.limit[c][1]:(this.limit[c][0]||0===this.limit[c][0])&&this.value.now[c]<this.limit[c][0]&&(this.value.now[c]=this.limit[c][0])),b.grid[c]&&(this.value.now[c]-=(this.value.now[c]-(this.limit[c][0]||0))%b.grid[c]),b.style?this.element.setStyle(b.modifiers[c],this.value.now[c]+b.unit):this.element[b.modifiers[c]]=this.value.now[c]);this.fireEvent("drag",[this.element,a])},cancel:function(a){this.document.removeEvents({mousemove:this.bound.check,mouseup:this.bound.cancel}),a&&(this.document.removeEvent(this.selection,this.bound.eventStop),this.fireEvent("cancel",this.element))},stop:function(a){var b={mousemove:this.bound.drag,mouseup:this.bound.stop};b[this.selection]=this.bound.eventStop,this.document.removeEvents(b),a&&this.fireEvent("complete",[this.element,a])}});Element.implement({makeResizable:function(a){var b=new Drag(this,Object.merge({modifiers:{x:"width",y:"height"}},a));return this.store("resizer",b),b.addEvent("drag",function(){this.fireEvent("resize",b)}.bind(this))}}),Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:!1,precalculate:!1,includeMargins:!0,checkDroppables:!0},initialize:function(a,b){if(this.parent(a,b),a=this.element,this.droppables=$$(this.options.droppables),this.container=document.id(this.options.container),this.container&&"element"!=typeOf(this.container)&&(this.container=document.id(this.container.getDocument().body)),this.options.style){if("left"==this.options.modifiers.x&&"top"==this.options.modifiers.y){var c=a.getOffsetParent(),d=a.getStyles("left","top");!c||"auto"!=d.left&&"auto"!=d.top||a.setPosition(a.getPosition(c))}"static"==a.getStyle("position")&&a.setStyle("position","absolute")}this.addEvent("start",this.checkDroppables,!0),this.overed=null},start:function(a){this.container&&(this.options.limit=this.calculateLimit()),this.options.precalculate&&(this.positions=this.droppables.map(function(a){return a.getCoordinates()})),this.parent(a)},calculateLimit:function(){var a=this.element,b=this.container,c=document.id(a.getOffsetParent())||document.body,d=b.getCoordinates(c),e={},f={},g={},h={},i={};["top","right","bottom","left"].each(function(d){e[d]=a.getStyle("margin-"+d).toInt(),f[d]=a.getStyle("border-"+d).toInt(),g[d]=b.getStyle("margin-"+d).toInt(),h[d]=b.getStyle("border-"+d).toInt(),i[d]=c.getStyle("padding-"+d).toInt()},this);var j=a.offsetWidth+e.left+e.right,k=a.offsetHeight+e.top+e.bottom,l=0,m=0,n=d.right-h.right-j,o=d.bottom-h.bottom-k;if(this.options.includeMargins?(l+=e.left,m+=e.top):(n+=e.right,o+=e.bottom),"relative"==a.getStyle("position")){var p=a.getCoordinates(c);p.left-=a.getStyle("left").toInt(),p.top-=a.getStyle("top").toInt(),l-=p.left,m-=p.top,"relative"!=b.getStyle("position")&&(l+=h.left,m+=h.top),n+=e.left-p.left,o+=e.top-p.top,b!=c&&(l+=g.left+i.left,m+=(Browser.ie6||Browser.ie7?0:g.top)+i.top)}else l-=e.left,m-=e.top,b!=c&&(l+=d.left+h.left,m+=d.top+h.top);return{x:[l,n],y:[m,o]}},getDroppableCoordinates:function(a){var b=a.getCoordinates();if("fixed"==a.getStyle("position")){var c=window.getScroll();b.left+=c.x,b.right+=c.x,b.top+=c.y,b.bottom+=c.y}return b},checkDroppables:function(){var a=this.droppables.filter(function(a,b){a=this.positions?this.positions[b]:this.getDroppableCoordinates(a);var c=this.mouse.now;return c.x>a.left&&c.x<a.right&&c.y<a.bottom&&c.y>a.top},this).getLast();this.overed!=a&&(this.overed&&this.fireEvent("leave",[this.element,this.overed]),a&&this.fireEvent("enter",[this.element,a]),this.overed=a)},drag:function(a){this.parent(a),this.options.checkDroppables&&this.droppables.length&&this.checkDroppables()},stop:function(a){return this.checkDroppables(),this.fireEvent("drop",[this.element,this.overed,a]),this.overed=null,this.parent(a)}}),Element.implement({makeDraggable:function(a){var b=new Drag.Move(this,a);return this.store("dragger",b),b}});var Slider=new Class({Implements:[Events,Options],Binds:["clickedElement","draggedKnob","scrolledElement"],options:{onTick:function(a){this.setKnobPosition(a)},initialStep:0,snap:!1,offset:0,range:!1,wheel:!1,steps:100,mode:"horizontal"},initialize:function(a,b,c){this.setOptions(c),c=this.options,this.element=document.id(a),b=this.knob=document.id(b),this.previousChange=this.previousEnd=this.step=-1;var d={},e={x:!1,y:!1};switch(c.mode){case"vertical":this.axis="y",this.property="top",this.offset="offsetHeight";break;case"horizontal":this.axis="x",this.property="left",this.offset="offsetWidth"}this.setSliderDimensions(),this.setRange(c.range),"static"==b.getStyle("position")&&b.setStyle("position","relative"),b.setStyle(this.property,-c.offset),e[this.axis]=this.property,d[this.axis]=[-c.offset,this.full-c.offset];var f={snap:0,limit:d,modifiers:e,onDrag:this.draggedKnob,onStart:this.draggedKnob,onBeforeStart:function(){this.isDragging=!0}.bind(this),onCancel:function(){this.isDragging=!1}.bind(this),onComplete:function(){this.isDragging=!1,this.draggedKnob(),this.end()}.bind(this)};c.snap&&this.setSnap(f),this.drag=new Drag(b,f),this.attach(),null!=c.initialStep&&this.set(c.initialStep)},attach:function(){return this.element.addEvent("mousedown",this.clickedElement),this.options.wheel&&this.element.addEvent("mousewheel",this.scrolledElement),this.drag.attach(),this},detach:function(){return this.element.removeEvent("mousedown",this.clickedElement).removeEvent("mousewheel",this.scrolledElement),this.drag.detach(),this},autosize:function(){return this.setSliderDimensions().setKnobPosition(this.toPosition(this.step)),this.drag.options.limit[this.axis]=[-this.options.offset,this.full-this.options.offset],this.options.snap&&this.setSnap(),this},setSnap:function(a){return a||(a=this.drag.options),a.grid=Math.ceil(this.stepWidth),a.limit[this.axis][1]=this.full,this},setKnobPosition:function(a){return this.options.snap&&(a=this.toPosition(this.step)),this.knob.setStyle(this.property,a),this},setSliderDimensions:function(){return this.full=this.element.measure(function(){return this.half=this.knob[this.offset]/2,this.element[this.offset]-this.knob[this.offset]+2*this.options.offset}.bind(this)),this},set:function(a){return this.range>0^a<this.min||(a=this.min),this.range>0^a>this.max||(a=this.max),this.step=Math.round(a),this.checkStep().fireEvent("tick",this.toPosition(this.step)).end()},setRange:function(a,b){return this.min=Array.pick([a[0],0]),this.max=Array.pick([a[1],this.options.steps]),this.range=this.max-this.min,this.steps=this.options.steps||this.full,this.stepSize=Math.abs(this.range)/this.steps,this.stepWidth=this.stepSize*this.full/Math.abs(this.range),a&&this.set(Array.pick([b,this.step]).floor(this.min).max(this.max)),this},clickedElement:function(a){if(!this.isDragging&&a.target!=this.knob){var b=this.range<0?-1:1,c=a.page[this.axis]-this.element.getPosition()[this.axis]-this.half;c=c.limit(-this.options.offset,this.full-this.options.offset),this.step=Math.round(this.min+b*this.toStep(c)),this.checkStep().fireEvent("tick",c).end()}},scrolledElement:function(a){var b="horizontal"==this.options.mode?a.wheel<0:a.wheel>0;this.set(this.step+(b?-1:1)*this.stepSize),a.stop()},draggedKnob:function(){var a=this.range<0?-1:1,b=this.drag.value.now[this.axis];b=b.limit(-this.options.offset,this.full-this.options.offset),this.step=Math.round(this.min+a*this.toStep(b)),this.checkStep()},checkStep:function(){var a=this.step;return this.previousChange!=a&&(this.previousChange=a,this.fireEvent("change",a)),this},end:function(){var a=this.step;return this.previousEnd!==a&&(this.previousEnd=a,this.fireEvent("complete",a+"")),this},toStep:function(a){var b=(a+this.options.offset)*this.stepSize/this.full*this.steps;return this.options.steps?Math.round(b-=b%this.stepSize):b},toPosition:function(a){return this.full*Math.abs(this.min-a)/(this.steps*this.stepSize)-this.options.offset}}),Sortables=new Class({Implements:[Events,Options],options:{opacity:1,clone:!1,revert:!1,handle:!1,dragOptions:{},snap:4,constrain:!1,preventDefault:!1},initialize:function(a,b){this.setOptions(b),this.elements=[],this.lists=[],this.idle=!0,this.addLists($$(document.id(a)||a)),this.options.clone||(this.options.revert=!1),this.options.revert&&(this.effect=new Fx.Morph(null,Object.merge({duration:250,link:"cancel"},this.options.revert)))},attach:function(){return this.addLists(this.lists),this},detach:function(){return this.lists=this.removeLists(this.lists),this},addItems:function(){return Array.flatten(arguments).each(function(a){this.elements.push(a);var b=a.retrieve("sortables:start",function(b){this.start.call(this,b,a)}.bind(this));(this.options.handle?a.getElement(this.options.handle)||a:a).addEvent("mousedown",b)},this),this},addLists:function(){return Array.flatten(arguments).each(function(a){this.lists.include(a),this.addItems(a.getChildren())},this),this},removeItems:function(){return $$(Array.flatten(arguments).map(function(a){this.elements.erase(a);var b=a.retrieve("sortables:start");return(this.options.handle?a.getElement(this.options.handle)||a:a).removeEvent("mousedown",b),a},this))},removeLists:function(){return $$(Array.flatten(arguments).map(function(a){return this.lists.erase(a),this.removeItems(a.getChildren()),a},this))},getClone:function(a,b){if(!this.options.clone)return new Element(b.tagName).inject(document.body);if("function"==typeOf(this.options.clone))return this.options.clone.call(this,a,b,this.list);var c=b.clone(!0).setStyles({margin:0,position:"absolute",visibility:"hidden",width:b.getStyle("width")}).addEvent("mousedown",function(a){b.fireEvent("mousedown",a)});return c.get("html").test("radio")&&c.getElements("input[type=radio]").each(function(a,c){a.set("name","clone_"+c),a.get("checked")&&b.getElements("input[type=radio]")[c].set("checked",!0)}),c.inject(this.list).setPosition(b.getPosition(b.getOffsetParent()))},getDroppables:function(){var a=this.list.getChildren().erase(this.clone).erase(this.element);return this.options.constrain||a.append(this.lists).erase(this.list),a},insert:function(a,b){var c="inside";this.lists.contains(b)?(this.list=b,this.drag.droppables=this.getDroppables()):c=this.element.getAllPrevious().contains(b)?"before":"after",this.element.inject(b,c),this.fireEvent("sort",[this.element,this.clone])},start:function(a,b){!this.idle||a.rightClick||["button","input","a"].contains(a.target.get("tag"))||(this.idle=!1,this.element=b,this.opacity=b.get("opacity"),this.list=b.getParent(),this.clone=this.getClone(a,b),this.drag=new Drag.Move(this.clone,Object.merge({preventDefault:this.options.preventDefault,snap:this.options.snap,container:this.options.constrain&&this.element.getParent(),droppables:this.getDroppables()},this.options.dragOptions)).addEvents({onSnap:function(){a.stop(),this.clone.setStyle("visibility","visible"),this.element.set("opacity",this.options.opacity||0),this.fireEvent("start",[this.element,this.clone])}.bind(this),onEnter:this.insert.bind(this),onCancel:this.end.bind(this),onComplete:this.end.bind(this)}),this.clone.inject(this.element,"before"),this.drag.start(a))},end:function(){if(this.drag.detach(),this.element.set("opacity",this.opacity),this.effect){var a=this.element.getStyles("width","height"),b=this.clone,c=b.computePosition(this.element.getPosition(this.clone.getOffsetParent())),d=function(){this.removeEvent("cancel",d),b.destroy()};this.effect.element=b,this.effect.start({top:c.top,left:c.left,width:a.width,height:a.height,opacity:.25}).addEvent("cancel",d).chain(d)}else this.clone.destroy();this.reset()},reset:function(){this.idle=!0,this.fireEvent("complete",this.element)},serialize:function(){var a=Array.link(arguments,{modifier:Type.isFunction,index:function(a){return null!=a}}),b=this.lists.map(function(b){return b.getChildren().map(a.modifier||function(a){return a.get("id")},this)},this),c=a.index;return 1==this.lists.length&&(c=0),(c||0===c)&&c>=0&&c<this.lists.length?b[c]:b}}),Asset={javascript:function(a,b){b||(b={});var c=new Element("script",{src:a,type:"text/javascript"}),d=b.document||document,e=0,f=b.onload||b.onLoad,g=f?function(){1==++e&&f.call(this)}:function(){};return delete b.onload,delete b.onLoad,delete b.document,c.addEvents({load:g,readystatechange:function(){["loaded","complete"].contains(this.readyState)&&g.call(this)}}).set(b).inject(d.head)},css:function(a,b){b||(b={});var c=new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:a}),d=b.onload||b.onLoad,e=b.document||document;return delete b.onload,delete b.onLoad,delete b.document,d&&c.addEvent("load",d),c.set(b).inject(e.head)},image:function(a,b){b||(b={});var c=new Image,d=document.id(c)||new Element("img");return["load","abort","error"].each(function(a){var e="on"+a,f="on"+a.capitalize(),g=b[e]||b[f]||function(){};delete b[f],delete b[e],c[e]=function(){c&&(d.parentNode||(d.width=c.width,d.height=c.height),c=c.onload=c.onabort=c.onerror=null,g.delay(1,d,d),d.fireEvent(a,d,1))}}),c.src=d.src=a,c&&c.complete&&c.onload.delay(1),d.set(b)},images:function(a,b){a=Array.from(a);var c=function(){},d=0;return b=Object.merge({onComplete:c,onProgress:c,onError:c,properties:{}},b),new Elements(a.map(function(c,e){return Asset.image(c,Object.append(b.properties,{onload:function(){d++,b.onProgress.call(this,d,e,c),d==a.length&&b.onComplete()},onerror:function(){d++,b.onError.call(this,d,e,c),d==a.length&&b.onComplete()}}))}))}};!function(){var a=this.Color=new Type("Color",function(a,b){switch(arguments.length>=3?(b="rgb",a=Array.slice(arguments,0,3)):"string"==typeof a&&(a=a.match(/rgb/)?a.rgbToHex().hexToRgb(!0):a.match(/hsb/)?a.hsbToRgb():a.hexToRgb(!0)),b=b||"rgb"){case"hsb":var c=a;a=a.hsbToRgb(),a.hsb=c;break;case"hex":a=a.hexToRgb(!0)}return a.rgb=a.slice(0,3),a.hsb=a.hsb||a.rgbToHsb(),a.hex=a.rgbToHex(),Object.append(a,this)});a.implement({mix:function(){var b=Array.slice(arguments),c="number"==typeOf(b.getLast())?b.pop():50,d=this.slice();return b.each(function(b){b=new a(b);for(var e=0;3>e;e++)d[e]=Math.round(d[e]/100*(100-c)+b[e]/100*c)}),new a(d,"rgb")},invert:function(){return new a(this.map(function(a){return 255-a}))},setHue:function(b){return new a([b,this.hsb[1],this.hsb[2]],"hsb")},setSaturation:function(b){return new a([this.hsb[0],b,this.hsb[2]],"hsb")},setBrightness:function(b){return new a([this.hsb[0],this.hsb[1],b],"hsb")}}),this.$RGB=function(b,c,d){return new a([b,c,d],"rgb")},this.$HSB=function(b,c,d){return new a([b,c,d],"hsb")},this.$HEX=function(b){return new a(b,"hex")},Array.implement({rgbToHsb:function(){var a=this[0],b=this[1],c=this[2],d=0,e=Math.max(a,b,c),f=Math.min(a,b,c),g=e-f,h=e/255,i=0!=e?g/e:0;if(0!=i){var j=(e-a)/g,k=(e-b)/g,l=(e-c)/g;d=a==e?l-k:b==e?2+j-l:4+k-j,d/=6,0>d&&d++}return[Math.round(360*d),Math.round(100*i),Math.round(100*h)]},hsbToRgb:function(){var a=Math.round(this[2]/100*255);if(0==this[1])return[a,a,a];var b=this[0]%360,c=b%60,d=Math.round(this[2]*(100-this[1])/1e4*255),e=Math.round(this[2]*(6e3-this[1]*c)/6e5*255),f=Math.round(this[2]*(6e3-this[1]*(60-c))/6e5*255);switch(Math.floor(b/60)){case 0:return[a,f,d];case 1:return[e,a,d];case 2:return[d,a,f];case 3:return[d,e,a];case 4:return[f,d,a];case 5:return[a,d,e]}return!1}}),String.implement({rgbToHsb:function(){var a=this.match(/\d{1,3}/g);return a?a.rgbToHsb():null},hsbToRgb:function(){var a=this.match(/\d{1,3}/g);return a?a.hsbToRgb():null}})}(),function(){this.Group=new Class({initialize:function(){this.instances=Array.flatten(arguments),this.events={},this.checker={}},addEvent:function(a,b){return this.checker[a]=this.checker[a]||{},this.events[a]=this.events[a]||[],this.events[a].contains(b)?!1:(this.events[a].push(b),this.instances.each(function(b,c){b.addEvent(a,this.check.pass([a,b,c],this))},this),this)},check:function(a,b,c){this.checker[a][c]=!0;var d=this.instances.every(function(b,c){return this.checker[a][c]||!1},this);d&&(this.checker[a]={},this.events[a].each(function(a){a.call(this,this.instances,b)},this))}})}(),function(){if(!this.Hash){var a=this.Hash=new Type("Hash",function(a){"hash"==typeOf(a)&&(a=Object.clone(a.getClean()));for(var b in a)this[b]=a[b];return this});this.$H=function(b){return new a(b)},a.implement({forEach:function(a,b){Object.forEach(this,a,b)},getClean:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a},getLength:function(){var a=0;for(var b in this)this.hasOwnProperty(b)&&a++;return a}}),a.alias("each","forEach"),a.implement({has:Object.prototype.hasOwnProperty,keyOf:function(a){return Object.keyOf(this,a)},hasValue:function(a){return Object.contains(this,a)},extend:function(b){return a.each(b||{},function(b,c){a.set(this,c,b)},this),this},combine:function(b){return a.each(b||{},function(b,c){a.include(this,c,b)},this),this},erase:function(a){return this.hasOwnProperty(a)&&delete this[a],this},get:function(a){return this.hasOwnProperty(a)?this[a]:null},set:function(a,b){return(!this[a]||this.hasOwnProperty(a))&&(this[a]=b),this},empty:function(){return a.each(this,function(a,b){delete this[b]},this),this},include:function(a,b){return void 0==this[a]&&(this[a]=b),this},map:function(b,c){return new a(Object.map(this,b,c))},filter:function(b,c){return new a(Object.filter(this,b,c))},every:function(a,b){return Object.every(this,a,b)},some:function(a,b){return Object.some(this,a,b)},getKeys:function(){return Object.keys(this)},getValues:function(){return Object.values(this)},toQueryString:function(a){return Object.toQueryString(this,a)}}),a.alias({indexOf:"keyOf",contains:"hasValue"})}}(),Hash.Cookie=new Class({Extends:Cookie,options:{autoSave:!0},initialize:function(a,b){this.parent(a,b),this.load()},save:function(){var a=JSON.encode(this.hash);return!a||a.length>4096?!1:("{}"==a?this.dispose():this.write(a),!0)},load:function(){return this.hash=new Hash(JSON.decode(this.read(),!0)),this}}),Hash.each(Hash.prototype,function(a,b){"function"==typeof a&&Hash.Cookie.implement(b,function(){var b=a.apply(this.hash,arguments);return this.options.autoSave&&this.save(),b})});var Scroller=new Class({Implements:[Events,Options],options:{area:20,velocity:1,onChange:function(a,b){this.element.scrollTo(a,b)},fps:50},initialize:function(a,b){this.setOptions(b),this.element=document.id(a),this.docBody=document.id(this.element.getDocument().body),this.listener="element"!=typeOf(this.element)?this.docBody:this.element,this.timer=null,this.bound={attach:this.attach.bind(this),detach:this.detach.bind(this),getCoords:this.getCoords.bind(this)}},start:function(){return this.listener.addEvents({mouseover:this.bound.attach,mouseleave:this.bound.detach}),this},stop:function(){return this.listener.removeEvents({mouseover:this.bound.attach,mouseleave:this.bound.detach}),this.detach(),this.timer=clearInterval(this.timer),this},attach:function(){this.listener.addEvent("mousemove",this.bound.getCoords)},detach:function(){this.listener.removeEvent("mousemove",this.bound.getCoords),this.timer=clearInterval(this.timer)},getCoords:function(a){this.page="body"==this.listener.get("tag")?a.client:a.page,this.timer||(this.timer=this.scroll.periodical(Math.round(1e3/this.options.fps),this))},scroll:function(){var a=this.element.getSize(),b=this.element.getScroll(),c=this.element!=this.docBody?this.element.getOffsets():{x:0,y:0},d=this.element.getScrollSize(),e={x:0,y:0},f=this.options.area.top||this.options.area,g=this.options.area.bottom||this.options.area;for(var h in this.page)this.page[h]<f+c[h]&&0!=b[h]?e[h]=(this.page[h]-f-c[h])*this.options.velocity:this.page[h]+g>a[h]+c[h]&&b[h]+a[h]!=d[h]&&(e[h]=(this.page[h]-a[h]+g-c[h])*this.options.velocity),e[h]=e[h].round();(e.y||e.x)&&this.fireEvent("change",[b.x+e.x,b.y+e.y])}});!function(){var a=function(a,b){return a?"function"==typeOf(a)?a(b):b.get(a):""};this.Tips=new Class({Implements:[Events,Options],options:{onShow:function(){this.tip.setStyle("display","block")},onHide:function(){this.tip.setStyle("display","none")},title:"title",text:function(a){return a.get("rel")||a.get("href")},showDelay:100,hideDelay:100,className:"tip-wrap",offset:{x:16,y:16},windowPadding:{x:0,y:0},fixed:!1},initialize:function(){var a=Array.link(arguments,{options:Type.isObject,elements:function(a){return null!=a}});this.setOptions(a.options),a.elements&&this.attach(a.elements),this.container=new Element("div",{"class":"tip"})},toElement:function(){return this.tip?this.tip:(this.tip=new Element("div",{"class":this.options.className,styles:{position:"absolute",top:0,left:0}}).adopt(new Element("div",{"class":"tip-top"}),this.container,new Element("div",{"class":"tip-bottom"})),this.tip)},attach:function(b){return $$(b).each(function(b){var c=a(this.options.title,b),d=a(this.options.text,b);b.set("title","").store("tip:native",c).retrieve("tip:title",c),b.retrieve("tip:text",d),this.fireEvent("attach",[b]);var e=["enter","leave"];this.options.fixed||e.push("move"),e.each(function(a){var c=b.retrieve("tip:"+a);c||(c=function(c){this["element"+a.capitalize()].apply(this,[c,b])}.bind(this)),b.store("tip:"+a,c).addEvent("mouse"+a,c)},this)},this),this},detach:function(a){return $$(a).each(function(a){if(["enter","leave","move"].each(function(b){a.removeEvent("mouse"+b,a.retrieve("tip:"+b)).eliminate("tip:"+b)}),this.fireEvent("detach",[a]),"title"==this.options.title){var b=a.retrieve("tip:native");b&&a.set("title",b)}},this),this},elementEnter:function(a,b){clearTimeout(this.timer),this.timer=function(){this.container.empty(),["title","text"].each(function(a){var c=b.retrieve("tip:"+a),d=this["_"+a+"Element"]=new Element("div",{"class":"tip-"+a}).inject(this.container);c&&this.fill(d,c)},this),this.show(b),this.position(this.options.fixed?{page:b.getPosition()}:a)}.delay(this.options.showDelay,this)},elementLeave:function(a,b){clearTimeout(this.timer),this.timer=this.hide.delay(this.options.hideDelay,this,b),this.fireForParent(a,b)},setTitle:function(a){return this._titleElement&&(this._titleElement.empty(),this.fill(this._titleElement,a)),this},setText:function(a){return this._textElement&&(this._textElement.empty(),this.fill(this._textElement,a)),this},fireForParent:function(a,b){b=b.getParent(),b&&b!=document.body&&(b.retrieve("tip:enter")?b.fireEvent("mouseenter",a):this.fireForParent(a,b))},elementMove:function(a,b){this.position(a)},position:function(a){this.tip||document.id(this);var b=window.getSize(),c=window.getScroll(),d={x:this.tip.offsetWidth,y:this.tip.offsetHeight},e={x:"left",y:"top"},f={y:!1,x2:!1,y2:!1,x:!1},g={};for(var h in e)g[e[h]]=a.page[h]+this.options.offset[h],g[e[h]]<0&&(f[h]=!0),g[e[h]]+d[h]-c[h]>b[h]-this.options.windowPadding[h]&&(g[e[h]]=a.page[h]-this.options.offset[h]-d[h],f[h+"2"]=!0);this.fireEvent("bound",f),this.tip.setStyles(g)},fill:function(a,b){"string"==typeof b?a.set("html",b):a.adopt(b)},show:function(a){this.tip||document.id(this),this.tip.getParent()||this.tip.inject(document.body),this.fireEvent("show",[this.tip,a])},hide:function(a){this.tip||document.id(this),this.fireEvent("hide",[this.tip,a])}})}(),String.implement({parseQueryString:function(a,b){null==a&&(a=!0),null==b&&(b=!0);var c=this.split(/[&;]/),d={};return c.length?(c.each(function(c){var e=c.indexOf("=")+1,f=e?c.substr(e):"",g=e?c.substr(0,e-1).match(/([^\]\[]+|(\B)(?=\]))/g):[c],h=d;g&&(b&&(f=decodeURIComponent(f)),g.each(function(b,c){a&&(b=decodeURIComponent(b));var d=h[b];c<g.length-1?h=h[b]=d||{}:"array"==typeOf(d)?d.push(f):h[b]=null!=d?[d,f]:f}))}),d):d},cleanQueryString:function(a){return this.split("&").filter(function(b){var c=b.indexOf("="),d=0>c?"":b.substr(0,c),e=b.substr(c+1);return a?a.call(null,d,e):e||0===e}).join("&")}}),function(){var a=function(){return this.get("value")},b=this.URI=new Class({Implements:Options,options:{},regex:/^(?:(\w+):)?(?:\/\/(?:(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)?(\.\.?$|(?:[^?#\/]*\/)*)([^?#]*)(?:\?([^#]*))?(?:#(.*))?/,parts:["scheme","user","password","host","port","directory","file","query","fragment"],schemes:{http:80,https:443,ftp:21,rtsp:554,mms:1755,file:0},initialize:function(a,c){this.setOptions(c);var d=this.options.base||b.base;a||(a=d),a&&a.parsed?this.parsed=Object.clone(a.parsed):this.set("value",a.href||a.toString(),d?new b(d):!1)},parse:function(a,b){var c=a.match(this.regex);return c?(c.shift(),this.merge(c.associate(this.parts),b)):!1},merge:function(a,b){return a&&a.scheme||b&&b.scheme?(b&&this.parts.every(function(c){return a[c]?!1:(a[c]=b[c]||"",!0)}),a.port=a.port||this.schemes[a.scheme.toLowerCase()],a.directory=a.directory?this.parseDirectory(a.directory,b?b.directory:""):"/",a):!1},parseDirectory:function(a,c){if(a=("/"==a.substr(0,1)?"":c||"/")+a,!a.test(b.regs.directoryDot))return a;var d=[];return a.replace(b.regs.endSlash,"").split("/").each(function(a){".."==a&&d.length>0?d.pop():"."!=a&&d.push(a)}),d.join("/")+"/"},combine:function(a){return a.value||a.scheme+"://"+(a.user?a.user+(a.password?":"+a.password:"")+"@":"")+(a.host||"")+(a.port&&a.port!=this.schemes[a.scheme]?":"+a.port:"")+(a.directory||"/")+(a.file||"")+(a.query?"?"+a.query:"")+(a.fragment?"#"+a.fragment:"")},set:function(a,c,d){if("value"==a){var e=c.match(b.regs.scheme);e&&(e=e[1]),e&&null==this.schemes[e.toLowerCase()]?this.parsed={scheme:e,value:c}:this.parsed=this.parse(c,(d||this).parsed)||(e?{scheme:e,value:c}:{value:c})}else"data"==a?this.setData(c):this.parsed[a]=c;return this},get:function(a,b){switch(a){case"value":return this.combine(this.parsed,b?b.parsed:!1);case"data":return this.getData()}return this.parsed[a]||""},go:function(){document.location.href=this.toString()},toURI:function(){return this},getData:function(a,b){var c=this.get(b||"query");if(!c&&0!==c)return a?null:{};var d=c.parseQueryString();return a?d[a]:d},setData:function(a,b,c){if("string"==typeof a){var d=this.getData();d[arguments[0]]=arguments[1],a=d}else b&&(a=Object.merge(this.getData(),a));return this.set(c||"query",Object.toQueryString(a))},clearData:function(a){return this.set(a||"query","")},toString:a,valueOf:a});b.regs={endSlash:/\/$/,scheme:/^(\w+):/,directoryDot:/\.\/|\.$/},b.base=new b(Array.from(document.getElements("base[href]",!0)).getLast(),{base:document.location}),String.implement({toURI:function(a){return new b(this,a)}})}();var qwebirc={ui:{themes:{},style:{}},irc:{},util:{},config:{},options:{},auth:{},sound:{},connected:!1},conf=null,ui=null;"undefined"!=typeof QWEBIRC_BUILD?(qwebirc.BUILD=QWEBIRC_BUILD,qwebirc.FILE_SUFFIX="-"+QWEBIRC_BUILD):(qwebirc.BUILD=null,qwebirc.FILE_SUFFIX=""),qwebirc.config.load=function(a){a.frontend.initial_nick_default=a.frontend.initial_nick,a.frontend.initial_chans_default=a.frontend.initial_chans,a.frontend.prompt_default=a.frontend.prompt,a.ui.fg_color_default=a.ui.fg_color,a.ui.fg_sec_color_default=a.ui.fg_sec_color,a.ui.bg_color_default=a.ui.bg_color,qwebirc.config.loadCookieSettings(a);var b=String(document.location),c=qwebirc.util.parseURI(b);if($defined(c.nick)&&!$defined(c.initial_nick)&&(c.initial_nick=c.nick),$defined(c.channels)&&!$defined(c.initial_chans)&&(c.initial_chans=c.channels),-1!=b.splitMax("/",4)[3].indexOf("?")&&(c.chan_list_on_start="0"),$defined(c.initial_nick)){var d=c.initial_nick;a.frontend.initial_nick=d,a.frontend.chan_prompt=!1}if($defined(c.url)){var e=qwebirc.config.parseIRCURL(c.url);e&&(a.frontend.initial_chans=e,a.frontend.chan_prompt=!1)}if($defined(c.initial_chans)){var f=c.initial_chans;a.frontend.initial_chans=f}if($defined(c.prompt)&&(1==c.prompt?a.frontend.prompt=!0:a.frontend.prompt=!1),$defined(c.chan_prompt)&&(1==c.chan_prompt?a.frontend.chan_prompt=!0:a.frontend.chan_prompt=!1),$defined(c.chan_list_on_start)&&(1==c.chan_list_on_start?a.atheme.chan_list_on_start=!0:a.atheme.chan_list_on_start=!1),$defined(c.fg_color)&&(a.ui.fg_color=c.fg_color,a.ui.fg_sec_color=c.fg_color),$defined(c.fg_sec_color)&&(a.ui.fg_sec_color=c.fg_sec_color),$defined(c.bg_color)&&(a.ui.bg_color=c.bg_color),-1!=a.frontend.initial_nick.indexOf(".")){var g=a.frontend.initial_nick;a.frontend.initial_nick=qwebirc.config.randSub(g),a.frontend.initial_nick_rand=!0}else a.frontend.initial_nick_rand=!1;if(a.frontend.initial_chans){for(var h=a.frontend.initial_chans.split(" "),i=h[0].split(" ")[0].split(","),j=0;j<i.length;j++)"#"!=i[j].charAt(0)&&(i[j]="#"+i[j]);h[0]=i.join(","),a.frontend.initial_chans=h.join(" ")}return a},qwebirc.config.loadCookieSettings=function(a){for(var b=new Hash.Cookie("iris-settings",{duration:3650,autoSave:!1}),c=0;c<qwebirc.options.Options.length;c++){var d=qwebirc.options.Options[c].category,e=qwebirc.options.Options[c].option,f=d+"."+e;$defined(b.get(f))&&(a[d][e]=b.get(f))}},qwebirc.config.saveUserSettings=function(a){var b=new Hash.Cookie("iris-settings",{duration:3650,autoSave:!1});b.erase(),b=new Hash.Cookie("iris-settings",{duration:3650,autoSave:!1});for(var c=0;c<qwebirc.options.Options.length;c++){var d=qwebirc.options.Options[c].category,e=qwebirc.options.Options[c].option,f=d+"."+e;b.set(f,a[d][e])}b.save()},qwebirc.config.randSub=function(a){var b=function(){return Math.floor(10*Math.random())};return a.split("").map(function(a){return"."==a?b():a}).join("")},qwebirc.config.parseIRCURL=function(a){if(0!=a.indexOf(":")){var b=a.splitMax(":",2);if("irc"!=b[0].toLowerCase()&&"ircs"!=b[0].toLowerCase())return void alert("Bad IRC URL scheme.");if(0!=a.indexOf("/")){var c=a.splitMax("/",4);if(!(c.length<4||""==c[3])){var d,e;c[3].indexOf("?")>-1?(e=qwebirc.util.parseURI(c[3]),d=c[3].splitMax("?",2)[0]):d=c[3];var f=d.split(","),g=f[0];"#"!=g.charAt(0)&&(g="#"+g);for(var h,i=[],j=!1,k=1;k<f.length;k++){var l=f[k];"needkey"==l?j=!0:i.push(l)}if($defined(e))for(var m in e){var l=e[m];"key"==m?(h=l,
j=!0):i.push(m)}return j&&($defined(h)||(h=prompt("Please enter the password for channel "+g+":")),$defined(h)&&(g=g+" "+h)),i.length>0&&alert("The following IRC URL components were not accepted: "+i.join(", ")+"."),g}}}},Array.prototype.indexFromEnd=function(a){var b=this;return 0>a?b[b.length+a]:b[a]},qwebirc.util.dictCopy=function(a){var b={};for(var c in a)b[c]=a[c];return b},String.prototype.replaceAll=function(a,b){for(var c=this.indexOf(a),d=this;c>-1;)d=d.replace(a,b),c=d.indexOf(a);return d},String.prototype.splitMax=function(a,b){var c=this.split(a),d=c.slice(0,b-1);return c.length>=b&&d.push(c.slice(b-1).join(a)),d},qwebirc.util.parseURI=function(a){var b={},c=a.indexOf("?");if(-1==c)return b;for(var d=a.substring(c+1),e=d.split("&"),f=0;f<e.length;f++){var g=e[f].splitMax("=",2);g.length<2||(b[unescape(g[0])]=unescape(g[1]))}return b},qwebirc.util.DaysOfWeek={0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"},qwebirc.util.MonthsOfYear={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"},qwebirc.util.NBSPCreate=function(a,b){for(var c=a.split("  "),d=0;d<c.length;d++){var e=document.createTextNode(c[d]);if(b.appendChild(e),d!=c.length-1){var f=new Element("span");f.set("html","&nbsp;&nbsp;"),b.appendChild(f)}}},qwebirc.util.longtoduration=function(a){var b=a%60,c=Math.floor(a%3600/60),d=Math.floor(a%86400/3600),e=Math.floor(a/86400);return e+" days "+d+" hours "+c+" minutes "+b+" seconds"},qwebirc.util.pad=function(a){return a=""+a,1==a.length?"0"+a:a},RegExp.escape=function(){var a=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];new RegExp("(\\"+a.join("|\\")+")","g");return function(a){return a.replace(arguments.callee.sRE,"\\$1")}}(),qwebirc.ui.insertAt=function(a,b,c){!b.childNodes||a>=b.childNodes.length?b.appendChild(c):b.insertBefore(c,b.childNodes[a])},qwebirc.util.setCaretPos=function(a,b){if($defined(a.selectionStart))a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.move("character",b),c.select()}},qwebirc.util.setAtEnd=function(a){qwebirc.util.setCaretPos(a.value.length)},qwebirc.util.getCaretPos=function(a){if($defined(a.selectionStart))return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();return b.moveStart("character",-a.value.length),b.text.length}},qwebirc.util.browserVersion=function(){return navigator.userAgent},qwebirc.util.getEnclosedWord=function(a,b){var c=a.split("");if(""!=a){var d=b-1;if(0>d)d=0;else for(;d>=0;d--)if(" "==c[d]){d+=1;break}0>d&&(d=0);var e=a.substring(d),f=e.indexOf(" ");return-1!=f&&(e=e.substring(0,f)),[d,e]}},String.prototype.startsWith=function(a){return this.substring(0,a.length)==a},qwebirc.util.randHexString=function(a){for(var b=function(){return(256*(1+Math.random())|0).toString(16).substring(1)},c=[],d=0;a>d;d++)c.push(b());return c.join("")},qwebirc.util.importJS=function(name,watchFor,onload){var script=document.createElement("script");if(script.type="text/javascript",script.src=name,Browser.Engine.trident){var checkFn=function(){"undefined"!=eval("typeof "+watchFor)?onload():checkFn.delay(100)};checkFn()}else script.onload=onload;document.getElementsByTagName("head")[0].appendChild(script)},qwebirc.util.createInput=function(a,b,c,d,e){var f;if(Browser.Engine.trident){c=c?' name="'+escape(c)+'"':"",e=e?' id="'+escape(e)+'"':"";try{return $(document.createElement('<input type="'+a+'"'+c+e+" "+(d?" checked":"")+"/>"))}catch(g){}}return f=new Element("input"),f.type=a,c&&(f.name=c),e&&(f.id=e),d&&(f.checked=!0),b.appendChild(f),f},qwebirc.util.composeAnd=function(){var a=arguments;return function(){for(var b=0;b<a.length;b++)if(!a[b].apply(this,arguments))return!1;return!0}},qwebirc.util.invertFn=function(a){return function(){return!a.apply(this,arguments)}},qwebirc.util.deviceHasKeyboard=function(){var a=function(){if(Browser.Engine.ipod)return!0;for(var a=["Nintendo Wii"," PIE","BlackBerry","IEMobile","Windows CE","Nokia","Opera Mini","Mobile","mobile","Pocket","pocket","Android"],b=["Chrome","Firefox","Camino","Iceweasel","K-Meleon","Konqueror","SeaMonkey","Windows NT","Windows 9"],c=navigator.userAgent,d=function(a){return c.indexOf(a)>-1},e=0;e<a.length;e++)if(d(a[e]))return!1;for(var e=0;e<b.length;e++)if(d(b[e]))return!0;return!1},b=a();return qwebirc.util.deviceHasKeyboard=function(){return b},b},qwebirc.util.generateID_ID=0,qwebirc.util.generateID=function(){return"qqa-"+qwebirc.util.generateID_ID++},qwebirc.sessionCount=0,qwebirc.session=new Class({irc:null,atheme:{state:null,user:null,token:null},windows:{},initialize:function(){var a=new Hash.Cookie("iris-auth");$defined(a.get("user"))&&(this.atheme.user=a.get("user"),this.atheme.secret=a.get("token")),qwebirc.ui.Atheme.check(this)}}),qwebirc.sound.domReady=!1,window.addEvent("domready",function(){qwebirc.sound.domReady=!0}),qwebirc.sound.SoundPlayer=new Class({Implements:[Events],session:null,initialize:function(a){this.session=a,this.loadingSWF=!1,this.loadedSWF=!1},go:function(){qwebirc.sound.domReady?this.loadSoundManager():window.addEvent("domready",function(){this.loadSoundManager()}.bind(this))},loadSoundManager:function(){if(!this.loadingSWF){if(this.loadingSWF=!0,"undefined"!=eval("typeof soundManager"))return this.loadedSWF=!0,void this.fireEvent("ready");var debugMode=!1;qwebirc.util.importJS(conf.frontend.static_base_url+"js/lib/soundmanager2.js","soundManager",function(){soundManager.url=conf.frontend.static_base_url+"sound/",soundManager.debugMode=debugMode,soundManager.useConsole=debugMode,soundManager.onload=function(){this.loadedSWF=!0,this.fireEvent("ready")}.bind(this),soundManager.beginDelayedInit()}.bind(this))}},createSound:function(a,b){soundManager.createSound(a,b)},playSound:function(a){soundManager.play(a)},beep:function(){this.beepLoaded||(this.createSound("beep",conf.frontend.static_base_url+"sound/beep3.mp3"),this.beepLoaded=!0),this.playSound("beep")}}),qwebirc.VERSION="0.90";var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+encodeURI(J.location).toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();(function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))})(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();qwebirc.irc.AthemeQuery={},qwebirc.irc.AthemeQuery.newRequest=function(a){var b=qwebirc.util.randHexString(16),c=new Request.JSON({url:conf.frontend.dynamic_base_url+"a/"+a+"?r="+b,async:!0});return c.headers=new Hash,c.addEvent("request",function(){var a=function(a,b){try{this.setRequestHeader(a,b)}catch(c){}}.bind(this);a("User-Agent",null),a("Accept",null),a("Accept-Language",null)}.bind(c.xhr)),Browser.Engine.trident&&c.setHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),c},qwebirc.irc.AthemeQuery.login=function(a,b,c){r=qwebirc.irc.AthemeQuery.newRequest("l"),r.addEvent("failure",function(b){a(null)}),r.addEvent("success",function(b,c){a(null!=b?1==b.success?b.output:"":null)});var d="u="+encodeURIComponent(b);d+="&p="+encodeURIComponent(c),r.send(d)},qwebirc.irc.AthemeQuery.logout=function(a,b,c){r=qwebirc.irc.AthemeQuery.newRequest("o"),r.addEvent("failure",function(b){a(null)}),r.addEvent("success",function(b,c){a(null!=b?!0:null)}.bind(this));var d="u="+encodeURIComponent(b);d+="&t="+encodeURIComponent(c),r.send(d)},qwebirc.irc.AthemeQuery.checkLogin=function(a,b,c){r=qwebirc.irc.AthemeQuery.newRequest("c"),r.addEvent("failure",function(b){a(null)}),r.addEvent("success",function(b,c){a(null!=b?b.success:null)}.bind(this));var d="u="+encodeURIComponent(b);d+="&t="+encodeURIComponent(c),d+="&s="+encodeURIComponent("NickServ"),d+="&c="+encodeURIComponent("INFO"),d+="&p="+encodeURIComponent(b),r.send(d)},qwebirc.irc.AthemeQuery.channelList=function(a,b,c,d,e,f){r=qwebirc.irc.AthemeQuery.newRequest("li"),r.addEvent("failure",function(b){a(null,1,1)}),r.addEvent("success",function(b,c){null!=b&&b.success?a(b.list,b.ts,b.total):a(null,1,1)}.bind(this)),""==e&&(e="*"),""==f&&(f="*");var g="s="+encodeURIComponent(c*(d-1));g+="&l="+encodeURIComponent(c),g+="&t="+encodeURIComponent(b),"*"!=e&&(g+="&cm="+encodeURIComponent(e)),"*"!=f&&(g+="&tm="+encodeURIComponent(f)),r.send(g)},qwebirc.irc.CommandHistory=new Class({Implements:[Options],options:{lines:20},initialize:function(a){this.setOptions(a),this.data=[],this.position=0},addLine:function(a,b){(0==this.data.length||a!=this.data[0])&&this.data.unshift(a),b?this.position=0:this.position=-1,this.data.length>this.options.lines&&this.data.pop()},upLine:function(){return 0==this.data.length?null:this.position>=this.data.length?null:(this.position=this.position+1,this.data[this.position])},downLine:function(){return-1==this.position?null:(this.position=this.position-1,-1==this.position?null:this.data[this.position])}}),qwebirc.irc.BaseCommandParser=new Class({initialize:function(a){this.session=a},buildExtra:function(a,b,c){return a||(a={}),a.n=this.session.irc.getNickname(),a.m=c,a.t=b,a},newTargetLine:function(a,b,c,d){d=this.buildExtra(d,a,c);var e=ui.getWindow(b,a);return e?e.type==qwebirc.ui.WINDOW_CHANNEL?void this.session.irc.newChanLine(a,"OURCHAN"+b,null,d):(b="PRIV"+b,void this.session.irc.newLine(a,"OUR"+b,d)):(b="TARGETED"+b,a=!1,void this.session.irc.newActiveLine("OUR"+b,d))},newQueryLine:function(a,b,c,d){if(d=this.buildExtra(d,a,c),conf.dedicated_msg_window){var e=ui.getWindow(b,a);if(!e){var f=ui.newWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages");return void f.addLine("OURTARGETED"+b,d)}}return this.newTargetLine(a,b,c,d)},dispatch:function(a){if(0!=a.length){"/"!=a.charAt(0)&&(a="/SAY "+a);var a=a.substr(1),b=a.splitMax(" ",2),c=b[0].toUpperCase(),d=b[1],e=this.aliases[c];for(e&&(c=e);;){var f=this["cmd_"+c];if(!f)return void(d?this.sendRaw(c+" "+d):this.send(c));var g=f[0],h=f[1],i=f[2],j=f[3],k=this.getActiveWindow();if(g&&k.type!=qwebirc.ui.WINDOW_CHANNEL&&k.type!=qwebirc.ui.WINDOW_QUERY)return void k.errorMessage("Can't use this command in this window");if(void 0!=h&&void 0!=d&&(d=d.splitMax(" ",h)),void 0!=i&&(void 0!=d&&i>d.length||void 0==d&&i>0))return void k.errorMessage("Insufficient arguments for command.");var l=j.run([d],this);if(void 0==l)return;c=l[0],d=l[1]}}},getActiveWindow:function(){return this.session.irc.getActiveWindow()},send:function(){return this.session.irc.send.apply(this.session.irc,arguments)},sendRaw:function(a){return this.session.irc.sendRaw(a)}}),qwebirc.irc.Commands=new Class({Extends:qwebirc.irc.BaseCommandParser,initialize:function(a){this.parent(a),this.aliases={J:"JOIN",K:"KICK",MSG:"PRIVMSG",Q:"QUERY",BACK:"AWAY",HOP:"CYCLE"},$each(qwebirc.ui.Panes,function(b,c,d){var e=b.command(a);e&&(this["cmd_"+e]=[!1,void 0,void 0,function(a){ui.addPane(c)}])}.bind(this))},cmd_ME:[!0,void 0,void 0,function(a){void 0==a&&(a="");var b=this.getActiveWindow().name;this.send("PRIVMSG",b,"ACTION "+a+""),this.newQueryLine(b,"ACTION",a,{"@":this.session.irc.getNickStatus(b,this.session.irc.nickname)})}],cmd_CTCP:[!1,3,2,function(a){var b=a[0],c=a[1].toUpperCase(),d=a[2];void 0==d&&(d=""),""==d?this.send("PRIVMSG",b,""+c+""):this.send("PRIVMSG",b,""+c+" "+d+""),this.newTargetLine(b,"CTCP",d,{x:c})}],cmd_PRIVMSG:[!1,2,2,function(a){var b=a[0],c=a[1];this.session.irc.isChannel(b)||this.session.irc.pushLastNick(b),this.send("PRIVMSG",b,c),this.newQueryLine(b,"MSG",c,{"@":this.session.irc.getNickStatus(b,this.session.irc.nickname)})}],cmd_NOTICE:[!1,2,2,function(a){var b=a[0],c=a[1];this.send("NOTICE",b,c),this.session.irc.isChannel(b)?this.newTargetLine(b,"NOTICE",c,{"@":this.session.irc.getNickStatus(b,this.session.irc.nickname)}):this.newTargetLine(b,"NOTICE",c)}],cmd_QUERY:[!1,2,1,function(a){return this.session.irc.isChannel(a[0])?void this.getActiveWindow().errorMessage("Can't target a channel with this command."):(this.session.irc.newWindow(a[0],qwebirc.ui.WINDOW_QUERY,!0),a.length>1&&""!=a[1]?["SAY",a[1]]:void 0)}],cmd_SAY:[!0,void 0,void 0,function(a){return void 0==a&&(a=""),["PRIVMSG",this.getActiveWindow().name+" "+a]}],cmd_LOGOUT:[!1,void 0,void 0,function(a){this.session.irc.ui.logout()}],cmd_QUOTE:[!1,1,1,function(a){this.send(a[0])}],cmd_KICK:[!0,2,1,function(a){var b=this.getActiveWindow().name,c="",d=a[0];2==a.length&&(c=a[1]),this.send("KICK",b,d,c)}],automode:function(a,b,c){for(var d=this.getActiveWindow().name,e=a,f=0;f<c.length;f++)e+=b;this.sendRaw("MODE "+d+" "+e+" "+c.join(" "))},cmd_OP:[!0,6,1,function(a){this.automode("+","o",a)}],cmd_DEOP:[!0,6,1,function(a){this.automode("-","o",a)}],cmd_VOICE:[!0,6,1,function(a){this.automode("+","v",a)}],cmd_DEVOICE:[!0,6,1,function(a){this.automode("-","v",a)}],cmd_TOPIC:[!0,1,1,function(a){this.send("TOPIC",this.getActiveWindow().name,a[0])}],cmd_AWAY:[!1,1,0,function(a){this.send("AWAY",a?a[0]:"")}],cmd_QUIT:[!1,1,0,function(a){this.send("QUIT",a?a[0]:"")}],cmd_CYCLE:[!0,1,0,function(a){var b=this.getActiveWindow().name;this.send("PART",b,a?a[0]:"rejoining. . ."),this.send("JOIN",b)}],cmd_JOIN:[!1,2,1,function(a){var b=a.shift(),c=b.split(","),d=!1,e=c.map(function(a){return this.session.irc.isChannel(a)?a:(d=!0,"#"+a)}.bind(this));if(d){(function(){this.getActiveWindow().infoMessage("Channel names begin with # (corrected automatically).")}).bind(this).delay(250)}this.send("JOIN",e.join(","))}],cmd_UMODE:[!1,1,0,function(a){this.send("MODE",this.session.irc.getNickname(),a?a[0]:"")}],cmd_BEEP:[!1,void 0,void 0,function(a){this.session.irc.ui.beep()}],cmd_AUTOJOIN:[!1,void 0,void 0,function(a){return["JOIN",this.session.irc.autojoin]}],cmd_CLEAR:[!1,void 0,void 0,function(a){for(var b=this.getActiveWindow().lines;b.childNodes.length>0;)b.removeChild(b.firstChild)}],cmd_PART:[!1,2,0,function(a){var b,c=this.getActiveWindow(),d="";if(c.type!=qwebirc.ui.WINDOW_CHANNEL){if(!a||0==a.length)return void c.errorMessage("Insufficient arguments for command.");b=a[0],a.length>1&&(d=a[1])}else if(a&&0!=a.length){var e=this.session.irc.isChannel(a[0]);e?(b=a[0],a.length>1&&(d=a[1])):(b=c.name,d=a.join(" "))}else b=c.name;this.send("PART",b,d)}]}),qwebirc.irc.PMODE_LIST=0,qwebirc.irc.PMODE_SET_UNSET=1,qwebirc.irc.PMODE_SET_ONLY=2,qwebirc.irc.PMODE_REGULAR_MODE=3,qwebirc.irc.RegisteredCTCPs={VERSION:function(a){return"iris v"+qwebirc.VERSION+" -- "+qwebirc.util.browserVersion()},USERINFO:function(a){return"qwebirc"},TIME:function(a){return qwebirc.irc.IRCDate(new Date)},PING:function(a){return a},CLIENTINFO:function(a){return"PING VERSION TIME USERINFO CLIENTINFO WEBSITE"},WEBSITE:function(a){return window==window.top?"direct":document.referrer}},qwebirc.irc.BaseIRCClient=new Class({session:null,initialize:function(a){this.toIRCLower=qwebirc.irc.RFC1459toIRCLower,this.nickname=a.nickname,this.authUser=a.authUser,this.authSecret=a.authSecret,this.lowerNickname=this.toIRCLower(this.nickname),this.__signedOn=!1,this.__connected=!1,this.caps={},this.sasl_timeout=!1,this.pmodes={b:qwebirc.irc.PMODE_LIST,l:qwebirc.irc.PMODE_SET_ONLY,k:qwebirc.irc.PMODE_SET_UNSET,o:qwebirc.irc.PMODE_SET_UNSET,v:qwebirc.irc.PMODE_SET_UNSET},this.nextctcp=0,this.connections=[];for(var b=0;b<conf.frontend.connections.length;b++)switch(conf.frontend.connections[b]){case"flash":this.connections.unshift(qwebirc.irc.FlashConnection);break;case"websocket":this.connections.unshift(qwebirc.irc.WSConnection)}this.setupGenericErrors()},formatLine:function(a){var b=!1;return a=a.map(function(a){if(b)throw new Error("Spaces in non-trailing argument");return-1!=a.indexOf(" ")?(b=!0,":"+a):a}),a.join(" ")},send:function(){this.connection.send(this.formatLine(Array.from(arguments)))},sendRaw:function(a){this.connection.send(a)},connect:function(){this.tryConnect()},disconnect:function(){this.connection.disconnect()},tryConnect:function(){var a={},b=this.connections.pop();b?(a.initialNickname=this.nickname,a.onRecv=this.dispatch.bind(this),this.connection=new b(a),this.connection.connect()):this.disconnected("Unable to connect")},dispatch:function(a){var b=a[0];if("connect"==b)this.__connected=!0,this.send("CAP","LS"),this.send("USER",this.nickname,"0","*","qwebirc"),this.send("NICK",this.nickname),this.connected();else if("disconnect"==b)this.disconnected(0==a.length?"No error!":a[1]),this.__signedOn?this.disconnect():this.tryConnect();else if("c"==b){for(var c=a[1],d="",e="",f=[],g=0,h=0;g<c.length;)h=c.indexOf(" ",g),0>h&&(h=c.length),g>0&&":"==c.charAt(g)&&(g++,h=c.length),f.push(c.substring(g,h)),g=h+1;":"==f[0].charAt(0)&&(e=f.splice(0,1)[0].substring(1)),d=f.splice(0,1)[0].toUpperCase();var i=qwebirc.irc.Numerics[d];i||(i=d);var j=this["irc_"+i];if(j){var k=j.run([e,f],this);k||this.rawNumeric(d,e,f)}else this.rawNumeric(d,e,f)}},isChannel:function(a){var b=a.charAt(0);return"#"==b},supported:function(a,b){if("CASEMAPPING"==a)"ascii"==b?this.toIRCLower=qwebirc.irc.ASCIItoIRCLower:"rfc1459"==b&&(this.toIRCLower=qwebirc.irc.RFC1459toIRCLower),this.lowerNickname=this.toIRCLower(this.nickname);else if("CHANMODES"==a)for(var c=b.split(","),d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)this.pmodes[c[d].charAt(e)]=d;else if("PREFIX"==a){var f=(b.length-2)/2,g=b.substr(1,f).split("");g.each(function(a){this.pmodes[a]=qwebirc.irc.PMODE_SET_UNSET},this)}},irc_AUTHENTICATE:function(a,b){return this.send("AUTHENTICATE",btoa([this.authUser,this.authUser,this.authSecret].join("\x00"))),!0},irc_saslFinished:function(a,b){return this.send("CAP","END"),$clear(this.sasl_timeout),!1},__saslTimeout:function(){this.send("CAP","END")},irc_CAP:function(a,b){var c;switch(b[1]){case"ACK":for(c="*"==b[2]?b[3].split(" "):b[2].split(" "),d=0;d<c.length;d++)this.caps[c[d]]=!0;"*"!=b[2]&&(this.caps.sasl&&this.authUser?(this.send("AUTHENTICATE",conf.atheme.sasl_type),this.sasl_timeout=this.__saslTimeout.delay(15e3,this)):this.send("CAP","END"));break;case"NAK":this.send("CAP","END");break;case"LS":c="*"==b[2]?b[3].split(" "):b[2].split(" ");for(var d=0;d<c.length;d++)"sasl"==c[d]&&(this.caps[c[d]]=!1),"multi-prefix"==c[d]&&(this.caps[c[d]]=!1);"*"!=b[2]&&(c=Object.keys(this.caps),c.length?this.send("CAP","REQ",c.join(" ")):this.send("CAP","END"))}return!0},irc_RPL_WELCOME:function(a,b){this.nickname=b[0],this.lowerNickname=this.toIRCLower(this.nickname),this.__signedOn=!0,this.signedOn(this.nickname)},irc_NICK:function(a,b){var c=a,d=c.hostToNick(),e=b[0];return this.nickname==d&&(this.nickname=e,this.lowerNickname=this.toIRCLower(this.nickname)),this.nickChanged(c,e),!0},irc_QUIT:function(a,b){var c=a,d=b.indexFromEnd(-1);return this.userQuit(c,d),!0},irc_PART:function(a,b){var c=a,d=b[0],e=b[1];c.hostToNick();return this.userPart(c,d,e),!0},irc_KICK:function(a,b){var c=a,d=b[0],e=b[1],f=b[2];return this.userKicked(c,d,e,f),!0},irc_PING:function(a,b){return this.send("PONG",b.indexFromEnd(-1)),!0},irc_JOIN:function(a,b){var c=b[0],d=a;d.hostToNick();return this.userJoined(d,c),!0},irc_TOPIC:function(a,b){var c=a,d=b[0],e=b.indexFromEnd(-1);return this.channelTopic(c,d,e),!0},processCTCP:function(a){return""==a.charAt(0)?(a=""==a.charAt(a.length-1)?a.substr(1,a.length-2):a.substr(1),a.splitMax(" ",2)):void 0},irc_PRIVMSG:function(a,b){var c=a,d=b[0],e=b.indexFromEnd(-1),f=this.processCTCP(e);if(f){var g=f[0].toUpperCase(),h=qwebirc.irc.RegisteredCTCPs[g];if(h){var i=(new Date).getTime()/1e3;i>this.nextctcp&&this.send("NOTICE",c.hostToNick(),""+g+" "+h(f[1])+""),this.nextctcp=i+5}d==this.nickname?this.userCTCP(c,g,f[1]):this.channelCTCP(c,d,g,f[1])}else d==this.nickname?this.userPrivmsg(c,e):this.channelPrivmsg(c,d,e);return!0},irc_NOTICE:function(a,b){var c=a,d=b[0],e=b.indexFromEnd(-1);if("$"==d[0])""!=c?this.userNotice(c,e):this.serverNotice(c,e);else if(d!=this.nickname&&this.__signedOn)this.channelNotice(c,d,e);else if(""==c||-1==c.indexOf("!"))this.serverNotice(c,e);else{var f=this.processCTCP(e);f?this.userCTCPReply(c,f[0],f[1]):this.userNotice(c,e)}return!0},irc_INVITE:function(a,b){var c=a,d=b.indexFromEnd(-1);return this.userInvite(c,d),!0},irc_ERROR:function(a,b){var c=b.indexFromEnd(-1);return this.serverError(c),!0},irc_MODE:function(a,b){var c=a,d=b[0],e=b.slice(1);if(d==this.nickname)this.userMode(e);else{var f=e[0].split(""),g=e.slice(1),h=[],i=0,j="+";f.each(function(a){if("+"==a||"-"==a)return void(j=a);var b,c=this.pmodes[a];b=c==qwebirc.irc.PMODE_LIST||c==qwebirc.irc.PMODE_SET_UNSET||"+"==j&&c==qwebirc.irc.PMODE_SET_ONLY?[j,a,g[i++]]:[j,a],h.push(b)},this),this.channelMode(c,d,h,e)}return!0},irc_RPL_ISUPPORT:function(a,b){for(var c=b.slice(1,-1),d={},e=0;e<c.length;e++){var f=c[e].splitMax("=",2);d[f[0]]=!0}d.CHANMODES&&d.PREFIX&&(this.pmodes={});for(var e=0;e<c.length;e++){var f=c[e].splitMax("=",2);this.supported(f[0],f[1])}},irc_RPL_NAMREPLY:function(a,b){var c=b[2],d=b[3];return this.channelNames(c,d.split(" ")),!0},irc_RPL_ENDOFNAMES:function(a,b){var c=b[1];return this.channelNames(c,[]),!0},irc_RPL_NOTOPIC:function(a,b){var c=b[1];this.initialTopic(c,"")},irc_RPL_TOPIC:function(a,b){var c=b[1],d=b.indexFromEnd(-1);this.initialTopic(c,d)},irc_RPL_TOPICWHOTIME:function(a,b){return!0},irc_RPL_WHOISUSER:function(a,b){var c=b[1];return this.whoisNick=c,this.whois(c,"user",{ident:b[2],hostname:b[3],realname:b.indexFromEnd(-1)})},irc_RPL_WHOISSERVER:function(a,b){var c=b[1];b[2],b.indexFromEnd(-1);return this.whois(c,"server",{server:b[2],serverdesc:b.indexFromEnd(-1)})},irc_RPL_WHOISOPERATOR:function(a,b){var c=b[1];b.indexFromEnd(-1);return this.whois(c,"oper",{opertext:b.indexFromEnd(-1)})},irc_RPL_WHOISIDLE:function(a,b){var c=b[1];return this.whois(c,"idle",{idle:b[2],connected:b[3]})},irc_RPL_WHOISCHANNELS:function(a,b){var c=b[1];return this.whois(c,"channels",{channels:b.indexFromEnd(-1)})},irc_RPL_WHOISACCOUNT:function(a,b){var c=b[1];return this.whois(c,"account",{account:b[2]})},irc_RPL_WHOISACTUALLY:function(a,b){var c=b[1];return this.whois(c,"actually",{hostmask:b[2],ip:b[3]})},irc_RPL_WHOISOPERNAME:function(a,b){var c=b[1];b[2];return this.whois(c,"opername",{opername:b[2]})},irc_RPL_WHOISAVAILHELP:function(a,b){var c=b[1];return this.whois(c,"availhelp",{})},irc_RPL_WHOISREGGED:function(a,b){var c=b[1];return this.whois(c,"regged",{})},irc_RPL_WHOISMODES:function(a,b){var c=b[1],d=b.indexFromEnd(-1),e=d.split(" ").slice(3).join(" ");return this.whois(c,"modes",{modes:e})},irc_RPL_WHOISREALHOST:function(a,b){var c=b[1],d=b.indexFromEnd(-1),e=d.split(" ")[3],f=d.split(" ")[4];return this.whois(c,"realhost",{hostname:e,ip:f})},irc_RPL_WHOISGENERICTEXT:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.whois(c,"generictext",{text:d})},irc_RPL_WHOISWEBIRC:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.whois(c,"generictext",{text:d})},irc_RPL_WHOISSECURE:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.whois(c,"generictext",{text:d})},irc_RPL_ENDOFWHOIS:function(a,b){var c=b[1];b.indexFromEnd(-1);return this.whoisNick=null,this.whois(c,"end",{})},irc_genericError:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.genericError(c,d),!0},irc_genericQueryError:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.genericQueryError(c,d),!0},irc_genericNickInUse:function(a,b){if(this.genericError(b[1],b.indexFromEnd(-1).replace("in use.","in use")),this.__signedOn)return!0;
var c=b[1]+"_";return c==this.lastnick&&(c="iris"+Math.floor(1024*Math.random()*1024)),this.send("NICK",c),this.lastnick=c,!0},setupGenericErrors:function(){return this.irc_ERR_CHANOPPRIVSNEEDED=this.irc_ERR_CANNOTSENDTOCHAN=this.irc_genericError,this.irc_ERR_NOSUCHNICK=this.irc_genericQueryError,this.irc_ERR_NICKNAMEINUSE=this.irc_ERR_UNAVAILRESOURCE=this.irc_genericNickInUse,this.irc_RPL_LOGGEDIN=this.irc_ERR_NICKLOCKED=this.irc_saslFinished,this.irc_ERR_SASLFAIL=this.irc_ERR_SASLTOOLONG=this.irc_saslFinished,this.irc_ERR_SASLABORTED=this.irc_ERR_SASLALREADY=this.irc_saslFinished,!0},irc_RPL_AWAY:function(a,b){var c=b[1],d=b.indexFromEnd(-1);return this.whoisNick&&this.whoisNick==c?this.whois(c,"away",{away:d}):(this.awayMessage(c,d),!0)},irc_RPL_NOWAWAY:function(a,b){return this.awayStatus(!0,b.indexFromEnd(-1)),!0},irc_RPL_UNAWAY:function(a,b){return this.awayStatus(!1,b.indexFromEnd(-1)),!0},irc_WALLOPS:function(a,b){var c=a,d=b.indexFromEnd(-1);return this.wallops(c,d),!0},irc_RPL_CREATIONTIME:function(a,b){var c=b[1],d=b[2];return this.channelCreationTime(c,d),!0},irc_RPL_CHANNELMODEIS:function(a,b){var c=b[1],d=b.slice(2);return this.channelModeIs(c,d),!0}}),qwebirc.irc.IRCClient=new Class({Extends:qwebirc.irc.BaseIRCClient,initialize:function(a,b){this.parent(b),this.session=a,this.prefixes="@+",this.modeprefixes="ov",this.autojoin=b.autojoin,this.commandparser=new qwebirc.irc.Commands(a),this.exec=this.commandparser.dispatch.bind(this.commandparser),this.hilightController=new qwebirc.ui.HilightController(a),this.statusWindow=ui.newClient(),this.lastNicks=[],this.tracker=new qwebirc.irc.IRCTracker(this)},newLine:function(a,b,c){c||(c={});var d=ui.getWindow(b,a);d?d.addLine(b,c):this.statusWindow.addLine(b,c)},newChanLine:function(a,b,c,d){d||(d={}),$defined(c)&&(d.n=c.hostToNick(),d.h=c.hostToHost(),d["@"]=this.getNickStatus(a,c.hostToNick())),d.c=a,d["-"]=this.nickname,this.newLine(a,b,d)},newServerLine:function(a,b){this.statusWindow.addLine(a,b)},newActiveLine:function(a,b){this.getActiveWindow().addLine(a,b)},newTargetOrActiveLine:function(a,b,c){ui.getWindow(b,a)?this.newLine(a,b,c):this.newActiveLine(b,c)},updateNickList:function(a){var b=this.tracker.getChannel(a),c=new Array,d=String.fromCharCode(255),e={};for(var f in b){var g,h=b[f];if(h.prefixes.length>0){var i=h.prefixes.charAt(0);g=String.fromCharCode(this.prefixes.indexOf(i))+this.toIRCLower(f),e[g]=i+f}else g=d+this.toIRCLower(f),e[g]=f;c.push(g)}c.sort();var j=new Array;c.each(function(a){j.push(e[a])});var k=ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,a);k&&k.updateNickList(j)},newWindow:function(a,b,c){var d=ui.getWindow(b,a);return d||(d=ui.newWindow(b,a)),c&&ui.selectWindow(d),d},newQueryWindow:function(a,b){if(!ui.getWindow(qwebirc.ui.WINDOW_QUERY,a))return b?this.newPrivmsgQueryWindow(a):this.newNoticeQueryWindow(a)},newPrivmsgQueryWindow:function(a){return conf.ui.dedicated_msg_window?ui.getWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages")?void 0:ui.newWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages"):this.newWindow(a,qwebirc.ui.WINDOW_QUERY,!1)},newNoticeQueryWindow:function(a){return conf.ui.dedicated_notice_window&&!ui.getWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages")?ui.newWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages"):void 0},newQueryLine:function(a,b,c,d,e){if(ui.getWindow(qwebirc.ui.WINDOW_QUERY,a))return this.newLine(a,b,c);var f,g=ui.getWindow(qwebirc.ui.WINDOW_MESSAGES,"Messages");return f=d?conf.ui.dedicated_msg_window:conf.ui.dedicated_notice_window,f&&g?g.addLine(b,c):e?this.newActiveLine(b,c):this.newLine(a,b,c)},newQueryOrActiveLine:function(a,b,c,d){this.newQueryLine(a,b,c,d,!0)},getActiveWindow:function(){return ui.getActiveIRCWindow()},getNickname:function(){return this.nickname},addPrefix:function(a,b){for(var c=a.prefixes+b,d=[],e=0;e<this.prefixes.length;e++){var f=this.prefixes.charAt(e),g=c.indexOf(f);-1!=g&&d.push(f)}a.prefixes=d.join("")},stripPrefix:function(a){var b=a.charAt(0);return b&&-1!=this.prefixes.indexOf(b)?a.substring(1):a},removePrefix:function(a,b){a.prefixes=a.prefixes.replaceAll(b,"")},rawNumeric:function(a,b,c){this.newServerLine("RAW",{n:"numeric",m:c.slice(1).join(" ")})},signedOn:function(a){this.tracker=new qwebirc.irc.IRCTracker(this),this.nickname=a,this.newServerLine("SIGNON"),this.autojoin&&this.exec("/AUTOJOIN")},userJoined:function(a,b){var c=a.hostToNick();a.hostToHost();c!=this.nickname||ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,b)||this.newWindow(b,qwebirc.ui.WINDOW_CHANNEL,!0),this.tracker.addNickToChannel(c,b),c==this.nickname?this.newChanLine(b,"OURJOIN",a):conf.ui.hide_joinparts||this.newChanLine(b,"JOIN",a),this.updateNickList(b)},userPart:function(a,b,c){var d=a.hostToNick();a.hostToHost();if(d==this.nickname){this.tracker.removeChannel(b);var e=ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,b);e&&ui.closeWindow(e)}else this.tracker.removeNickFromChannel(d,b),conf.ui.hide_joinparts||this.newChanLine(b,"PART",a,{m:c}),this.updateNickList(b)},userKicked:function(a,b,c,d){if(c==this.nickname){this.tracker.removeChannel(b);var e=ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,b);e&&ui.closeWindow(e)}else this.tracker.removeNickFromChannel(c,b),this.updateNickList(b);this.newChanLine(b,"KICK",a,{v:c,m:d})},channelMode:function(a,b,c,d){c.each(function(a){var c=a[0],d=a[1],e=this.modeprefixes.indexOf(d);if(-1!=e){var f=a[2],g=this.prefixes.charAt(e),h=this.tracker.getOrCreateNickOnChannel(f,b);"-"==c?this.removePrefix(h,g):this.addPrefix(h,g)}},this),this.newChanLine(b,"MODE",a,{m:d.join(" ")}),this.updateNickList(b)},userQuit:function(a,b){var c=a.hostToNick(),d=this.tracker.getNick(c),e=[];for(var f in d)e.push(f),conf.ui.hide_joinparts||this.newChanLine(f,"QUIT",a,{m:b});this.tracker.removeNick(c),e.each(function(a){this.updateNickList(a)},this)},nickChanged:function(a,b){var c=a.hostToNick();c==this.nickname&&(this.nickname=b),this.tracker.renameNick(c,b);var d=this.tracker.getNick(b),e=!1;for(var f in d){var e=!0;this.newChanLine(f,"NICK",a,{w:b}),this.updateNickList(f)}e||this.newServerLine("NICK",{w:b,n:a.hostToNick(),h:a.hostToHost(),"-":this.nickname})},channelTopic:function(a,b,c){this.newChanLine(b,"TOPIC",a,{m:c}),ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,b).updateTopic(c)},initialTopic:function(a,b){ui.getWindow(qwebirc.ui.WINDOW_CHANNEL,a).updateTopic(b)},channelCTCP:function(a,b,c,d){void 0==d&&(d="");var e=a.hostToNick();return"ACTION"==c?(this.tracker.updateLastSpoke(e,b,(new Date).getTime()),void this.newChanLine(b,"CHANACTION",a,{m:d})):void this.newChanLine(b,"CHANCTCP",a,{x:c,m:d})},userCTCP:function(a,b,c){var d=a.hostToNick(),e=a.hostToHost();return void 0==c&&(c=""),"ACTION"==b?(this.newQueryWindow(d,!0),void this.newQueryLine(d,"PRIVACTION",{m:c,x:b,h:e,n:d},!0)):void this.newTargetOrActiveLine(d,"PRIVCTCP",{m:c,x:b,h:e,n:d,"-":this.nickname})},userCTCPReply:function(a,b,c){var d=a.hostToNick(),e=a.hostToHost();void 0==c&&(c=""),this.newTargetOrActiveLine(d,"CTCPREPLY",{m:c,x:b,h:e,n:d,"-":this.nickname})},getNickStatus:function(a,b){var c=this.tracker.getNickOnChannel(b,a);return $defined(c)?0==c.prefixes.length?"":c.prefixes.charAt(0):""},channelPrivmsg:function(a,b,c){var d=a.hostToNick();this.tracker.updateLastSpoke(d,b,(new Date).getTime()),this.newChanLine(b,"CHANMSG",a,{m:c})},channelNotice:function(a,b,c){this.newChanLine(b,"CHANNOTICE",a,{m:c})},userPrivmsg:function(a,b){var c=a.hostToNick(),d=a.hostToHost();this.newQueryWindow(c,!0),this.pushLastNick(c),this.newQueryLine(c,"PRIVMSG",{m:b,h:d,n:c},!0)},serverNotice:function(a,b){""==a?this.newServerLine("SERVERNOTICE",{m:b}):this.newServerLine("PRIVNOTICE",{m:b,n:a})},userNotice:function(a,b){var c=a.hostToNick(),d=a.hostToHost();conf.ui.dedicated_notice_window?(this.newQueryWindow(c,!1),this.newQueryOrActiveLine(c,"PRIVNOTICE",{m:b,h:d,n:c},!1)):this.newTargetOrActiveLine(c,"PRIVNOTICE",{m:b,h:d,n:c})},userInvite:function(a,b){var c=a.hostToNick(),d=a.hostToHost();this.newServerLine("INVITE",{c:b,h:d,n:c})},userMode:function(a){this.newServerLine("UMODE",{m:a,n:this.nickname})},channelNames:function(a,b){return 0==b.length?void this.updateNickList(a):void b.each(function(b){var c=[],d=b.split("");d.every(function(a,d){return-1==this.prefixes.indexOf(a)?(b=b.substr(d),!1):(c.push(a),!0)},this);var e=this.tracker.addNickToChannel(b,a);c.each(function(a){this.addPrefix(e,a)},this)},this)},disconnected:function(a){for(var b in this.session.windows){var c=this.session.windows[b];c.type==qwebirc.ui.WINDOW_CHANNEL&&ui.closeWindow(c)}this.tracker=void 0,qwebirc.connected=!1,this.newServerLine("DISCONNECT",{m:a})},nickOnChanHasPrefix:function(a,b,c){var d=this.tracker.getNickOnChannel(a,b);return $defined(d)?-1!=d.prefixes.indexOf(c):!1},nickOnChanHasAtLeastPrefix:function(a,b,c,d){var e=this.tracker.getNickOnChannel(a,b);if(!$defined(e))return!1;var f=this.prefixes.indexOf(c);if(-1==f)return!1;d||(f+=1);var g={};this.prefixes.slice(0,f).split("").each(function(a){g[a]=!0});for(var h=e.prefixes,i=0;i<h.length;i++)if(g[h.charAt(i)])return!0;return!1},supported:function(a,b){if("PREFIX"==a){var c=(b.length-2)/2;this.modeprefixes=b.substr(1,c),this.prefixes=b.substr(c+2,c)}this.parent(a,b)},connected:function(){qwebirc.connected=!0,this.newServerLine("CONNECT")},serverError:function(a){this.newServerLine("ERROR",{m:a})},quit:function(a){this.send("QUIT",a),this.disconnect()},awayMessage:function(a,b){this.newQueryLine(a,"AWAY",{n:a,m:b},!0)},whois:function(a,b,c){var d,e={n:a},f=function(){this.newTargetOrActiveLine(a,"WHOIS"+d,e)}.bind(this);if("user"==b)d="USER",e.h=c.ident+"@"+c.hostname,f(),d="REALNAME",e.m=c.realname;else if("server"==b)d="SERVER",e.x=c.server,e.m=c.serverdesc;else if("oper"==b)d="OPER";else if("idle"==b)d="IDLE",e.x=qwebirc.util.longtoduration(c.idle),e.m=qwebirc.irc.IRCDate(new Date(1e3*c.connected));else if("channels"==b)d="CHANNELS",e.m=c.channels;else if("account"==b)d="ACCOUNT",e.m=c.account;else if("away"==b)d="AWAY",e.m=c.away;else if("opername"==b)d="OPERNAME",e.m=c.opername;else if("actually"==b)d="ACTUALLY",e.m=c.hostname,e.x=c.ip;else if("availhelp"==b)d="AVAILHELP";else if("regged"==b)d="REGGED";else if("modes"==b)d="MODES",e.m=c.modes;else if("realhost"==b)d="REALHOST",e.m=c.hostname,e.x=c.ip;else if("generictext"==b)d="GENERICTEXT",e.m=c.text;else{if("end"!=b)return!1;d="END"}return f(),!0},genericError:function(a,b){this.newTargetOrActiveLine(a,"GENERICERROR",{m:b,t:a})},genericQueryError:function(a,b){this.newQueryOrActiveLine(a,"GENERICERROR",{m:b,t:a},!0)},awayStatus:function(a,b){this.newActiveLine("GENERICMESSAGE",{m:b})},pushLastNick:function(a){var b=this.lastNicks.indexOf(a);-1!=b?this.lastNicks.splice(b,1):10==this.lastNicks.length&&this.lastNicks.pop(),this.lastNicks.unshift(a)},wallops:function(a,b){var c=a.hostToNick(),d=a.hostToHost();this.newServerLine("WALLOPS",{t:b,n:c,h:d})},channelModeIs:function(a,b){this.newTargetOrActiveLine(a,"CHANNELMODEIS",{c:a,m:b.join(" ")})},channelCreationTime:function(a,b){this.newTargetOrActiveLine(a,"CHANNELCREATIONTIME",{c:a,m:qwebirc.irc.IRCDate(new Date(1e3*b))})}}),qwebirc.irc.FlashConnection=new Class({Implements:[Events,Options],options:{server:"irc.example.com",port:6667,xmlport:8430},initialize:function(a){this.setOptions(a,conf.flash)},connect:function(){return this.buffer=[],FlashSocket.connect?(FlashSocket.state=this.__state.bind(this),void FlashSocket.connect(this.options.server,this.options.port,this.options.xmlport)):void this.fireEvent("recv",[["disconnect","No Flash support"]])},connected:function(){this.fireEvent("recv",[["connect"]])},disconnect:function(){FlashSocket.disconnect()},disconnected:function(a){a=a||"Connection Closed",this.fireEvent("recv",[["disconnect",a]])},send:function(a,b){return FlashSocket.write(String(a)+"\r\n"),!0},recv:function(a){for(var b=10,c=this.buffer.concat(a),d=c.indexOf(b);-1!=d;){var e=c.splice(0,d+1);e.pop(),e.pop(),this.fireEvent("recv",[["c",this.decode(e)]]),d=c.indexOf(b)}this.buffer=c},decode:function(a){for(var b=65533,c=[],d=0;d<a.length;){var e=0,f=0;for(0==(128&a[d])?f=a[d++]:192==(224&a[d])?(e=1,f=31&a[d++]):224==(240&a[d])?(e=2,f=15&a[d++]):240==(248&a[d])?(e=3,f=7&a[d++]):(f=b,d++),x=0;x<e&&d<a.length;x++){var g=a[d++];if(128!=(192&g))break;f=f<<6|63&g}0!=e&&128>f&&(f=b),x!=e&&(f=b),f>=65536?(f-=65536,c.push((f>>10)+55296),c.push(f%1024+56320)):c.push(f)}return String.fromCharCode.apply(null,c)},__state:function(a,b){1==a&&this.connected(),3==a&&this.disconnected(),4==a&&this.disconnected(b),5==a&&this.recv(JSON.parse(b))}}),qwebirc.irc.WSConnection=new Class({Implements:[Events,Options],Binds:["connected","disconnected","recv"],options:{url:"ws://irc.example.com/",timeout:45e3},initialize:function(a){this.setOptions(a,conf.websocket)},connect:function(){return window.WebSocket?(this.socket=new WebSocket(this.options.url,"irc"),this.socket.onopen=this.connected,this.socket.onclose=this.disconnected,void(this.socket.onmessage=this.recv)):void this.fireEvent("recv",[["disconnect","No WebSocket Support"]])},connected:function(a){this.fireEvent("recv",[["connect"]])},disconnect:function(){this.socket.close()},disconnected:function(a){this.fireEvent("recv",[["disconnect",""+(a.reason?a.reason:"Unknown reason")+" ("+a.code+")"]])},send:function(a,b){return this.socket.send(String(a)),!0},recv:function(a){this.fireEvent("recv",[["c",a.data]])}}),qwebirc.irc.IRCLowerTable=["\x00","","","","","","","","\b","	","\n","","\f","\r","","","","","","","","","","","","","","","","","",""," ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","­","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","×","ø","ù","ú","û","ü","ý","þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ"],qwebirc.irc.RFC1459toIRCLower=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);b.push(qwebirc.irc.IRCLowerTable[d])}return b.join("")},qwebirc.irc.ASCIItoIRCLower=function(a){return a.toLowerCase()},String.prototype.hostToNick=function(){return this.split("!",1)[0]},String.prototype.hostToHost=function(){return this.split("!",2)[1]},qwebirc.irc.IRCTimestamp=function(a){return"["+qwebirc.util.pad(a.getHours())+":"+qwebirc.util.pad(a.getMinutes())+"]"},qwebirc.irc.IRCDate=function(a){var b=qwebirc.util.pad;return qwebirc.util.DaysOfWeek[a.getDay()]+" "+qwebirc.util.MonthsOfYear[a.getMonth()]+" "+b(a.getDate())+" "+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+" "+a.getFullYear()},qwebirc.irc.toIRCCompletion=function(a,b){return a.irc.toIRCLower(b).replace(/[^\w]+/g,"")},qwebirc.irc.NickChanEntry=function(){this.prefixes="",this.lastSpoke=0},qwebirc.irc.IRCTracker=new Class({initialize:function(a){this.channels={},this.nicknames={},this.owner=a},toIRCLower:function(a){return this.owner.toIRCLower(a)},isEmpty:function(a){for(var b in a)return!1;return!0},getNick:function(a){return this.nicknames[a]},getOrCreateNick:function(a){var b=this.getNick(a);return b||(b=this.nicknames[a]={}),b},getChannel:function(a){return this.channels[this.toIRCLower(a)]},getOrCreateChannel:function(a){var b=this.getChannel(a);return b||(b=this.channels[this.toIRCLower(a)]={}),b},getOrCreateNickOnChannel:function(a,b){var c=this.getOrCreateNick(a),d=c[this.toIRCLower(b)];return d?d:this.addNickToChannel(a,b)},getNickOnChannel:function(a,b){var c=this.getNick(a);if(c)return c[this.toIRCLower(b)]},addNickToChannel:function(a,b){var c=new qwebirc.irc.NickChanEntry,d=this.getOrCreateNick(a);d[this.toIRCLower(b)]=c;var e=this.getOrCreateChannel(b);return e[a]=c,c},removeNick:function(a){var b=this.getNick(a);if(b){for(var c in b){var d=this.toIRCLower(c),e=this.channels[d];delete e[a],this.isEmpty(e)&&delete this.channels[d]}delete this.nicknames[a]}},removeChannel:function(a){var b=this.getChannel(a);if(b){var c=this.toIRCLower(a);for(var d in b){var e=this.nicknames[d];delete e[c],this.isEmpty(e)&&delete this.nicknames[d]}delete this.channels[c]}},removeNickFromChannel:function(a,b){var c=this.toIRCLower(b),d=this.getNick(a),e=this.getChannel(c);d&&e&&(delete d[c],delete e[a],this.isEmpty(d)&&delete this.nicknames[a],this.isEmpty(e)&&delete this.channels[c])},renameNick:function(a,b){var c=this.getNick(a);if(c){for(var d in c){var e=this.toIRCLower(d);this.channels[e][b]=this.channels[e][a],delete this.channels[e][a]}this.nicknames[b]=this.nicknames[a],delete this.nicknames[a]}},updateLastSpoke:function(a,b,c){var d=this.getNickOnChannel(a,b);$defined(d)&&(d.lastSpoke=c)},getSortedByLastSpoke:function(a){var b=function(a,b){return b[1].lastSpoke-a[1].lastSpoke},c=this.getChannel(a);if(c){var d=[];for(var e in c)d.push([e,c[e]]);d.sort(b);for(var f=[],g=0;g<d.length;g++)f.push(d[g][0]);return f}}}),qwebirc.irc.Numerics={"001":"RPL_WELCOME",433:"ERR_NICKNAMEINUSE",437:"ERR_UNAVAILRESOURCE","004":"RPL_MYINFO","005":"RPL_ISUPPORT",353:"RPL_NAMREPLY",366:"RPL_ENDOFNAMES",331:"RPL_NOTOPIC",332:"RPL_TOPIC",333:"RPL_TOPICWHOTIME",311:"RPL_WHOISUSER",312:"RPL_WHOISSERVER",313:"RPL_WHOISOPERATOR",317:"RPL_WHOISIDLE",671:"RPL_WHOISSECURE",318:"RPL_ENDOFWHOIS",319:"RPL_WHOISCHANNELS",330:"RPL_WHOISACCOUNT",338:"RPL_WHOISACTUALLY",343:"RPL_WHOISOPERNAME",320:"RPL_WHOISGENERICTEXT",310:"RPL_WHOISAVAILHELP",307:"RPL_WHOISREGGED",378:"RPL_WHOISREALHOST",379:"RPL_WHOISMODES",325:"RPL_WHOISWEBIRC",301:"RPL_AWAY",401:"ERR_NOSUCHNICK",404:"ERR_CANNOTSENDTOCHAN",482:"ERR_CHANOPPRIVSNEEDED",305:"RPL_UNAWAY",306:"RPL_NOWAWAY",324:"RPL_CHANNELMODEIS",329:"RPL_CREATIONTIME",900:"RPL_LOGGEDIN",901:"RPL_LOGGEDOUT",902:"ERR_NICKLOCKED",903:"RPL_SASLSUCCESS",904:"ERR_SASLFAIL",905:"ERR_SASLTOOLONG",906:"ERR_SASLABORTED",907:"ERR_SASLALREADY",908:"RPL_SASLMECHS"},qwebirc.ui.Atheme={},qwebirc.ui.Atheme.handleLogin=function(a,b,c){a.atheme.state=!0,a.atheme.user=b,a.atheme.secret=c,cookie=new Hash.Cookie("iris-auth"),cookie.set("user",a.atheme.user),cookie.set("token",a.atheme.secret),cookie.save()},qwebirc.ui.Atheme.handleLogout=function(){this.state=!1},qwebirc.ui.Atheme.check=function(a){$defined(a.atheme.user)&&$defined(a.atheme.secret)&&"AUTHCOOKIE"==conf.atheme.sasl_type?qwebirc.irc.AthemeQuery.checkLogin(function(b){null==b?a.atheme.state=null:b?this.handleLogin(a,a.atheme.user,a.atheme.secret):this.handleLogout()}.bind(this),a.atheme.user,a.atheme.secret):this.handleLogout(a)},qwebirc.ui.AutoScroll=new Class({Extends:Fx.Scroll,Binds:["onScroll","doScroll","update"],initialize:function(a){this.parent(a,{wheelStops:!0}),this.element.addEvent("scroll",this.onScroll),this.scrolling=!0,this.timeout=!1,window.addEvent("resize",this.update)},update:function(){this.scrolling&&!this.timeout&&(this.timeout=setTimeout(this.doScroll,1))},doScroll:function(){this.scrolling=!0,this.timeout=!1,this.toBottom()},onScroll:function(){},scrolledDown:function(){var a=this.element.getScroll(),b=this.element.getScrollSize().y,c=this.element.clientHeight;return c>b&&(b=c),a.y+c>=b}}),qwebirc.ui.WINDOW_STATUS=1,qwebirc.ui.WINDOW_QUERY=2,qwebirc.ui.WINDOW_CHANNEL=4,qwebirc.ui.WINDOW_MESSAGES=8,qwebirc.ui.WINDOW_CUSTOM=16,qwebirc.ui.BaseUI=new Class({initialize:function(a,b,c,d){if(this.session=a,this.parentElement=b,this.windowClass=c,this.windowArray=[],this.parentElement.addClass("qwebirc"),this.parentElement.addClass("qwebirc-"+d),this.firstClient=!1,this.commandhistory=new qwebirc.irc.CommandHistory,this.windowFocused=!0,Browser.Engine.trident){var e=function(){var a=document.hasFocus();a!=this.windowFocused&&(this.windowFocused=a,this.focusChange(a))};e.periodical(100,this)}else{var f=function(){this.windowFocused&&(this.windowFocused=!1,this.focusChange(!1))}.bind(this),g=function(){this.windowFocused||(this.windowFocused=!0,this.focusChange(!0))}.bind(this);document.addEvent("blur",f),window.addEvent("blur",f),document.addEvent("focus",g),window.addEvent("focus",g)}this.postInitialize()},newClient:function(){var a=this.newWindow(qwebirc.ui.WINDOW_STATUS,"Status");return this.selectWindow(a),this.firstClient||(this.firstClient=!0,a.addLine("","qwebirc v"+qwebirc.VERSION),a.addLine("","Copyright (C) 2008-2010 Chris Porter and the qwebirc project."),a.addLine("","http://www.qwebirc.org"),a.addLine("","Licensed under the GNU General Public License, Version 2.")),a},getWindowIdentifier:function(a,b){return a==qwebirc.ui.WINDOW_MESSAGES?"-M":a==qwebirc.ui.WINDOW_STATUS?"":a==qwebirc.ui.WINDOW_CUSTOM?"internal_"+qwebirc.irc.ASCIItoIRCLower(b):"_"+this.session.irc.toIRCLower(b)},newWindow:function(a,b){var c=this.getWindow(a,b);if($defined(c))return c;var d=this.getWindowIdentifier(a,b),c=this.session.windows[d]=new this.windowClass(this.session,a,b,d);return this.windowArray.push(c),c},getWindow:function(a,b){return this.session.windows[this.getWindowIdentifier(a,b)]},getActiveWindow:function(){return this.active},getActiveIRCWindow:function(){return this.active&&this.active.type!=qwebirc.ui.WINDOW_CUSTOM?this.active:this.session.windows[this.getWindowIdentifier(qwebirc.ui.WINDOW_STATUS)]},__setActiveWindow:function(a){this.active=a},selectWindow:function(a){this.active&&this.active.deselect(),a.select(),this.updateTitle(a.name+" - "+conf.frontend.app_title)},updateTitle:function(a){document.title=a},nextWindow:function(a){if(0!=this.windowArray.length&&this.active){a||(a=1);var b=this.windowArray.indexOf(this.active);-1!=b&&(b+=a,0>b?b=this.windowArray.length-1:b>=this.windowArray.length&&(b=0),this.selectWindow(this.windowArray[b]))}},prevWindow:function(){this.nextWindow(-1)},closeWindow:function(a){if(a.closed=!0,a.active)if(this.active=void 0,1==this.windowArray.length)this.windowArray=[];else{var b=this.windowArray.indexOf(a);if(-1==b)return;this.selectWindow(0==b?this.windowArray[1]:this.windowArray[b-1])}delete a.session.windows[a.identifier],this.windowArray=this.windowArray.erase(a)},focusChange:function(a){var b=this.getActiveWindow();$defined(b)&&b.focusChange(a)}}),qwebirc.ui.StandardUI=new Class({Extends:qwebirc.ui.BaseUI,initialize:function(a,b,c,d){this.parent(a,b,c,d),this.tabCompleter=new qwebirc.ui.TabCompleterFactory(a);var e;e=Browser.Engine.trident?"keydown":"keypress",document.addEvent(e,this.__handleHotkey.bind(this))},__handleHotkey:function(a){if(!a.alt||a.control)return void(("backspace"==a.key||"/"==a.key)&&(this.getInputFocused(a)||new Event(a).stop()));var b=!1;if("a"==a.key||"A"==a.key){var c=0,d=-1;b=!0,new Event(a).stop();for(var e=0;e<this.windowArray.length;e++){var f=this.windowArray[e].hilighted;f>c&&(d=e,c=f)}d>-1&&this.selectWindow(this.windowArray[d])}else if(a.key>="0"&&a.key<="9"){if(b=!0,number=a.key-"0",0==number&&(number=10),number-=1,number>=this.windowArray.length)return;this.selectWindow(this.windowArray[number])}else"left"==a.key?(this.prevWindow(),b=!0):"right"==a.key&&(this.nextWindow(),b=!0);b&&new Event(a).stop()},getInputFocused:function(a){return-1==$$("input").indexOf(a.target)&&-1==$$("textarea").indexOf(a.target)?!1:!0},newCustomWindow:function(a,b,c){c||(c=qwebirc.ui.WINDOW_CUSTOM);var d=this.newWindow(c,a);return b&&this.selectWindow(d),d},addPane:function(a){var b=qwebirc.ui.Panes[a].title,c=this.getWindowIdentifier(qwebirc.ui.WINDOW_CUSTOM,b);if(this.session.windows[c])return void this.selectWindow(this.session.windows[c]);var d=this.newCustomWindow(b,!0);d.lines.addClass("qwebirc-pane"+a);var e=new qwebirc.ui.Panes[a].pclass(this.session,d);return d.setSubWindow(e),d},connectWindow:function(a){var b=(qwebirc.ui.Panes.Connect,this.addPane("Connect"));b.subWindow.connectCallback=function(c){ui.closeWindow(b),a(c)}},urlDispatcher:function(a){return"embedded"==a?["a",this.embeddedWindow.bind(this)]:"options"==a?["a",this.optionsWindow.bind(this)]:"whois"==a?["span",function(a){this.session.irc.exec(conf.ui.nick_click_query?"/QUERY "+a:"/WHOIS "+a)}.bind(this)]:"accinfo"==a?["span",function(a){this.session.irc.exec("/MSG NickServ INFO "+a)}.bind(this)]:null},tabComplete:function(a){this.tabCompleter.tabComplete(a)},resetTabComplete:function(){this.tabCompleter.reset()},setModifiableStylesheet:function(a){this.__styleSheet=new qwebirc.ui.style.ModifiableStylesheet(conf.frontend.static_base_url+"css/"+a+qwebirc.FILE_SUFFIX+".mcss"),this.setModifiableStylesheetValues(conf.ui.fg_color,conf.ui.fg_sec_color,conf.ui.bg_color)},setModifiableStylesheetValues:function(a,b,c){var d=new Color(a),e=new Color(b),f=new Color(c),g=1;d.hsb[2]>f.hsb[2]&&(g=-1),$defined(this.__styleSheet)&&this.__styleSheet.set(function(a){return a.setHue(-180+a.hsb[0]+d.hsb[0]).setSaturation(d.hsb[1]+(a.hsb[1]-50)*g).setBrightness(d.hsb[2]+(a.hsb[2]-50)*g)},function(a){return a.setHue(-180+a.hsb[0]+e.hsb[0]).setSaturation(e.hsb[1]+(a.hsb[1]-50)*g).setBrightness(e.hsb[2]+(a.hsb[2]-50)*g)},function(a){return a.setHue(-180+a.hsb[0]+f.hsb[0]).setSaturation(f.hsb[1]+(a.hsb[1]-50)*g).setBrightness(f.hsb[2]+(a.hsb[2]-50)*g)})}}),qwebirc.ui.NotificationUI=new Class({Extends:qwebirc.ui.StandardUI,initialize:function(a,b,c,d){this.parent(a,b,c,d),this.__beeper=new qwebirc.ui.Beeper(a),this.__flasher=new qwebirc.ui.Flasher(a),this.beep=this.__beeper.beep.bind(this.__beeper),this.flash=this.__flasher.flash.bind(this.__flasher),this.cancelFlash=this.__flasher.cancelFlash.bind(this.__flasher)},setBeepOnMention:function(a){a&&this.__beeper.soundInit()},updateTitle:function(a){this.__flasher.updateTitle(a)&&this.parent(a)},focusChange:function(a){this.parent(a),this.__flasher.focusChange(a)}}),qwebirc.ui.RootUI=qwebirc.ui.NotificationUI,qwebirc.ui.RequestTransformHTML=function(a,b){var c={IMG:1},d=b.update,e=b.onSuccess,f=function(a){if(1==a.nodeType){var b=a.nodeName.toUpperCase();if(c[b]){var d=a.getAttribute("transform_attr"),e=a.getAttribute("transform_value");$defined(d)&&$defined(e)&&(a.removeAttribute("transform_attr"),a.removeAttribute("transform_value"),a.setAttribute(d,conf.frontend.static_base_url+e))}for(var g=0;g<a.childNodes.length;g++)f(a.childNodes[g])}};return delete b.update,b.onSuccess=function(a,b,c,g){var h=new Element("div");for(h.set("html",c),f(h),d.empty();h.childNodes.length>0;){var i=h.firstChild;h.removeChild(i),d.appendChild(i)}e()},new Request.HTML(b)},qwebirc.ui.HILIGHT_NONE=0,qwebirc.ui.HILIGHT_ACTIVITY=1,qwebirc.ui.HILIGHT_SPEECH=2,qwebirc.ui.HILIGHT_US=3,qwebirc.ui.WINDOW_LINES=qwebirc.ui.WINDOW_QUERY|qwebirc.ui.WINDOW_MESSAGES|qwebirc.ui.WINDOW_CHANNEL|qwebirc.ui.WINDOW_STATUS,qwebirc.ui.Window=new Class({Implements:[Events],initialize:function(a,b,c,d){this.session=a,this.type=b,this.name=c,this.active=!1,this.identifier=d,this.hilighted=qwebirc.ui.HILIGHT_NONE,this.commandhistory=ui.commandhistory,this.lastNickHash={},this.lastSelected=null,this.subWindow=null,this.closed=!1,this.type&qwebirc.ui.WINDOW_LINES&&(this.lastPositionLine=new Element("hr"),this.lastPositionLine.addClass("lastpos"),this.lastPositionLineInserted=!1)},updateTopic:function(a,b){qwebirc.ui.Colourise(this.session,"["+a+"]",b)},subEvent:function(a){$defined(this.subWindow)&&this.subWindow.fireEvent(a)},setSubWindow:function(a){this.subWindow=a},select:function(){this.lastPositionLineInserted&&!conf.ui.lastpos_line&&(this.lines.removeChild(this.lastPositionLine),this.lastPositionLineInserted=!1),this.active=!0,ui.__setActiveWindow(this),this.hilighted&&this.setHilighted(qwebirc.ui.HILIGHT_NONE),this.subEvent("select"),this.lastSelected=new Date,$defined(this.lines.scroller)&&this.lines.scroller.update()},deselect:function(){this.subEvent("deselect"),this.type&qwebirc.ui.WINDOW_LINES&&this.replaceLastPositionLine(),this.active=!1},addLine:function(a,b,c,d){var e=qwebirc.ui.HILIGHT_NONE,f=!1;a&&(e=qwebirc.ui.HILIGHT_ACTIVITY,a.match(/(NOTICE|ACTION|MSG)$/)&&((this.type==qwebirc.ui.WINDOW_QUERY||this.type==qwebirc.ui.WINDOW_MESSAGES)&&(a.match(/^OUR/)||a.match(/NOTICE$/)?e=qwebirc.ui.HILIGHT_ACTIVITY:(e=qwebirc.ui.HILIGHT_US,ui.beep(),ui.flash())),!a.match(/^OUR/)&&this.session.irc.hilightController.match(b.m)?(f=!0,e=qwebirc.ui.HILIGHT_US,ui.beep(),ui.flash()):e!=qwebirc.ui.HILIGHT_US&&(e=qwebirc.ui.HILIGHT_SPEECH))),this.active||e==qwebirc.ui.HILIGHT_NONE||this.setHilighted(e),a&&(b=ui.theme.message(a,b,f)),qwebirc.ui.Colourise(this.session,qwebirc.irc.IRCTimestamp(new Date)+" "+b,d),this.scrollAdd(d)},errorMessage:function(a){this.addLine("",a,"warncolour")},infoMessage:function(a){this.addLine("",a,"infocolour")},setHilighted:function(a){(a==qwebirc.ui.HILIGHT_NONE||a>=this.hilighted)&&(this.hilighted=a)},scrollAdd:function(a){var b=this.lines;$defined(a)&&(b.appendChild(a),$defined(b.scroller)&&b.scroller.update())},updateNickList:function(a){for(var b={},c={},d=this.lastNickHash,e=0;e<a.length;e++)c[a[e]]=1;for(var f in d)c[f]||this.nickListRemove(f,d[f]);for(var e=0;e<a.length;e++){var g=a[e],h=d[g];h||(h=this.nickListAdd(g,e),h||(h=1)),b[g]=h}this.lastNickHash=b},nickListAdd:function(a,b){},nickListRemove:function(a,b){},historyExec:function(a){this.commandhistory.addLine(a),this.session.irc.exec(a)},focusChange:function(a){1!=a&&this.type&qwebirc.ui.WINDOW_LINES&&this.replaceLastPositionLine()},replaceLastPositionLine:function(){if(conf.ui.lastpos_line)if(this.lastPositionLineInserted){if(this.lines.lastChild!=this.lastPositionLine){try{this.lines.removeChild(this.lastPositionLine)}catch(a){}this.scrollAdd(this.lastPositionLine)}}else this.scrollAdd(this.lastPositionLine);else this.lastPositionLineInserted&&this.lines.removeChild(this.lastPositionLine);this.lastPositionLineInserted=conf.ui.lastpos_line}}),qwebirc.ui.Colourise=function(a,b,c){function d(a){return a>="0"&&"9">=a}function e(a,b){return d(a[b+1])?(b++,d(a[b+1])?(h=parseInt(a[b]+a[b+1]),b++):h=parseInt(a[b]),","!=a[b+1]?b:d(a[b+2])?(b+=2,d(a[b+1])?(i=parseInt(a[b]+a[b+1]),b++):i=parseInt(a[b]),b):b):(h=void 0,i=void 0,b)}function f(){var b="";if(m.length>0){var b=qwebirc.ui.urlificate(a,o,m.join(""));c.appendChild(o),m=[]}return o=document.createElement("span"),b}function g(){if(l)return o;var a=[];void 0!=h&&a.push("Xc"+h),void 0!=i&&a.push("Xbc"+i),k&&a.push("Xb"),j&&a.push("Xu"),o.className=a.join(" ")}var h,i,j=!1,k=!1,l=!1,m=[],n=b.split(""),o=document.createElement("span");c.addClass("colourline");for(var p=conf.ui.nick_colors,q=!1,r=0;r<n.length;r++){var s=n[r];if(p){if(q){if("\x00"!=s)m.push(s);else{l=!0;var t=g(),u=f(),v=u.toHSBColour(a);$defined(v)&&(t.style.color=v.rgbToHex()),q=l=!1}continue}if("\x00"==s){q=!0,f();continue}}else if("\x00"==s)continue;""==s?(f(),k=!k,g()):""==s?(f(),j=!j,g()):""==s?(f(),h=void 0,i=void 0,j=!1,k=!1):""==s?(f(),r=e(n,r),i>15&&(i=void 0),h>15&&(h=void 0),g()):m.push(s)}f()},String.prototype.toHSBColour=function(a){var b=a.irc.toIRCLower(a.irc.stripPrefix(this));if(b==a.irc.lowerNickname)return null;for(var c=0,d=0;d<b.length;d++)c=31*c+b.charCodeAt(d);var e=Math.abs(c)%360;return new Color([e,70,60],"hsb")},qwebirc.ui.create=function(a,b){var c=new qwebirc.session;window.addEvent("domready",function(){var d=function(a){c.irc=new qwebirc.irc.IRCClient(c,a),c.irc.connect(),window.onbeforeunload=qwebirc.ui.onbeforeunload,window.addEvent("unload",function(){c.irc.quit("Web client closed")})};ui=new b(c,$(a)),ui.connectWindow(d),conf.atheme.chan_list_on_start&&qwebirc.ui.Panes.List&&ui.addPane("List")})},qwebirc.ui.onbeforeunload=function(a){if(qwebirc.connected){var b="This action will close all active IRC connections.",a=a||window.event;return a&&(a.returnValue=b),b}},qwebirc.ui.MENU_ITEMS=function(){var a=function(a){var b=this.name,c=this.session.irc.nickname;return this.session.irc.nickOnChanHasAtLeastPrefix(c,b,"+",!0);
},b=function(a){var b=this.name,c=this.session.irc.nickname;return this.session.irc.nickOnChanHasAtLeastPrefix(c,b,"@",!1)},c=function(a){var b=this.name;return this.session.irc.nickOnChanHasPrefix(a,b,"@")},d=function(a){var b=this.name;return this.session.irc.nickOnChanHasPrefix(a,b,"+")},e=qwebirc.util.invertFn,f=qwebirc.util.composeAnd,g=function(a){return function(b){this.session.irc.exec("/"+a+" "+b)}};return[{text:"PM",fn:g("query"),predicate:!0},{text:"whois",fn:g("whois"),predicate:!0},{text:"kick",fn:function(a){this.session.irc.exec("/KICK "+a+" wibble")},predicate:a},{text:"op",fn:g("op"),predicate:f(b,e(c))},{text:"deop",fn:g("deop"),predicate:f(b,c)},{text:"voice",fn:g("voice"),predicate:f(a,e(d))},{text:"devoice",fn:g("devoice"),predicate:f(a,d)}]},qwebirc.ui.HilightController=new Class({initialize:function(a){this.session=a,this.regex=null,this.prevnick=null},match:function(a){var b=this.session.irc.nickname;if(b!=this.prevnick){var c="[\\s\\.,;:]";this.regex=new RegExp("(^|"+c+")"+RegExp.escape(b)+"("+c+"|$)","i")}return a.match(this.regex)?!0:!1}}),qwebirc.ui.Beeper=new Class({initialize:function(a){this.session=a,this.soundInited=!1,this.soundReady=!1,conf.ui.beep_on_mention&&this.soundInit()},soundInit:function(){this.soundInited||!$defined(Browser.Plugins.Flash)||Browser.Plugins.Flash.version<8||(this.soundInited=!0,this.soundPlayer=new qwebirc.sound.SoundPlayer(this.session),this.soundPlayer.addEvent("ready",function(){this.soundReady=!0}.bind(this)),this.soundPlayer.go())},beep:function(){this.soundReady&&conf.ui.beep_on_mention&&this.soundPlayer.beep()}}),qwebirc.ui.Flasher=new Class({initialize:function(a){this.session=a,this.windowFocused=!1,this.canUpdateTitle=!0,this.titleText=document.title;var b=this._getFavIcon();$defined(b)?(this.favIcon=b,this.favIconParent=b.parentNode,this.favIconVisible=!0,this.emptyFavIcon=new Element("link"),this.emptyFavIcon.rel="shortcut icon",this.emptyFavIcon.href=conf.frontend.static_base_url+"images/empty_favicon.ico",this.emptyFavIcon.type="image/x-icon",this.flashing=!1,this.canFlash=!0,document.addEvent("mousedown",this.cancelFlash.bind(this)),document.addEvent("keydown",this.cancelFlash.bind(this))):this.canFlash=!1},_getFavIcon:function(){for(var a=$$("head link"),b=0;b<a.length;b++)if("shortcut icon"==a[b].getAttribute("rel"))return a[b]},flash:function(){if(conf.ui.flash_on_mention&&!this.windowFocused&&this.canFlash&&!this.flashing){this.titleText=document.title;var a=function(){this.hideFavIcon(),this.canUpdateTitle=!1,document.title="Activity!",this.flasher=b.delay(500)}.bind(this),b=function(){this.showFavIcon(),this.canUpdateTitle=!0,document.title=this.titleText,this.flasher=a.delay(500)}.bind(this);this.flashing=!0,a()}},cancelFlash:function(){this.canFlash&&$defined(this.flasher)&&(this.flashing=!1,$clear(this.flasher),this.flasher=null,this.showFavIcon(),document.title=this.titleText,this.canUpdateTitle=!0)},hideFavIcon:function(){this.favIconVisible&&(this.favIconVisible=!1,this.favIconParent.removeChild(this.favIcon),this.favIconParent.appendChild(this.emptyFavIcon))},showFavIcon:function(){this.favIconVisible||(this.favIconVisible=!0,this.favIconParent.removeChild(this.emptyFavIcon),this.favIconParent.appendChild(this.favIcon))},updateTitle:function(a){return this.titleText=a,this.canUpdateTitle},focusChange:function(a){this.windowFocused=a,a&&this.cancelFlash()}}),qwebirc.ui.supportsFocus=function(a){var b=navigator.userAgent;return $defined(b)&&(Browser.Engine.ipod||-1!=b.indexOf("Konqueror"))?!1:!0},qwebirc.options.Input=new Class({initialize:function(a,b,c,d,e){this.session=a,this.options=b,this.option=d,this.value=conf[d.category][d.option],this.enabled=!0,this.position=e,this.parentElement=c,this.id=qwebirc.util.generateID(),$defined(this.option.isEnabled)&&(this.enabled=this.option.isEnabled(a)),this.render()},createInput:function(a,b,c,d){return $defined(b)||(b=this.parentElement),qwebirc.util.createInput(a,b,c,d,this.id)},FE:function(a,b){var c=new Element(a);return $defined(b)||(b=this.parentElement),b.appendChild(c),c},focus:function(){this.mainElement.focus()},onChange:function(){$defined(this.option.onChange)&&this.option.onChange(this.session,this.options,this.get())}}),qwebirc.options.TextInput=new Class({Extends:qwebirc.options.Input,render:function(){var a=this.createInput("text");a.addEvent("change",function(a){this.value=a,this.onChange()}.bind(this)),this.mainElement=a,a.value=this.value,a.disabled=!this.enabled},get:function(){return this.mainElement.value}}),qwebirc.options.ColorInput=new Class({Extends:qwebirc.options.Input,render:function(){this.hexbox=null,"#"!=this.value[0]&&(this.value="#"+this.value);var a=new Element("div");a.addClass("qwebirc-optionspane"),a.addClass("hue-slider"),this.parentElement.appendChild(a);var b=new Element("div");b.addClass("qwebirc-optionspane"),b.addClass("sat-slider");var c=new Element("div");c.addClass("qwebirc-optionspane"),c.addClass("light-slider");var d=new Element("form",{"class":"hexform"});this.hexbox=new Element("input",{value:this.value}),d.appendChild(this.hexbox);var e=new Element("input",{type:"button",value:"Reset to Default"});conf.ui.simple_color||(this.parentElement.appendChild(b),this.parentElement.appendChild(c),this.parentElement.appendChild(d),this.parentElement.appendChild(e));var f=new Color(this.value),g=new Element("div");g.addClass("knob"),Browser.Engine.trident&&(g.setStyle("top","0px"),g.setStyle("background-color","black")),a.appendChild(g);var h=new Slider(a,g,{steps:36,range:[0,369],wheel:!0});h.set(f.hsb[0]),g=new Element("div"),g.addClass("knob"),Browser.Engine.trident&&(g.setStyle("top","0px"),g.setStyle("background-color","black")),b.appendChild(g);var i=new Slider(b,g,{steps:50,range:[0,100],wheel:!0});i.set(f.hsb[1]),g=new Element("div"),g.addClass("knob"),Browser.Engine.trident&&(g.setStyle("top","0px"),g.setStyle("background-color","black")),c.appendChild(g);var j=new Slider(c,g,{steps:50,range:[0,100],wheel:!0});j.set(f.hsb[2]);var k=function(a){var b=$HSB(h.step,i.step,j.step);this.value=b.rgb.rgbToHex(),this.onChange()}.bind(this);this.enabled&&(h.addEvent("change",k),i.addEvent("change",k),j.addEvent("change",k),d.addEvent("submit",function(a){new Event(a).stop();var b=new Color(this.hexbox.value);h.set(b.hsb[0]),i.set(b.hsb[1]),j.set(b.hsb[2])}.bind(this)),e.addEvent("click",function(a){new Event(a).stop(),this.value=conf[this.option.category][this.option.option+"_default"];var b=new Color(this.value);h.set(b.hsb[0]),i.set(b.hsb[1]),j.set(b.hsb[2])}.bind(this))),this.mainElement=a,this.startValue=this.value},onChange:function(){this.hexbox.value=this.get(),$defined(this.option.onChange)&&this.option.onChange(this.session,this.options,this.get())},get:function(){return this.value},cancel:function(){this.value=this.startValue,this.get()}}),qwebirc.options.CheckInput=new Class({Extends:qwebirc.options.Input,render:function(){var a=this.createInput("checkbox");a.addEvent("change",function(a){this.value=a,this.onChange()}.bind(this)),this.mainElement=a,a.checked=this.value,a.disabled=!this.enabled},get:function(){return this.mainElement.checked}}),qwebirc.options.RadioInput=new Class({Extends:qwebirc.options.Input,render:function(){var a=this.option.options;this.elements=[];for(var b=0;b<a.length;b++){var c=this.FE("div"),d=this.createInput("radio",c,"options_radio"+this.position,b==this.option.position);this.elements.push(d),d.disabled=!this.enabled;var e=b;d.addEvent("change",function(a){a&&(this.option.position=e,this.onChange())}.bind(this)),0==b&&(this.mainElement=d),c.appendChild(document.createTextNode(a[b][0]))}},get:function(){for(var a=0;a<this.elements.length;a++){var b=this.elements[a];if(b.checked)return this.option.position=a,this.option.options[a][1]}}}),qwebirc.options.Options=[{category:"ui",option:"beep_on_mention",label:"Beep when nick mentioned or on query activity (requires Flash)",isEnabled:function(a){return!$defined(Browser.Plugins.Flash)||Browser.Plugins.Flash.version<8?!1:!0},onSave:function(a){ui.updateBeepOnMention&&ui.updateBeepOnMention()}},{category:"ui",option:"dedicated_msg_window",label:"Send privmsgs to dedicated messages window"},{category:"ui",option:"dedicated_notice_window",label:"Send notices to dedicated message window"},{category:"ui",option:"flash_on_mention",label:"Flash titlebar when nick mentioned or on query activity",isEnabled:qwebirc.ui.supportsFocus},{category:"ui",option:"lastpos_line",label:"Show a last position indicator for each window",isEnabled:qwebirc.ui.supportsFocus},{category:"ui",option:"nick_colors",label:"Automatically colour nicknames"},{category:"ui",option:"nick_status",label:"Show status symbol before nicknames in channel lines"},{category:"ui",option:"nick_click_query",label:"Open a PM window on clicking a nickname in channel"},{category:"ui",option:"hide_joinparts",label:"Hide JOINS/PARTS/QUITS"},{category:"ui",option:"fg_color",type:qwebirc.options.ColorInput,label:"Adjust main foreground color",onChange:function(a,b,c){ui.setModifiableStylesheetValues(c,b["ui.fg_sec_color"].get(),b["ui.bg_color"].get())},isEnabled:function(a){return!conf.ui.simple_color}},{category:"ui",option:"fg_sec_color",type:qwebirc.options.ColorInput,label:"Adjust title/link foreground color",onChange:function(a,b,c){ui.setModifiableStylesheetValues(b["ui.fg_color"].get(),c,b["ui.bg_color"].get())},isEnabled:function(a){return!conf.ui.simple_color}},{category:"ui",option:"bg_color",type:qwebirc.options.ColorInput,label:"Adjust background color",onChange:function(a,b,c){$defined(b["ui.fg_color"])?ui.setModifiableStylesheetValues(b["ui.fg_color"].get(),b["ui.fg_sec_color"].get(),c):ui.setModifiableStylesheetValues(conf.ui.fg_color,conf.ui.fg_sec_color,c)},onSave:function(a){ui.setModifiableStylesheetValues(conf.ui.fg_color,conf.ui.fg_sec_color,conf.ui.bg_color)},onCancel:function(a){ui.setModifiableStylesheetValues(conf.ui.fg_color,conf.ui.fg_sec_color,conf.ui.bg_color)}}],qwebirc.ui.Panes={},qwebirc.ui.style.ModifiableStylesheet=new Class({initialize:function(a){var b=this.__parseStylesheet(this.__getStylesheet(a));this.__cssText=b.cssText,this.rules=b.rules,this.__tag=this.__createTag()},__createTag:function(){var a=document.createElement("style");return a.type="text/css",a.media="all",document.getElementsByTagName("head")[0].appendChild(a),a},__getStylesheet:function(a){var b,c=new Request({url:a,async:!1});return c.addEvent("complete",function(a){b=a}),c.get(),b},__setStylesheet:function(a){var b=this.__tag;if(b.styleSheet)b.styleSheet.cssText=a;else{var c=document.createTextNode(a);for(b.appendChild(c);b.childNodes.length>1;)b.removeChild(b.firstChild)}},__parseStylesheet:function(a){var b,c=a.replace("\r\n","\n").split("\n"),d={};for(b=0;b<c.length;b++){var e=c[b];if(""===e.trim())break;var f=e.splitMax("=",2);2==f.length&&(d[f[0]]=f[1])}for(var g=[];b<c.length;b++)g.push(c[b]);return{cssText:g.join("\n"),rules:d}},set:function(a,b,c){a||(a=function(a){return a}),b||(b=a),c||(c=function(a){return a});var d=this.__cssText;for(var e in this.rules){var f;f="fg_sec_"==e.substring(7,0)?b(new Color(this.rules[e])):"fg_"==e.substring(3,0)?a(new Color(this.rules[e])):c(new Color(this.rules[e])),"255,255,255"==f&&(f="255,255,254"),d=d.replaceAll("$("+e+")","rgb("+f+")")}this.__setStylesheet(d)}}),qwebirc.ui.TabCompleterFactory=new Class({initialize:function(a){this.session=a,this.reset()},tabComplete:function(a){var b=a.value;if(!$defined(this.obj)){this.incr=1;var c=ui.getActiveWindow();if(!c)return;var d=qwebirc.util.getEnclosedWord(b,qwebirc.util.getCaretPos(a)),e="",f="",g="";if($defined(d))var e=b.substring(0,d[0]),f=d[1],g=b.substring(d[0]+f.length);var h=b.toLowerCase();if(""==b)e="/msg ",obj=qwebirc.ui.QueryTabCompleter;else if(this.session.irc.isChannel(f))obj=qwebirc.ui.ChannelNameTabCompleter;else if(h.match(/^\/(q|query|msg) /i))obj=qwebirc.ui.QueryTabCompleter;else if(c.type==qwebirc.ui.WINDOW_QUERY)obj=qwebirc.ui.QueryNickTabCompleter;else{if(c.type!=qwebirc.ui.WINDOW_CHANNEL)return;""==e&&(g=""!=g&&" "==g.charAt(0)?":"+g:": "+g,this.incr++),obj=qwebirc.ui.ChannelUsersTabCompleter}if(""==g&&(g=" "),this.obj=new obj(this.session,e,f,g,c),!$defined(this.obj))return}var i=this.obj.get();$defined(i)&&(a.value=i[1],qwebirc.util.setCaretPos(a,i[0]+this.incr))},reset:function(){this.obj=null}}),qwebirc.ui.TabIterator=new Class({initialize:function(a,b,c){if(this.prefix=b,$defined(c)&&0!=c.length){for(var d=[],e=qwebirc.irc.toIRCCompletion(a,b),f=0;f<c.length;f++){var g=qwebirc.irc.toIRCCompletion(a,c[f]);g.startsWith(e)&&d.push(c[f])}this.list=d}else this.list=null;this.pos=-1},next:function(){return $defined(this.list)?(this.pos=this.pos+1,this.pos>=this.list.length&&(this.pos=0),this.list[this.pos]):null}}),qwebirc.ui.BaseTabCompleter=new Class({initialize:function(a,b,c,d,e){this.existingNick=c,this.prefix=b,this.suffix=d,this.iterator=new qwebirc.ui.TabIterator(a,c,e)},get:function(){var a=this.iterator.next();if(!$defined(a))return null;var b=this.prefix+a;return[b.length,b+this.suffix]}}),qwebirc.ui.QueryTabCompleter=new Class({Extends:qwebirc.ui.BaseTabCompleter,initialize:function(a,b,c,d){this.parent(a,b,c,d,a.irc.lastNicks)}}),qwebirc.ui.QueryNickTabCompleter=new Class({Extends:qwebirc.ui.BaseTabCompleter,initialize:function(a,b,c,d){var e=window.name;this.parent(a,b,c,d,[e])}}),qwebirc.ui.ChannelNameTabCompleter=new Class({Extends:qwebirc.ui.BaseTabCompleter,initialize:function(a,b,c,d){var e=[];for(var f in a.irc.channels){var g=a.windows[f];$defined(g)&&(g=g.lastSelected),e.push([g,f])}e.sort(function(a,b){return b[0]-a[0]});for(var h=[],i=0;i<e.length;i++)h.push(e[i][1]);this.parent(a,b,c,d,h)}}),qwebirc.ui.ChannelUsersTabCompleter=new Class({Extends:qwebirc.ui.BaseTabCompleter,initialize:function(a,b,c,d,e){var e=a.irc.tracker.getSortedByLastSpoke(ui.getActiveWindow().name);this.parent(a,b,c,d,e)}}),qwebirc.ui.themes.ThemeControlCodeMap={C:"",B:"",U:"",O:"","{":"\x00","}":"\x00","[":"qwebirc://whois/","]":"/",$:"$"},qwebirc.ui.themes.Default={PREFIX:["$C4==$O "],SIGNON:["Signed on!",!0],CONNECT:["Connected to server.",!0],RAW:["$m",!0],DISCONNECT:["Disconnected from server: $m",!0],ERROR:["ERROR: $m",!0],SERVERNOTICE:["$m",!0],JOIN:["${$N$} [$h] has joined $c",!0],OURJOIN:["${$N$} [$h] has joined $c",!0],PART:["${$N$} [$h] has left $c [$m]",!0],KICK:["${$v$} was kicked from $c by ${$N$} [$m]",!0],MODE:["mode/$c [$m] by ${$N$}",!0],QUIT:["${$N$} [$h] has quit [$m]",!0],NICK:["${$n$} has changed nick to ${$[$w$]$}",!0],TOPIC:["${$N$} changed the topic of $c to: $m",!0],UMODE:["Usermode change: $m",!0],INVITE:["$N invites you to join $c",!0],HILIGHT:["$C4"],HILIGHTEND:["$O"],CHANMSG:["<${$@$($N$)$}> $m"],PRIVMSG:["<$($N$)> $m"],CHANNOTICE:["-${$($N$)$}:$c- $m"],PRIVNOTICE:["-$($N$)- $m"],OURCHANMSG:["<$@$N> $m"],OURPRIVMSG:["<$N> $m"],OURTARGETEDMSG:["*$[$t$]* $m"],OURTARGETEDNOTICE:["[notice($[$t$])] $m"],OURCHANNOTICE:["-$N:$t- $m"],OURPRIVNOTICE:["-$N- $m"],OURCHANACTION:[" * $N $m"],OURPRIVACTION:[" * $N $m"],CHANACTION:[" * ${$($N$)$} $m"],PRIVACTION:[" * $($N$) $m"],CHANCTCP:["$N [$h] requested CTCP $x from $c: $m"],PRIVCTCP:["$N [$h] requested CTCP $x from $-: $m"],CTCPREPLY:["CTCP $x reply from $N: $m"],OURCHANCTCP:["[ctcp($t)] $x $m"],OURPRIVCTCP:["[ctcp($t)] $x $m"],OURTARGETEDCTCP:["[ctcp($t)] $x $m"],WHOISUSER:["$B$N$B [$h]",!0],WHOISREALNAME:[" realname : $m",!0],WHOISCHANNELS:[" channels : $m",!0],WHOISSERVER:[" server   : $x [$m]",!0],WHOISACCOUNT:[" account  : qwebirc://accinfo/$m",!0],WHOISIDLE:[" idle     : $x [connected: $m]",!0],WHOISAWAY:[" away     : $m",!0],WHOISOPER:[" oper     : $BIRC Operator$B",!0],WHOISOPERNAME:[" operedas : $m",!0],WHOISACTUALLY:[" realhost : $m [ip: $x]",!0],WHOISAVAILHELP:[" oper     : is available for help.",!0],WHOISREGGED:[" regged   : has a registered nick.",!0],WHOISMODES:[" modes    : $m",!0],WHOISREALHOST:[" realhost : $m ($x)",!0],WHOISGENERICTEXT:[" info     : $m",!0],WHOISEND:["End of WHOIS",!0],AWAY:["$N is away: $m",!0],GENERICERROR:["$m: $t",!0],GENERICMESSAGE:["$m",!0],WALLOPS:["WALLOP $n: $t",!0],CHANNELCREATIONTIME:["Channel $c was created at: $m",!0],CHANNELMODEIS:["Channel modes on $c are: $m",!0]},qwebirc.ui.Theme=new Class({initialize:function(a){if(this.__theme=qwebirc.util.dictCopy(qwebirc.ui.themes.Default),a)for(var b in a)this.__theme[b]=a[b];for(var b in this.__theme)if("PREFIX"!=b){var c=this.__theme[b];c[1]?this.__theme[b]=this.__theme.PREFIX+c[0]:this.__theme[b]=c[0]}this.__ccmap=qwebirc.util.dictCopy(qwebirc.ui.themes.ThemeControlCodeMap),this.__ccmaph=qwebirc.util.dictCopy(this.__ccmap),this.__ccmaph["("]=this.message("HILIGHT",{},this.__ccmap),this.__ccmaph[")"]=this.message("HILIGHTEND",{},this.__ccmap),this.__ccmaph["{"]=this.__ccmaph["}"]=""},__dollarSubstitute:function(a,b,c){for(var d=[],e=a.split(""),f=0;f<e.length;f++){var g=e[f];if("$"==g&&f<=e.length-1){var h=e[++f],i=c[h];i||(i=b[h]),i&&d.push(i)}else d.push(g)}return d.join("")},message:function(a,b,c){var d;return d=c?this.__ccmaph:this.__ccmap,b&&b.n&&(b.N="qwebirc://whois/"+b.n+"/"),this.__dollarSubstitute(this.__theme[a],b,d)}}),qwebirc.ui.urlificate=function(a,b,c){var d=/[[\)|\]]?(\.*|[\,;])$/,e=[],f=function(a,b,c,d){for(;;){var e=a.search(b);if(-1==e){c(a);break}var f=a.match(b),g=a.substring(0,e),h=f[0],i=a.substring(e+h.length);c(g);var j=d(h,c);j||(j=""),a=j+i}},g=function(a){e.push(a),qwebirc.util.NBSPCreate(a,b)},h=function(c){var f=c.replace(d,"");e.push(f);var g=c.substring(f.length),h=new Element("span");return h.href="#",h.addClass("hyperlink-channel"),h.addEvent("click",function(b){if(new Event(b).stop(),a.irc)a.irc.exec("/JOIN "+f);else{var c=ui.getWindow(qwebirc.ui.WINDOW_CUSTOM,"Connect");if(c){var d=c.subWindow.connectChannel(f);d||(ui.selectWindow(c),c.subWindow.nickBox.focus())}}}),h.appendChild(document.createTextNode(f)),b.appendChild(h),g},i=function(a,c){var f,g=a.replace(d,""),h=a.substring(g.length),i=null,j="_blank",k=g,l="a",m=g.match(/^qwebirc:\/\/(.*)$/);if(m){var n=m[1].match(/^([^\/]+)\/([^\/]+)\/?(.*)$/);if(!n)return void c(a);var o=ui.urlDispatcher(n[1]);if(!o)return void c(a);f=n[1],l=o[0],g="a"!=o[0]?null:"#",i=o[1],k=unescape(n[2]),j=null,n[3]&&(h=n[3]+h)}else g.match(/^www\./)&&(g="http://"+g);var p=new Element(l);return f&&p.addClass("hyperlink-"+f),g&&(p.href=g,j&&(p.target=j)),e.push(k),p.appendChild(document.createTextNode(k)),b.appendChild(p),$defined(i)?p.addEvent("click",function(a){new Event(a).stop(),i(k)}):p.addEvent("click",function(a){new Event(a).stopPropagation()}),h};return f(c,/\b((https?|ftp|qwebirc):\/\/|www\.)[^ ]+/,function(a){f(a,/\B#[^ ,]+/,g,h)},i),e.join("")},qwebirc.ui.Panes.About={title:"About",command:function(a){return"ABOUT"},menuitem:function(a){return"About Iris"},menupos:600},qwebirc.ui.Panes.About.pclass=new Class({Implements:[Events],session:null,initialize:function(a,b){this.session=a;var c=function(){b.lines.set("html",'<div class="loading">Loading. . .</div>')},d=c.delay(500),e=qwebirc.ui.RequestTransformHTML(a,{url:conf.frontend.static_base_url+"panes/about.html",update:b.lines,onSuccess:function(){$clear(d),b.lines.getElement("input[class=close]").addEvent("click",function(){ui.closeWindow(b)}),b.lines.getElement("span[class=version]").set("text","v"+qwebirc.VERSION)}});e.get()}}),qwebirc.ui.Panes.Connect={title:"Connect",command:function(a){return null},menuitem:function(a){return null}},qwebirc.ui.Panes.Connect.pclass=new Class({Implements:[Events],session:null,parent:null,connectCallback:null,nickBox:null,chanBox:null,initialize:function(a,b){this.session=a,this.parent=b.lines,!conf.frontend.prompt&&conf.frontend.initial_nick&&conf.frontend.initial_chans?this.createConfirmBox():this.createLoginBox(null)},connectChannel:function(a){return conf.frontend.chan_autoconnect&&(conf.frontend.initial_nick||this.nickBox&&this.nickBox.value)?(this.connect(a),!0):(null!=this.chanBox?this.chanBox.set("value",a):this.createLoginBox(a),!1)},connect:function(a){for(;this.parent.childNodes.length>0;)this.parent.removeChild(this.parent.firstChild);var b={};null!=this.nickBox?b.nickname=this.nickBox.value:b.nickname=conf.frontend.initial_nick,null!=a?b.autojoin=a:null!=this.chanBox?b.autojoin=this.chanBox.value:b.autojoin=conf.frontend.initial_chans,this.session.atheme.state&&(b.authUser=this.session.atheme.user,b.authSecret=this.session.atheme.secret),this.connectCallback(b)},autoFocus:function(a){try{window.self===window.top&&a.focus()}catch(b){}},createConfirmBox:function(){for(;this.parent.childNodes.length>0;)this.parent.removeChild(this.parent.firstChild);var a=new Element("table");a.addClass("qwebirc-centrebox"),this.parent.appendChild(a);var b=new Element("tbody");a.appendChild(b);var c=new Element("tr");b.appendChild(c);var d=new Element("td");c.appendChild(d);var e=new Element("table");e.addClass("qwebirc-confirmbox"),d.appendChild(e);var b=new Element("tbody");e.appendChild(b);var c=new Element("tr");b.appendChild(c),c.addClass("tr1");var f=new Element("td");c.appendChild(f);var g=new Element("b");g.set("text",conf.frontend.initial_nick);var h=conf.frontend.initial_chans.split(" ")[0].split(",");f.appendChild(document.createTextNode("To connect to "+conf.frontend.network_name+" IRC and join channel"+(h.length>1?"s":"")+" "));for(var i=0;i<h.length;i++)h.length>1&&i==h.length-1?f.appendChild(document.createTextNode(" and ")):i>0&&f.appendChild(document.createTextNode(", ")),f.appendChild(new Element("b").set("text",h[i]));conf.frontend.initial_nick_rand||(f.appendChild(document.createTextNode(" as ")),f.appendChild(g)),f.appendChild(document.createTextNode(" click 'Connect'.")),f.appendChild(new Element("br"));var c=new Element("tr");b.appendChild(c),c.addClass("tr2");var d=new Element("td");c.appendChild(d);var j=new Element("form");d.appendChild(j);var k=new Element("input",{type:"submit",value:"Connect"});j.appendChild(k),this.autoFocus(k),j.addEvent("submit",function(a){new Event(a).stop(),this.connect(null)}.bind(this))},createLoginBox:function(a){function b(a,b,c){var e=new Element("tr");d.appendChild(e);var f=new Element("td");a&&f.set("text",a),e.appendChild(f);var g=new Element("td");return e.appendChild(g),$defined(b)&&g.appendChild(b),$defined(c)?(e.setStyles(c),[e,g]):g}for(;this.parent.childNodes.length>0;)this.parent.removeChild(this.parent.firstChild);var c=new Element("table");c.addClass("qwebirc-centrebox"),this.parent.appendChild(c);var d=new Element("tbody");c.appendChild(d);var e=new Element("tr");d.appendChild(e);var f=new Element("td");e.appendChild(f);var g=new Element("table");g.addClass("qwebirc-loginbox"),f.appendChild(g);var d=new Element("tbody");g.appendChild(d);var e=new Element("tr");d.appendChild(e),e.addClass("tr1");var f=new Element("td");e.appendChild(f),f.set("html","<h1>Connect to "+conf.frontend.network_name+" IRC</h1>");var e=new Element("tr");d.appendChild(e),e.addClass("tr2");var f=new Element("td");e.appendChild(f);var h=new Element("form");f.appendChild(h);var i=new Element("table");h.appendChild(i);var d=new Element("tbody");if(i.appendChild(d),this.nickBox=new Element("input"),b("Nickname:",this.nickBox),conf.atheme.nickserv_login){var j=new Element("input");j.set("type","checkbox"),j.set("checked",!1),b("Login to Services:",j);var k=new Element("input"),l=b("Username:",k,{})[0];l.setStyle("display","none");var m=new Element("input");m.set("type","password");var n=b("Password:",m,{})[0];n.setStyle("display","none");var o=function(a){k.value=this.nickBox.value}.bind(this);k.addEvent("input",function(a){this.nickBox.removeEvent("input",o,!1)}.bind(this),!1),j.addEvent("click",function(a){var b=j.checked,c=b?null:"none";l.setStyle("display",c),n.setStyle("display",c),b?(this.nickBox.addEvent("input",o,!1),k.focus(),k.value=this.nickBox.value):(this.nickBox.removeEvent("input",o,!1),this.nickBox.focus())}.bind(this))}(a||conf.frontend.chan_prompt||!conf.frontend.initial_chans)&&(this.chanBox=new Element("input"),b("Channels:",this.chanBox));var p=new Element("input",{type:"submit"});p.set("value","Connect");b(void 0,p);h.addEvent("submit",function(a){if(new Event(a).stop(),!this.nickBox.value)return alert("You must supply a nickname."),void this.nickBox.focus();if(!this.nickBox.value.match(/^[a-zA-Z0-9`^\-_\[\]{}|\\]+$/))return alert('Invalid nickname entered; only characters in the list "A-Z a-z 0-9 ` ^ - \\ [ ] { } |" are allowed.'),void this.nickBox.focus();if(this.nickBox.value.match(/^\d/)||"-"==this.nickBox.value[0])return alert("Invalid nickname entered; nicknames may not start with - or a number."),void this.nickBox.focus();if(Cookie.write("iris-nick",this.nickBox.value,{duration:3650}),conf.atheme.nickserv_login){if(j.checked){if(!k.value)return alert("You must supply a username."),void k.focus();if(!m.value)return alert("You must supply a password."),void m.focus()}j.checked&&"AUTHCOOKIE"==conf.atheme.sasl_type?qwebirc.irc.AthemeQuery.login(function(a){null==a?alert("Authentication failed"):qwebirc.ui.Atheme.handleLogin(this.session,k.value,a),this.connect(null)}.bind(this),k.value,m.value):j.checked&&"PLAIN"==conf.atheme.sasl_type?(this.session.atheme.state=!0,this.session.atheme.user=k.value,this.session.atheme.secret=m.value,this.connect(null)):(qwebirc.ui.Atheme.handleLogout(this.session),this.connect(null))}else this.connect(null)}.bind(this)),null!=Cookie.read("iris-nick")?this.nickBox.set("value",Cookie.read("iris-nick")):conf.frontend.initial_nick&&this.nickBox.set("value",conf.frontend.initial_nick),null!=this.chanBox&&a?this.chanBox.set("value",a):null!=this.chanBox&&this.chanBox.set("value",conf.frontend.initial_chans),this.autoFocus(this.nickBox)}}),qwebirc.ui.Panes.Embed={title:"Webchat Wizard",command:function(a){return conf.frontend.base_url?"EMBED":void 0},menuitem:function(a){return conf.frontend.base_url?"Add webchat to your site":void 0},menupos:200},qwebirc.ui.Panes.Embed.pclass=new Class({Implements:[Events],parent:null,session:null,initialize:function(a,b){this.session=a,this.window=b,this.parent=b.lines,this.create(),this.addSteps()},create:function(){this.t=this.parent;var a=this.newRow();this.title=new Element("h2"),this.title.setStyle("margin-top","0px"),this.title.setStyle("margin-bottom","5px"),a.appendChild(this.title),this.firstRow=this.newRow(),this.middleRow=this.newRow();var b=this.newRow();this.hint=new Element("div"),this.hint.setStyle("font-size","0.8em"),this.hint.setStyle("font-style","italic"),b.appendChild(this.hint);var c=this.newRow();this.example=new Element("pre"),c.appendChild(this.example);var d=this.newRow();d.addClass("wizardcontrols");var e=new Element("input");e.type="submit",e.value="< Back",e.addEvent("click",this.back.bind(this)),d.appendChild(e);var f=new Element("input");f.type="submit",f.value="Next >",d.appendChild(f),f.addEvent("click",this.next.bind(this)),this.nextBtn=f,this.backBtn=e},newRow:function(){var a=new Element("div");return this.t.appendChild(a),a},newStep:function(a){return new qwebirc.ui.Panes.Embed.Step(this,a)},newRadio:function(a,b,c,d){var e=new Element("div");a.appendChild(e);var f=qwebirc.util.generateID(),g=qwebirc.util.createInput("radio",e,c,d,f),h=new Element("label",{"for":f});return h.appendChild(document.createTextNode(b)),e.appendChild(h),g},addSteps:function(){var a=function(a){if(Browser.Engine.trident){var b=function(){this.focus(),a&&this.select()};b.delay(100,this,[])}else this.focus(),this.select()};this.welcome=this.newStep({title:"Add webchat to your site!",first:"This wizard will help you create an embedded client by asking you questions then giving you the code to add to your website.<br/><br/>You can use the <b>Next</b> and <b>Back</b> buttons to navigate through the wizard; click <b>Next</b> to continue."});var b=conf.frontend.initial_nick_default;this.nicknameBox=new Element("input"),this.nicknameBox.addClass("text"),this.nicknameBox.set("value",b),this.nickname=this.newStep({title:"Set nickname",first:"Enter the nickname you would like the client to use by default. Leave it blank for users to be forced to enter a nick themselves:",hint:"You can use a random nick by ending the nick in a series of '.' characters, each of which will be replaced by a random digit.",middle:this.nicknameBox}).addEvent("show",a.bind(this.nicknameBox));var c=conf.frontend.initial_chans_default;this.chanBox=new Element("input"),this.chanBox.addClass("text"),this.chanBox.set("value",c),this.chans=this.newStep({title:"Set channels",first:"Enter the channels you would like the client to join on startup:",hint:"You can supply multiple channels by seperating them with a comma, e.g.:",example:"#rogue,#eu-mage",middle:this.chanBox}).addEvent("show",a.bind(this.chanBox));var d=conf.frontend.prompt_default,e=new Element("form");this.connectdialog=this.newStep({title:"Display connect dialog?",first:"Do you want the user to be shown the connect dialog (with the values you have supplied pre-entered) or just a connect confirmation?",middle:e,hint:"You need to display the dialog if you want the user to be able to edit their nickname before connecting."}),this.connectdialogr=this.newRadio(e,"Show the connect dialog.","prompt",d);var f=(this.newRadio(e,"Connect without displaying the dialog.","prompt",!d),new Element("form"));this.choosecolor=this.newStep({title:"Customize color?",first:"Would you like to customize the colors used by the widget?",middle:f,hint:"Color customization can be used to make the widget match the rest of your site."});this.newRadio(f,"Use the default colors.","colors",!0);this.coloroptr=this.newRadio(f,"Choose custom widget colors.","colors",!1),this.fgColor=new Element("input"),this.fgColor.addClass("text"),this.fgColor.set("value",conf.ui.fg_color),this.foregroundcolor=this.newStep({title:"Set foreground color",first:"Set the widget's foreground (text) color:",middle:this.fgColor,hint:"Enter a hexadecimal color specification, e.g.:",example:"#0A0A0A"}).addEvent("show",a.bind(this.fgColor)),this.secColor=new Element("input"),this.secColor.addClass("text"),this.secColor.set("value",conf.ui.fg_sec_color),this.secondarycolor=this.newStep({title:"Set secondary color",first:"Set the widget's secondary foreground (heading) color:",middle:this.secColor,hint:"Enter a hexadecimal color specification, e.g.:",example:"#1A1A1A"}).addEvent("show",a.bind(this.secColor)),this.bgColor=new Element("input"),this.bgColor.addClass("text"),this.bgColor.set("value",conf.ui.bg_color),this.backgroundcolor=this.newStep({title:"Set background color",first:"Set the widget's background color:",middle:this.bgColor,hint:"Enter a hexadecimal color specification, e.g.:",example:"#FFFFFF"}).addEvent("show",a.bind(this.bgColor));var g=new Element("div");this.finish=this.newStep({title:"Finished!",first:"Your custom link is:",middle:g}).addEvent("show",function(){var b=new Element("a"),c=new Element("input");c.addClass("iframetext");var d=this.generateURL(!1);b.href=d,b.target="_blank",b.appendChild(document.createTextNode(d)),c.value='<iframe src="'+d+'" width="647" height="400"></iframe>';for(var e=[b,new Element("br"),new Element("br"),document.createTextNode("You can embed this into your page with the following code:"),new Element("br"),c];g.childNodes.length>0;)g.removeChild(g.childNodes[0]);e.forEach(function(a){g.appendChild(a)}),a.bind(c)(!0),c.addEvent("click",function(){this.select()}.bind(c))}.bind(this)),this.updateSteps(),this.step=0,this.showStep()},updateSteps:function(){this.steps=[this.welcome,this.nickname,this.chans],""!=this.chanBox.value&&""!=this.nicknameBox.value&&this.steps.push(this.connectdialog),this.steps.push(this.choosecolor),1==this.coloroptr.checked&&(this.steps.push(this.foregroundcolor),this.steps.push(this.secondarycolor),this.steps.push(this.backgroundcolor)),this.steps.push(this.finish)},showStep:function(){this.backBtn.disabled=!(this.step>0),this.nextBtn.value=this.step>=this.steps.length-1?"Close":"Next >",this.steps[this.step].show()},next:function(){var a=this.steps[this.step].options.premove;
if(!a||a()){if(this.updateSteps(),this.step>=this.steps.length-1)return void this.close();this.step=this.step+1,this.showStep()}},close:function(){ui.closeWindow(this.window)},back:function(){this.step<=0||(this.step=this.step-1,this.showStep())},generateURL:function(){var a=this.chanBox.value,b=this.nicknameBox.value,c=this.connectdialogr.checked&&""!=a&&""!=b,d=this.coloroptr.checked,e=this.fgColor.value,f=this.secColor.value,g=this.bgColor.value,h=[];if(h.push("nick="+escape(b)),a){var i=a.split(","),j=[];i.forEach(function(a){"#"==a.charAt(0)&&(a=a.substring(1)),j.push(a)}),h.push("channels="+escape(j.join(",")))}else h.push("channels=");return d&&(h.push("fg_color="+e.replace("#","")),h.push("fg_sec_color="+f.replace("#","")),h.push("bg_color="+g.replace("#",""))),c?h.push("prompt=1"):""!=a&&""!=b&&h.push("prompt=0"),conf.frontend.base_url+(h.length>0?"?":"")+h.join("&")}}),qwebirc.ui.Panes.Embed.Step=new Class({Implements:[Options,Events],options:{title:"",first:"",hint:"",middle:null,premove:null,example:""},initialize:function(a,b){this.setOptions(b),this.parent=a},show:function(){for(this.parent.title.set("html",this.options.title),this.parent.firstRow.set("html",this.options.first),this.parent.hint.set("html",this.options.hint),this.parent.example.set("text",this.options.example);this.parent.middleRow.childNodes.length>0;)this.parent.middleRow.removeChild(this.parent.middleRow.childNodes[0]);$defined(this.options.middle)&&this.parent.middleRow.appendChild(this.options.middle),this.fireEvent("show")}}),qwebirc.ui.Panes.FAQ={title:"FAQ",command:function(a){return"FAQ"},menuitem:function(a){return"Frequently asked questions"},menupos:400},qwebirc.ui.Panes.FAQ.pclass=new Class({Implements:[Events],session:null,initialize:function(a,b){this.session=a;var c=function(){b.lines.set("html",'<div class="loading">Loading. . .</div>')},d=c.delay(500),e=qwebirc.ui.RequestTransformHTML(a,{url:conf.frontend.static_base_url+"panes/faq.html",update:b.lines,onSuccess:function(){$clear(d),b.lines.getElement("input[class=close]").addEvent("click",function(){ui.closeWindow(b)}.bind(this))}.bind(this)});e.get()}}),qwebirc.ui.Panes.Feedback={title:"Feedback",command:function(a){return"FEEDBACK"},menuitem:function(a){return"Feedback"},menupos:500},qwebirc.ui.Panes.Feedback.pclass=new Class({Implements:[Events],session:null,initialize:function(a,b){this.session=a,this.textboxVisible=!1;var c=function(){b.lines.set("html",'<div class="loading">Loading. . .</div>')},d=c.delay(500);this.addEvent("select",this.onSelect);var e=qwebirc.ui.RequestTransformHTML(a,{url:conf.frontend.static_base_url+"panes/feedback.html",update:b.lines,onSuccess:function(){$clear(d),b.lines.getElement("input[class=close]").addEvent("click",function(){ui.closeWindow(b)}.bind(this)),b.lines.getElement("input[class=close2]").addEvent("click",function(){ui.closeWindow(b)}.bind(this));var a=b.lines.getElement("textarea");this.textbox=a,b.lines.getElement("input[class=submitfeedback]").addEvent("click",function(){this.sendFeedback(b.lines,a,a.value)}.bind(this)),this.textboxVisible=!0,this.onSelect()}.bind(this)});e.get()},onSelect:function(){this.textboxVisible&&this.textbox.focus()},sendFeedback:function(a,b,c){c=c.replace(/^\s*/,"").replace(/\s*$/,"");var d=a.getElement("p[class=maintext]");if(c.length<25)return d.set("text","I don't suppose you could enter a little bit more? Thanks!"),void b.focus();this.textboxVisible=!1;var e=w.lines.getElement("div[class=enterarea]");e.setStyle("display","none");var f=w.lines.getElement("div[class=messagearea]"),g=w.lines.getElement("p[class=messagetext]"),h=w.lines.getElement("input[class=close2]");g.set("text","Submitting. . ."),f.setStyle("display","");for(var i=0,j=(encodeURIComponent(c),0);j<c.length;j++)i=(i+1)%256^c.charCodeAt(j)%256;new Request({url:conf.frontend.dynamic_base_url+"feedback",onSuccess:function(){g.set("text","Submitted successfully, thanks for the feedback!"),h.setStyle("display","")},onFailure:function(){this.textboxVisible=!0,f.setStyle("display","none"),e.setStyle("display",""),d.set("text","Looks like something went wrong submitting :(")}.bind(this)}).send("feedback="+c+"&c="+i)}}),qwebirc.ui.Panes.List={title:"Channels",command:function(a){return conf.atheme.chan_list?"LIST":void 0},menuitem:function(a){return conf.atheme.chan_list?"Channel list":void 0},menupos:100},qwebirc.ui.Panes.List.pclass=new Class({Implements:[Events],session:null,parent:null,cloud:!0,loading:null,timestamp:0,page:1,namefilter:"",topicfilter:"",filterBox:null,viewBox:null,chanBox:null,pageBox:null,viewChange:null,pageText:null,prev:null,next:null,initialize:function(a,b){this.session=a,this.parent=b.lines,this.cloud=conf.atheme.chan_list_cloud_view;var c=new Element("table"),d=new Element("tbody");c.appendChild(d),this.viewChange=new Element("a",{"class":"",href:"#"}),this.viewChange.addEvent("click",function(a){this.cloud?this.createListView():this.createCloudView()}.bind(this));var e=new Element("td",{"class":"viewchange"});e.appendChild(this.viewChange),d.appendChild(e);var f=new Element("form",{"class":"filterbox"}),g=new Element("span",{"class":"inputbox"});g.appendText("Filter by Name:");var h=new Element("input");g.appendChild(h),f.appendChild(g);var g=new Element("span",{"class":"inputbox"});g.appendText("Filter by Topic:");var i=new Element("input");g.appendChild(i),f.appendChild(g);var j=new Element("input",{type:"submit",value:"Refresh and Apply Filters"});j.addEvent("click",function(a){new Event(a).stop(),(h.value!=this.namefilter||i.value!=this.topicfilter)&&(this.namefilter=h.value,this.topicfilter=i.value,this.page=1),this.timestamp=0,this.update()}.bind(this)),f.appendChild(j);var e=new Element("td");e.appendChild(f),d.appendChild(e),this.parent.appendChild(c),this.viewBox=new Element("div"),this.parent.appendChild(this.viewBox),this.cloud?this.createCloudView():this.createListView()},createListView:function(){for(this.cloud=!1;this.viewBox.childNodes.length>0;)this.viewBox.removeChild(this.viewBox.firstChild);this.viewChange.set("text","Switch to cloud view...");var a=new Element("table",{"class":"listbox",cellspacing:"0"});this.chanBox=new Element("tbody"),a.appendChild(this.chanBox),this.viewBox.appendChild(a),this.pageBox=new Element("div",{"class":"pagebox"}),this.pageBox.style.display="none",this.prev=new Element("span"),this.pageText=new Element("span"),this.next=new Element("span"),this.pageBox.appendChild(this.prev),this.pageBox.appendText(" - "),this.pageBox.appendChild(this.pageText),this.pageBox.appendText(" - "),this.pageBox.appendChild(this.next),this.viewBox.appendChild(this.pageBox);var b=function(){this.chanBox.set("html",'<tr><td class="loading">Loading. . .</td></tr>')}.bind(this);this.loading=b.delay(500),this.update()},createCloudView:function(){for(this.cloud=!0,this.page=1;this.viewBox.childNodes.length>0;)this.viewBox.removeChild(this.viewBox.firstChild);this.viewChange.set("text","Switch to list view...");var a=new Element("div",{"class":"hoverhint"});a.appendText("Hover over a channel to view its topic!"),this.viewBox.appendChild(a),this.chanBox=new Element("div",{"class":"tagbox"}),this.viewBox.appendChild(this.chanBox),this.update()},update:function(){qwebirc.irc.AthemeQuery.channelList(function(a,b,c){if(this.timestamp=b,null!=this.loading&&(clearTimeout(this.loading),this.loading=null),this.chanBox.hasChildNodes())for(;this.chanBox.childNodes.length>=1;)this.chanBox.removeChild(this.chanBox.firstChild);if(null==a)return void(this.cloud?this.chanBox.set("html",'<span class="loading">Unable to load channel list, please try reopening the channel list later.</span>'):this.chanBox.set("html",'<tr><td class="loading">Unable to load channel list, please try refreshing again later.</td></tr>'));if(0==a.length)return void(this.cloud?this.chanBox.set("html",'<span class="loading">No channels currently exist, please try refreshing again later.</span>'):this.chanBox.set("html",'<tr><td class="loading">No channels currently exist, please try refreshing again later.</td></tr>'));var d=a[a.length-1].users,e=a[0].users-d;if(!this.cloud){var f=new Element("tr"),g=new Element("th",{"class":"name"});g.appendText("Channel"),f.appendChild(g);var h=new Element("th",{"class":"users"});h.appendText("Users"),f.appendChild(h);var i=new Element("th",{"class":"chantopic"});i.appendText("Topic"),f.appendChild(i),this.chanBox.appendChild(f)}this.cloud&&a.sort(function(a,b){return an=a.name.toLowerCase(),bn=b.name.toLowerCase(),an<bn?-1:an>bn?1:0});for(var j=0;j<a.length;j++){var k;k=this.cloud?new Element("span",{"class":"chantag",style:"font-size: "+(1+2*(a[j].users-d)/(e+1))+"em;"}):new Element("tr"),this.makeChannel(k,a[j],j%2+1),this.chanBox.appendChild(k),this.cloud&&this.chanBox.appendText(" ")}}.bind(this),this.timestamp,"100",this.page,this.namefilter,this.topicfilter)},updatePaging:function(a){if(this.pageText){for(var b=Math.ceil(a/100);this.pageText.childNodes.length>=1;)this.pageText.removeChild(this.pageText.firstChild);this.pageText.appendText("Page "+this.page+" of "+b)}if(this.prev&&this.next){for(;this.prev.childNodes.length>=1;)this.prev.removeChild(this.prev.firstChild);if(this.page>1){var c=new Element("a",{href:"#"});c.appendText("Prev Page"),c.addEvent("click",function(a){this.page--,c.removeEvents(),this.update()}.bind(this)),this.prev.appendChild(c)}else this.prev.appendText("Prev Page");for(;this.next.childNodes.length>=1;)this.next.removeChild(this.next.firstChild);if(this.page<b){var d=new Element("a",{href:"#"});d.appendText("Next Page"),d.addEvent("click",function(a){this.page++,d.removeEvents(),this.update()}.bind(this)),this.next.appendChild(d)}else this.next.appendText("Next Page")}this.PageBox&&(1!=this.page||b>1?this.pageBox.style.display="block":this.pageBox.style.display="none")},makeChannel:function(a,b,c){var d;d=this.cloud?a:new Element("td",{"class":"name chan"+c});var e=function(){var c=b.name;a.addEvent("click",function(a){if(new Event(a).stop(),this.session.irc)this.session.irc.exec("/JOIN "+c);else{var b=ui.getWindow(qwebirc.ui.WINDOW_CUSTOM,"Connect");if(b){var d=b.subWindow.connectChannel(c);d||(ui.selectWindow(b),b.subWindow.nickBox.focus())}}}.bind(this))}.bind(this);if(e(),d.appendText(b.name),this.cloud)a.setProperty("title",b.topic);else{a.appendChild(d);var f=new Element("td",{"class":"users chan"+c});f.appendText(b.users),a.appendChild(f);var g=new Element("td",{"class":"chantopic chan"+c});qwebirc.ui.Colourise(this.session,b.topic,g),a.appendChild(g)}}}),qwebirc.ui.Panes.Options={title:"Options",command:function(a){return"OPTIONS"},menuitem:function(a){return"Options"},menupos:300},qwebirc.ui.Panes.Options.pclass=new Class({Implements:[Events],session:null,initialize:function(a,b){this.session=a,this.window=b,this.parent=b.lines,this.createElements()},createElements:function(){var a=function(a,b){var c=new Element(a);return b.appendChild(c),c};this.boxList=[],this.options={};for(var b,c,d=0;d<qwebirc.options.Options.length;d++){var e=qwebirc.options.Options[d],f=qwebirc.options.CheckInput;if($defined(e.type)&&(f=e.type),f!=qwebirc.options.ColorInput||!$defined(e.isEnabled)||e.isEnabled(this.session)){f!=b&&(c=a("table",this.parent),tb=a("tbody",c),b=f);var g=a("tr",tb),h=a("td",g),i=a("td",g),j=new f(this.session,this.options,i,e,d),k=new Element("label",{"for":j.id});k.set("text",e.label+":"),h.appendChild(k),this.boxList.push([e,j]),this.options[e.category+"."+e.option]=j}}var l=a("tr",tb),h=a("td",l),i=a("td",l),m=qwebirc.util.createInput("submit",i);m.value="Save",m.addEvent("click",function(){this.save(),ui.closeWindow(this.window)}.bind(this));var n=qwebirc.util.createInput("submit",i);n.value="Cancel",n.addEvent("click",function(){this.cancel(),ui.closeWindow(this.window)}.bind(this))},save:function(){this.boxList.forEach(function(a){var b=a[0],c=a[1];conf[b.category][b.option]=c.get(),b.onSave&&b.onSave(this.session)}.bind(this)),qwebirc.config.saveUserSettings(conf)},cancel:function(){this.boxList.forEach(function(a){a[0].onCancel&&a[0].onCancel(this.session)}.bind(this))}}),qwebirc.ui.Panes.PrivacyPolicy={title:"Privacy Policy",command:function(a){return conf.ui.privacy?"PRIVACYPOLICY":null},menuitem:function(a){return conf.ui.privacy?"Privacy policy":null},menupos:700},qwebirc.ui.Panes.PrivacyPolicy.pclass=new Class({Implements:[Events],session:null,initialize:function(a,b){this.session=a;var c=function(){b.lines.set("html",'<div class="loading">Loading. . .</div>')},d=c.delay(500),e=qwebirc.ui.RequestTransformHTML(a,{url:conf.frontend.static_base_url+"panes/privacypolicy.html",update:b.lines,onSuccess:function(){$clear(d),b.lines.getElement("input[class=close]").addEvent("click",function(){ui.closeWindow(b)}.bind(this))}.bind(this)});e.get()}}),qwebirc.ui.QUI=new Class({Extends:qwebirc.ui.RootUI,initialize:function(a,b){this.parent(a,b,qwebirc.ui.QUI.Window,"qui"),this.theme=new qwebirc.ui.Theme(null),this.setModifiableStylesheet("qui")},postInitialize:function(){this.qjsui=new qwebirc.ui.QUI.JSUI("qwebirc-qui",this.parentElement),this.qjsui.addEvent("reflow",function(){var a=this.getActiveWindow();$defined(a)&&a.onResize()}.bind(this)),this.qjsui.top.addClass("outertabbar"),this.qjsui.bottom.addClass("input"),this.qjsui.right.addClass("nicklist"),this.qjsui.topic.addClass("topic"),this.qjsui.middle.addClass("lines"),this.outerTabs=this.qjsui.top,this.tabs=new Element("div",{"class":"tabbar"}),this.__createDropdownMenu(),this.outerTabs.appendChild(this.tabs),this.origtopic=this.topic=this.qjsui.topic,this.origlines=this.lines=this.qjsui.middle,this.orignicklist=this.nicklist=this.qjsui.right,this.input=this.qjsui.bottom,this.reflow=this.qjsui.reflow.bind(this.qjsui),this.tabs.addEvent("mousewheel",function(a){var b=new Event(a);b.wheel>0?this.nextWindow():b.wheel<0&&this.prevWindow(),b.stop()}.bind(this)),this.createInput(),this.reflow(),this.reflow.delay(100)},__createDropdownMenu:function(){var a=new Element("span");a.addClass("dropdownmenu"),a.hide=function(){a.setStyle("display","none"),a.visible=!1,document.removeEvent("mousedown",b)}.bind(this);var b=function(){a.hide()};a.hide(),this.parentElement.appendChild(a);var c=[],d=0;$each(qwebirc.ui.Panes,function(a,b,e){var f=a.menuitem(this.session);f&&(c[d]={},c[d].text=f,c[d].name=b,c[d].pos=a.menupos,d++)}.bind(this)),c.sort(function(a,b){return a.pos-b.pos}),c.forEach(function(b){var c=new Element("a");c.addEvent("mousedown",function(a){new Event(a).stop()}),c.addEvent("click",function(){a.hide(),ui.addPane(b.name)}.bind(this)),c.set("text",b.text),a.appendChild(c)}.bind(this));var e=new Element("div");e.addClass("dropdown-tab"),e.appendChild(new Element("img",{src:conf.frontend.static_base_url+"images/menu.png",title:"menu",alt:"menu"})),this.outerTabs.appendChild(e),a.show=function(c){if(new Event(c).stop(),a.visible)return void a.hide();var d=this.outerTabs.getSize().y;a.setStyle("left",0),a.setStyle("top",d-1),a.setStyle("display","inline-block"),a.visible=!0,document.addEvent("mousedown",b)}.bind(this),e.addEvent("mousedown",function(a){new Event(a).stop()}),e.addEvent("click",a.show)},createInput:function(){var a=new Element("form");this.input.appendChild(a),a.addClass("input");var b=new Element("input");a.appendChild(b),this.inputbox=b,this.inputbox.maxLength=512;var c=function(){""!=b.value&&(this.resetTabComplete(),this.getActiveWindow().historyExec(b.value),b.value="")}.bind(this);if(qwebirc.util.deviceHasKeyboard())b.addClass("keyboard-input");else{b.addClass("mobile-input");var d=new Element("input",{type:"button"});d.addClass("mobile-button"),d.addEvent("click",function(){c(),b.focus()}),d.value=">",this.input.appendChild(d);var e=function(){var a=this.input.getSize(),c=d.getSize(),e=a.x-c.x-5;d.setStyle("left",e),b.setStyle("width",e-5),d.setStyle("height",a.y)}.bind(this);this.qjsui.addEvent("reflow",e)}a.addEvent("submit",function(a){new Event(a).stop(),c()}),b.addEvent("focus",this.resetTabComplete.bind(this)),b.addEvent("mousedown",this.resetTabComplete.bind(this)),b.addEvent("keydown",function(a){var c,d=b.value;if("up"==a.key)c=this.commandhistory.upLine;else{if("down"!=a.key)return"tab"==a.key?(new Event(a).stop(),void this.tabComplete(b)):void this.resetTabComplete();c=this.commandhistory.downLine}this.resetTabComplete(),""!=d&&this.lastcvalue!=d&&this.commandhistory.addLine(d,!0);var e=c.bind(this.commandhistory)();new Event(a).stop(),e||(e=""),this.lastcvalue=e,b.value=e,qwebirc.util.setAtEnd(b)}.bind(this))},setLines:function(a){this.lines.parentNode.replaceChild(a,this.lines),this.qjsui.middle=this.lines=a},setChannelItems:function(a,b){$defined(a)||(a=this.orignicklist,b=this.origtopic),this.nicklist.parentNode.replaceChild(a,this.nicklist),this.qjsui.right=this.nicklist=a,this.topic.parentNode.replaceChild(b,this.topic),this.qjsui.topic=this.topic=b},closeWindow:function(a){this.parent(a),this.tabs.removeChild(a.tab),this.tabs.removeChild(a.spaceNode),this.reflow()}}),qwebirc.ui.QUI.JSUI=new Class({Implements:[Events],initialize:function(a,b,c){this.parent=b,this.sizer=$defined(c)?c:b,this.class_=a,this.create(),this.reflowevent=null,window.addEvent("resize",function(){this.reflow(100)}.bind(this))},applyClasses:function(a,b){b.addClass("dynamicpanel"),b.addClass(this.class_),"middle"==a?b.addClass("leftboundpanel"):"top"==a?(b.addClass("topboundpanel"),b.addClass("widepanel")):"topic"==a?b.addClass("widepanel"):"right"==a?b.addClass("rightboundpanel"):"bottom"==a&&(b.addClass("bottomboundpanel"),b.addClass("widepanel"))},create:function(){var a=function(a){var b=new Element("div");return this.applyClasses(a,b),this.parent.appendChild(b),b}.bind(this);this.top=a("top"),this.topic=a("topic"),this.middle=a("middle"),this.right=a("right"),this.bottom=a("bottom")},reflow:function(a){a||(a=1),this.reflowevent&&$clear(this.reflowevent),this.__reflow(),this.reflowevent=this.__reflow.delay(a,this)},__reflow:function(){var a=this.bottom,b=this.middle,c=this.right,d=this.topic,e=this.top,f=d.getSize(),g=e.getSize(),h=c.getSize(),i=a.getSize(),j=this.sizer.getSize(),k=j.y-g.y-i.y-f.y,l=j.x-h.x;d.setStyle("top",g.y),b.setStyle("top",g.y+f.y),k>0&&(b.setStyle("height",k),c.setStyle("height",k)),l>0&&b.setStyle("width",l),c.setStyle("top",g.y+f.y),c.setStyle("left",l),a.setStyle("top",j.y-i.y),this.fireEvent("reflow")},showChannel:function(a){var b="none";a&&(b="block"),this.right.setStyle("display",b),this.topic.setStyle("display",b)},showInput:function(a){this.bottom.isVisible=a,this.bottom.setStyle("display",a?"block":"none")}}),qwebirc.ui.QUI.Window=new Class({Extends:qwebirc.ui.Window,initialize:function(a,b,c,d){if(this.parent(a,b,c,d),this.tab=new Element("a",{href:"#"}),this.tab.addClass("tab"),this.tab.addEvent("focus",function(){this.blur()}.bind(this.tab)),this.spaceNode=document.createTextNode(" "),ui.tabs.hasChildNodes()?b==qwebirc.ui.WINDOW_STATUS?(ui.tabs.insertBefore(this.tab,ui.tabs.firstChild),ui.tabs.insertBefore(this.spaceNode,this.tab.nextSibling)):b==qwebirc.ui.WINDOW_CUSTOM&&"Connect"==c?(ui.tabs.insertBefore(this.tab,ui.tabs.firstChild),ui.tabs.insertBefore(this.spaceNode,this.tab.nextSibling)):(ui.tabs.appendChild(this.tab),ui.tabs.appendChild(this.spaceNode)):(ui.tabs.appendChild(this.tab),ui.tabs.appendChild(this.spaceNode)),this.tab.appendText(c),this.tab.addEvent("click",function(a){new Event(a).stop(),this.closed||ui.selectWindow(this)}.bind(this)),b!=qwebirc.ui.WINDOW_STATUS&&(b!=qwebirc.ui.WINDOW_CUSTOM||"Connect"!=c)){var e=new Element("span");e.set("text","X"),e.addClass("tabclose");var f=function(a){new Event(a).stop(),this.closed||(b==qwebirc.ui.WINDOW_CHANNEL&&this.session.irc.exec("/PART "+c),ui.closeWindow(this))}.bind(this);e.addEvent("click",f),this.tab.addEvent("mouseup",function(a){var b=1;Browser.Engine.trident&&(b=4),a.event.button==b&&f()}.bind(this)),this.tab.appendChild(e)}this.lines=new Element("div"),ui.qjsui.applyClasses("middle",this.lines),this.lines.addClass("lines"),b!=qwebirc.ui.WINDOW_CUSTOM&&this.lines.addClass("ircwindow"),b&qwebirc.ui.WINDOW_LINES&&(this.lines.scroller=new qwebirc.ui.AutoScroll(this.lines)),b==qwebirc.ui.WINDOW_CHANNEL&&(this.topic=new Element("div"),this.topic.addClass("topic"),this.topic.addClass("tab-invisible"),this.topic.set("html","&nbsp;"),this.topic.addEvent("dblclick",this.editTopic.bind(this)),ui.qjsui.applyClasses("topic",this.topic),this.prevNick=null,this.nicklist=new Element("div"),this.nicklist.addClass("nicklist"),this.nicklist.addClass("tab-invisible"),this.nicklist.addEvent("click",this.removePrevMenu.bind(this)),ui.qjsui.applyClasses("nicklist",this.nicklist)),b==qwebirc.ui.WINDOW_CHANNEL&&this.updateTopic(""),this.nicksColoured=conf.ui.nick_colors,this.reflow()},editTopic:function(){if(!this.session.irc.nickOnChanHasAtLeastPrefix(this.session.irc.nickname,this.name,"+",!0))return void alert("Sorry, you need to be a channel operator to change the topic!");var a=prompt("Change topic of "+this.name+" to:",this.topic.topicText);null!==a&&this.session.irc.exec("/TOPIC "+a)},reflow:function(){ui.reflow()},onResize:function(){},createMenu:function(a,b){var c=new Element("div");b.appendChild(c),c.addClass("menu");var d=[a];return qwebirc.ui.MENU_ITEMS().forEach(function(a){if(a.predicate&&(a.predicate===!0||a.predicate.apply(this,d))){var b=new Element("a");c.appendChild(b),b.href="#",b.set("text","- "+a.text),b.addEvent("focus",function(){this.blur()}.bind(b)),b.addEvent("click",function(b){new Event(b.stop()),this.menuClick(a.fn)}.bind(this))}}.bind(this)),c},menuClick:function(a){a.bind(this)(this.prevNick.realNick),this.removePrevMenu()},moveMenuClass:function(){this.prevNick&&(this.nicklist.firstChild==this.prevNick?this.prevNick.removeClass("selected-middle"):this.prevNick.addClass("selected-middle"))},removePrevMenu:function(){this.prevNick&&(this.prevNick.removeClass("selected"),this.prevNick.removeClass("selected-middle"),this.prevNick.menu&&this.prevNick.removeChild(this.prevNick.menu),this.prevNick=null)},nickListAdd:function(a,b){var c=this.session.irc.stripPrefix(a),d=new Element("a");qwebirc.ui.insertAt(b,this.nicklist,d),d.href="#";var e=new Element("span");if(conf.ui.nick_colors){var f=c.toHSBColour(this.session);$defined(f)&&e.setStyle("color",f.rgbToHex())}return e.set("text",a),d.appendChild(e),d.realNick=c,d.addEvent("click",function(a){return this.prevNick==d?void this.removePrevMenu():(this.removePrevMenu(),this.prevNick=d,d.addClass("selected"),this.moveMenuClass(),d.menu=this.createMenu(d.realNick,d),void new Event(a).stop())}.bind(this)),d.addEvent("focus",function(){this.blur()}.bind(d)),this.moveMenuClass(),d},nickListRemove:function(a,b){this.nicklist.removeChild(b),this.moveMenuClass()},updateTopic:function(a){for(var b=this.topic;b.firstChild;)b.removeChild(b.firstChild);if(a)b.topicText=a,this.parent(a,b);else{b.topicText=a;var c=new Element("div");c.set("text","(no topic set)"),c.addClass("emptytopic"),b.appendChild(c)}this.reflow()},select:function(){var a=this.type!=qwebirc.ui.WINDOW_CUSTOM;if(this.tab.removeClass("tab-unselected"),this.tab.addClass("tab-selected"),ui.setLines(this.lines),ui.setChannelItems(this.nicklist,this.topic),ui.qjsui.showInput(a),ui.qjsui.showChannel($defined(this.nicklist)),this.reflow(),this.parent(),a&&ui.inputbox.focus(),this.type==qwebirc.ui.WINDOW_CHANNEL&&this.nicksColoured!=conf.ui.nick_colors){this.nicksColoured=conf.ui.nick_colors;var b=this.nicklist.childNodes;if(conf.ui.nick_colors)for(var c=0;c<b.length;c++){var d=b[c],e=d.firstChild,f=d.realNick.toHSBColour(this.session);$defined(f)&&e.setStyle("color",f.rgbToHex())}else for(var c=0;c<b.length;c++){var e=b[c].firstChild;e.setStyle("color",null)}}},deselect:function(){this.parent(),this.tab.removeClass("tab-selected"),this.tab.addClass("tab-unselected")},addLine:function(a,b,c){var d=new Element("div");d.addClass(c?c:this.lastcolour?"linestyle1":"linestyle2"),this.lastcolour=!this.lastcolour,this.parent(a,b,c,d)},setHilighted:function(a){var b=this.hilighted;if(this.parent(a),a!=b)switch(this.tab.removeClass("tab-hilight-activity"),this.tab.removeClass("tab-hilight-us"),this.tab.removeClass("tab-hilight-speech"),this.hilighted){case qwebirc.ui.HILIGHT_US:this.tab.addClass("tab-hilight-us");break;case qwebirc.ui.HILIGHT_SPEECH:this.tab.addClass("tab-hilight-speech");break;case qwebirc.ui.HILIGHT_ACTIVITY:this.tab.addClass("tab-hilight-activity")}}});
//# sourceMappingURL=qui.js.map